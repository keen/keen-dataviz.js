{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./lib/utils/each.js","webpack:///./lib/utils/copy-to-clipboard.js","webpack:///external \"d3\"","webpack:///./lib/utils/pretty-number.js","webpack:///./lib/utils/escape-html.js","webpack:///./lib/utils/extend.js","webpack:///./lib/utils/svg-text-wrap.js","webpack:///./lib/dataset/modifiers/append.js","webpack:///./lib/dataset/utils/create-null-list.js","webpack:///external \"c3\"","webpack:///./lib/utils/assert-date-string.js","webpack:///./lib/dataset/index.js","webpack:///./lib/dataset/utils/analyses.js","webpack:///./lib/utils/strip-html-tags.js","webpack:///./lib/utils/extend-deep.js","webpack:///./lib/utils/render-download-btn.js","webpack:///./lib/utils/export-svg.js","webpack:///./lib/utils/export-data.js","webpack:///./node_modules/rangeable/dist/rangeable.min.js","webpack:///./lib/server.js","webpack:///./lib/index.js","webpack:///./lib/dataset/modifiers/delete.js","webpack:///./lib/dataset/modifiers/filter.js","webpack:///./lib/dataset/modifiers/insert.js","webpack:///./lib/dataset/modifiers/select.js","webpack:///./lib/dataset/modifiers/sort.js","webpack:///./lib/dataset/modifiers/update.js","webpack:///./lib/dataset/utils/parsers.js","webpack:///./lib/dataset/utils/flatten.js","webpack:///./lib/dataset/utils/object.js","webpack:///./lib/data.js","webpack:///./lib/libraries/index.js","webpack:///./lib/libraries/c3/extensions/default-date-format.js","webpack:///./lib/libraries/c3/extensions/paginating-legend.js","webpack:///./lib/libraries/c3/extensions/tooltip-contents.js","webpack:///./lib/dataset/utils/calculate-range.js","webpack:///./lib/dataset/utils/calculate-percents.js","webpack:///./lib/libraries/default/message.js","webpack:///./lib/utils/download-results.js","webpack:///./node_modules/dom-to-image/src/dom-to-image.js","webpack:///./node_modules/file-saver/dist/FileSaver.min.js","webpack:///./lib/libraries/default/metric.js","webpack:///./lib/libraries/default/table.js","webpack:///./lib/libraries/default/spinner.js","webpack:///./lib/libraries/default/funnel.js","webpack:///./lib/libraries/default/funnel-3d.js","webpack:///./lib/libraries/default/horizontal-funnel.js","webpack:///./lib/libraries/default/horizontal-funnel-3d.js","webpack:///./lib/libraries/default/metric-combo.js","webpack:///./lib/libraries/default/heatmap.js","webpack:///./lib/libraries/default/choropleth.js","webpack:///./lib/utils/render-execution-metadata.js","webpack:///./lib/palettes/index.js","webpack:///./lib/palettes/autocollector.js","webpack:///./lib/palettes/modern.js","webpack:///./lib/palettes/dracula.js","webpack:///./node_modules/promise-polyfill/src/finally.js","webpack:///./node_modules/promise-polyfill/src/index.js","webpack:///./node_modules/promise-polyfill/src/polyfill.js"],"names":["each","o","cb","s","n","Array","length","call","hasOwnProperty","copyToClipboard","stickTooltip","event","tooltip","style","opacity","top","pageY","left","pageX","value","placeholder","document","createElement","body","appendChild","select","execCommand","removeChild","notification","padding","backgroundColor","fontSize","position","zIndex","transition","innerText","addEventListener","e","setTimeout","prettyNumber","input","Number","sciNo","toPrecision","prefix","suffixes","String","Math","abs","recurse","iteration","split","rhs","charAt","numNumerals","escapeHtml","matchHtmlRegExp","string","str","match","exec","escape","html","index","lastIndex","charCodeAt","substring","extend","target","i","arguments","prop","textWrap","d3","text","width","words","reverse","word","line","lineNumber","lineHeight","x","attr","y","dy","tspan","append","pop","push","join","node","getComputedTextLength","appendColumn","appendRow","self","args","prototype","slice","label","undefined","matrix","row","cell","concat","newRow","col","selectColumn","len","list","testObject","testString","getTime","isNaN","ISO_8601","test","del","filter","insert","sort","update","Dataset","config","meta","type","data","arr","set","coords","Error","colIndex","indexOf","rowIndex","colResult","rowResult","selectRow","analyses","parser","average","start","end","sum","avg","val","parseFloat","maximum","nums","max","apply","minimum","min","getColumnAverage","getRowAverage","getColumnSum","getRowSum","getColumnMaximum","getRowMaximum","getColumnMinimum","getRowMinimum","getColumnLabel","getRowIndex","stripHtmlTags","inputString","replace","extendDeep","key","renderDownloadButton","element","btnClass","isBtnRendered","parentNode","children","find","child","className","button","insertBefore","nextSibling","exportImage","obj","quality","bgcolor","domtoimage","toBlob","then","blob","exportData","generateCsvContent","csvContent","forEach","j","encodeURIComponent","supportedFormats","format","toLowerCase","includes","fileName","fileFormat","content","JSON","stringify","htmlElement","setAttribute","click","module","exports","default","Dataviz","options","c3","datavizInstance","defaultOptions","showDeprecationWarnings","showLoadingSpinner","container","containerElement","title","showTitle","subtitle","notes","theme","colors","colorMapping","ui","executionMetadata","utils","clickToCopyToClipboard","indexBy","labels","labelMapping","labelMappingRegExp","errorMapping","showErrorMessages","library","sortGroups","sortIntervals","results","stacked","dateFormat","legend","show","alignment","textMaxLength","pagination","offset","limit","pointer","axis","color","size","point","focus","expand","enabled","r","sensitivity","horizontal","order","selection","draggable","multiple","onselected","d","selectedItems","view","_artifacts","selected","reduce","prev","curr","grid","partialIntervalIndicator","timezone","table","schema","renderOnVisible","funnel","lines","resultValues","percents","countingMethod","decimals","marginBetweenElements","hover","effect3d","minimalSize","react","range","sparkline","choropleth","map","borders","showSlider","heatmap","palette","palettes","console","log","convertChartTypes","stacking","el","pattern","dataset","_prepared","_rendered","visuals","prepare","render","firstVisibilityState","visibilityState","callback","bind","libraries","window","register","name","actions","method","nodeName","querySelector","visual","attributes","fn","chartOptions","destroy","innerHTML","domReady","height","num","setLabels","updateColumn","updateRow","mapLabels","mapLabelsExec","valueAfterMatching","regExpAndLabel","regExpObj","labelMappingDimension","message","loader","spinner","firstResult","query","interval","timeframe","isArray","timeframes","resultItem","foundDifferent","timeframeItem","resultTimeframe","msg","error","deleteColumn","result","event_collection","analysis_type","ds2","Object","keys","returnValue","renderAsPromise","Promise","resolve","reject","customCallback","onrendered","shouldRenderExecutionMetadata","execution_metadata","shouldRenderDownloadBtn","buttons","download","mappedMsg","buildDomWrapper","IntersectionObserver","chartVisibleCallback","events","observer","isIntersecting","observe","hidden","visibilityChange","msHidden","webkitHidden","handleVisibilityChange","load","once","sortColumns","sortRows","bool","chartType","parseRawData","parseRequest","initialize","version","pkg","chart100percentWide","rangeChart","verticalAlignment","horizontalAlignment","align","legendItemsAlign","areachart","barchart","columnchart","linechart","piechart","testDom","readyState","DOMContentLoaded","removeEventListener","deleteRow","q","splice","filterColumns","filterRows","clone","selectedColumn","ri","insertColumn","insertRow","comp","head","cols","analysesUtilMethods","a","b","op","lib","parsers","parseMetric","res","parseInterval","record","parseGroupedMetric","parseGroupedInterval","group","parseDoubleGroupedMetric","rowLabel","parseDoubleGroupedInterval","parseFunnel","steps","parseList","parseExtraction","datasetExtraction","names","tableConfig","resultKeys","keyName","nameI","columns","iNames","parseHeatmapAxis","heatmapDataset","objKeys","metric","extraction","flatten","ob","toReturn","flatObject","valueAtDeepKey","is","parseResponse","response","parserArgs","selectedParser","metadata","filters","group_by","display_name","getDefaultTitle","visualization","chart_type","getDefaultType","Date","analysis","toUpperCase","timer","bindResizeListener","clearTimeout","delay","chart","c3Chart","parentWidth","offsetWidth","nextSiblingWidth","prevSiblingWidth","previousSibling","resize","defineC3","types","Funnel","Funnel3d","HorizontalFunnel","HorizontalFunnel3d","MetricCombo","Heatmap","Choropleth","c3Types","getPaddings","paddingName","parseInt","getComputedStyle","getDefaultOptions","ENFORCED_OPTIONS","bindto","renderingElement","offsetHeight","titleElement","subtitleElement","notesElement","DEFAULT_OPTIONS","extendedConfig","sumArray","oldMatrix","tick","clearOnRender","datasetMeta","spliceFrom","intervalTypes","removeLegend","rotated","culling","groups","categories","legendElement","remove","chartTypesWithPartialIntervalIndicator","partialResultsRegion","class","regions","contents","c3TooltipContents","ratio","id","valueFormatted","c3CustomTooltipFiltering","toFixed","c3options","c3CustomDataMapping","hide","generate","c3PaginatingLegend","onLegendRendered","onPaginated","flush","scope","onresize","attachEvent","startDate","endDate","timeDiff","months","ms","date","getMonth","getFullYear","getDate","domNode","legendConfig","round","total","columnsSorted","dataColumnsSorted","columnData","item","column","paginateHorizontalLeftElement","legendItemsElement","paginateVerticalElement","paginateHorizontalRightElement","paginateData","renderLegendComponent","renderPaginationComponent","labelShortened","legendItem","chartPartId","legendItemColorSample","prepend","tooltipElement","revert","isHidden","toggle","arrowUp","arrowDown","paginate","direction","diff","floor","clearSelectedText","empty","getSelection","removeAllRanges","defaultTitleFormat","defaultValueFormat","nameFormat","tooltip_format_name","titleFormat","tooltip_format_title","valueFormat","tooltip_format_value","CLASS","levelColor","tooltipName","calculateRange","newValues","calculateSumForPercents","calculatePercents","outer","inner","titleContainer","subtitleContainer","notesContainer","downloadResults","preventDefault","currentTarget","previousElementSibling","formatExtractionData","formattedResult","opts","prevValue","suffix","formattedNum","flexDifferenceStyle","resultDifference","differenceStyle","smallerValue","previousResults","isExtraction","comparedProp","resultClassName","previousResultsClassName","currentPage","_generateTableRows","defaultConfig","page","arrows","customConfig","datasetPaginated","pages","ceil","columnsArray","colNamesToMap","mapValues","mapDates","entries","rowColValue","rowColValueEscaped","pageNumber","prevPage","nextPage","_generateTableHeader","fieldNumber","columnNames","colName","colNameEscaped","isEmpty","querySelectorAll","sortOrder","getAttribute","checker","sortOrderNumber","nameA","nameB","first","shift","unshift","attachBtnEventListeners","btn","tableClass","artifacts","clearInterval","radius","marginBetweenSteps","margin","right","bottom","yMarginElement","funnelContainer","chartContainer","svgWidth","svgHeight","elemHeight","prevElemWidth","percent","minimalSizeStep","polygons","newPoints","points","selectAll","enter","p","handleMouseOver","polygonsHover","labelHover","thisLabel","handleMouseOut","on","handleClickToCopy","shadowCut","polygonsShadows","polygons3d","rgb","darker","xMarginElement","elemWidth","prevElemHeight","metricResults","c","prevResult","previous","currResult","current","count","percentDifference","labelClass","iconClass","containerTitle","containerSubtitle","chartRoot","currentCount","simpleTooltip","baseWidth","baseHeight","heatmapContainer","containerWidth","containerHeight","xLabel","Set","yLabel","formatData","timeFormat","timestamp","parse","formattedData","add","refValue","minRange","maxRange","getColor","defaultColor","baseColor","getColorAlpha","scaleLinear","domain","convertRGBAtoRGB","bg","getTileColor","alpha","solidColor","g","svg","rangeableInput","handleSliderChange","rects","nodes","rangeable","Rangeable","onChange","containerToString","customStyle","scriptRef","xLabelBase","yLabelBase","getAxisLabelRatio","base","labelSize","xAxis","scaleBand","axisBottom","tickSize","yAxis","axisLeft","chartTooltip","toString","raise","handleMouseMove","tooltipContent","clientX","clientY","handleMouseLeave","handleClick","bandwidth","choroplethContainer","heightChanges","onlyValues","minVal","maxVal","lightColor","hsl","brighter","l","darkColor","ramp","json","zoom","scaleExtent","translateExtent","zoomed","projection","geoMercator","fitSize","geoAlbersUsa","scale","path","geoPath","usData","features","theOne","properties","elementName","rangeContainer","tooltips","transform","renderExecutionMetadata","removeClassWithTimeOut","classList","handleCopyToClipboard","contains","dataList","dt","dd","autocollector","modern","dracula"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;QClFgBA,I,GAAAA,I;AAAT,SAASA,IAAT,CAAcC,CAAd,EAAiBC,EAAjB,EAAqBC,CAArB,EAAwB;AAC7B,MAAIC,CAAJ;AACA,MAAI,CAACH,CAAL,EAAQ;AACN,WAAO,CAAP;AACD;AACDE,MAAI,CAACA,CAAD,GAAKF,CAAL,GAASE,CAAb;AACA,MAAIF,aAAaI,KAAjB,EAAwB;AACtB;AACA,SAAKD,IAAI,CAAT,EAAYA,IAAIH,EAAEK,MAAlB,EAA0BF,GAA1B,EAA+B;AAC7B,UAAIF,GAAGK,IAAH,CAAQJ,CAAR,EAAWF,EAAEG,CAAF,CAAX,EAAiBA,CAAjB,EAAoBH,CAApB,MAA2B,KAA/B,EAAsC;AACpC,eAAO,CAAP;AACD;AACF;AACF,GAPD,MAOO;AACL;AACA,SAAKG,CAAL,IAAUH,CAAV,EAAa;AACX,UAAIA,EAAEO,cAAF,CAAiBJ,CAAjB,CAAJ,EAAyB;AACvB,YAAIF,GAAGK,IAAH,CAAQJ,CAAR,EAAWF,EAAEG,CAAF,CAAX,EAAiBA,CAAjB,EAAoBH,CAApB,MAA2B,KAA/B,EAAqC;AACnC,iBAAO,CAAP;AACD;AACF;AACF;AACF;AACD,SAAO,CAAP;AACD,C;;;;;;;;;;;;kBClBuBQ,e;AANxB,SAASC,YAAT,CAAsBC,KAAtB,EAA6BC,OAA7B,EAAsC;AACpCA,UAAQC,KAAR,CAAcC,OAAd,GAAwB,CAAxB;AACAF,UAAQC,KAAR,CAAcE,GAAd,GAAuBJ,MAAMK,KAA7B;AACAJ,UAAQC,KAAR,CAAcI,IAAd,GAAwBN,MAAMO,KAAN,GAAc,EAAtC;AACD;;AAEc,SAAST,eAAT,CAAyBU,KAAzB,EAAgCR,KAAhC,EAAuC;AACpD,MAAMS,cAAcC,SAASC,aAAT,CAAuB,OAAvB,CAApB;AACAF,cAAYD,KAAZ,GAAoBA,KAApB;AACAE,WAASE,IAAT,CAAcC,WAAd,CAA0BJ,WAA1B;AACAA,cAAYK,MAAZ;AACAJ,WAASK,WAAT,CAAqB,MAArB;AACAL,WAASE,IAAT,CAAcI,WAAd,CAA0BP,WAA1B;;AAEA,MAAIT,KAAJ,EAAW;AACT,QAAMiB,eAAeP,SAASC,aAAT,CAAuB,KAAvB,CAArB;AACAM,iBAAaf,KAAb,CAAmBgB,OAAnB,GAA6B,UAA7B;AACAD,iBAAaf,KAAb,CAAmBiB,eAAnB,GAAqC,SAArC;AACAF,iBAAaf,KAAb,CAAmBkB,QAAnB,GAA8B,MAA9B;AACAH,iBAAaf,KAAb,CAAmBmB,QAAnB,GAA8B,UAA9B;AACAJ,iBAAaf,KAAb,CAAmBE,GAAnB,GAA4BJ,MAAMK,KAAlC;AACAY,iBAAaf,KAAb,CAAmBI,IAAnB,GAA6BN,MAAMO,KAAN,GAAc,EAA3C;AACAU,iBAAaf,KAAb,CAAmBoB,MAAnB,GAA4B,KAA5B;AACAL,iBAAaf,KAAb,CAAmBC,OAAnB,GAA6B,CAA7B;AACAc,iBAAaf,KAAb,CAAmBqB,UAAnB,GAAgC,iBAAhC;AACAN,iBAAaO,SAAb,GAAyB,SAAzB;;AAEAd,aAASE,IAAT,CAAcC,WAAd,CAA0BI,YAA1B;AACAP,aAASe,gBAAT,CAA0B,WAA1B,EAAuC;AAAA,aAAK1B,aAAa2B,CAAb,EAAgBT,YAAhB,CAAL;AAAA,KAAvC;;AAEAU,eAAW,YAAM;AACfV,mBAAaf,KAAb,CAAmBC,OAAnB,GAA6B,CAA7B;AACAO,eAASE,IAAT,CAAcI,WAAd,CAA0BC,YAA1B;AACD,KAHD,EAGG,IAHH;AAID;AACF,C;;;;;;ACnCD,gD;;;;;;;;;;;;QCAgBW,Y,GAAAA,Y;AAAT,SAASA,YAAT,CAAsBC,KAAtB,EAA6B;AAClC;AACA,MAAIA,QAAQC,OAAOD,KAAP,CAAZ;AAAA,MACIE,QAAQF,MAAMG,WAAN,CAAkB,CAAlB,CADZ;AAAA,MAEIC,SAAS,EAFb;AAAA,MAGIC,WAAW,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,EAAe,GAAf,EAAoB,GAApB,CAHf;;AAKA,MAAIJ,OAAOC,KAAP,KAAiBF,KAAjB,IAA0BM,OAAON,KAAP,EAAclC,MAAd,IAAwB,CAAtD,EAAyD;AACvD,WAAOwC,OAAON,KAAP,CAAP;AACD;;AAED,MAAIO,KAAKC,GAAL,CAASR,KAAT,KAAmB,gBAAvB,EAAyC;AACvC,WAAOE,KAAP;AACD;;AAED,MAAIF,SAAS,CAAT,IAAcA,SAAS,CAAC,CAA5B,EAA+B;AAC7B,QAAIA,QAAQ,CAAZ,EAAc;AACZ;AACAA,cAAQ,CAACA,KAAT;AACAI,eAAS,GAAT;AACD;AACD,WAAOA,SAASK,QAAQT,KAAR,EAAe,CAAf,CAAhB;AACD,GAPD,MAQK;AACH,WAAOA,MAAMG,WAAN,CAAkB,CAAlB,CAAP;AACD;;AAED,WAASM,OAAT,CAAiBT,KAAjB,EAAwBU,SAAxB,EAAmC;AACjC,QAAIV,QAAQM,OAAON,KAAP,CAAZ;AACA,QAAIW,QAAQX,MAAMW,KAAN,CAAY,GAAZ,CAAZ;AACA;AACA,QAAIA,MAAM7C,MAAN,GAAe,CAAnB,EAAsB;AACpB;AACAkC,cAAQW,MAAM,CAAN,CAAR;AACA,UAAIC,MAAMD,MAAM,CAAN,CAAV;AACA;AACA,UAAIX,MAAMlC,MAAN,IAAgB,CAAhB,IAAqB8C,IAAI9C,MAAJ,GAAa,CAAtC,EAAyC;AACvC;AACA,YAAI8C,IAAI9C,MAAJ,GAAa,CAAjB,EAAoB;AAClBkC,kBAAQA,QAAQ,GAAR,GAAcY,IAAIC,MAAJ,CAAW,CAAX,CAAtB;AACD;AACD;AAHA,aAIK;AACHb,qBAAS,GAAT;AACD;AACF,OATD,MAUK,IAAIA,MAAMlC,MAAN,IAAgB,CAAhB,IAAqB8C,IAAI9C,MAAJ,GAAa,CAAtC,EAAyC;AAC5CkC,gBAAQA,QAAQ,GAAR,GAAcY,IAAIC,MAAJ,CAAW,CAAX,CAAtB;AACA;AACA,YAAID,IAAI9C,MAAJ,GAAa,CAAjB,EAAoB;AAClBkC,mBAASY,IAAIC,MAAJ,CAAW,CAAX,CAAT;AACD;AACD;AAHA,aAIK;AACHb,qBAAS,GAAT;AACD;AACF;AACF;AACD,QAAIc,cAAcd,MAAMlC,MAAxB;AACA;AACA,QAAIkC,MAAMW,KAAN,CAAY,GAAZ,EAAiB7C,MAAjB,GAA0B,CAA9B,EAAiC;AAC/BgD;AACD;AACD,QAAIA,eAAe,CAAnB,EAAsB;AACpB,aAAOR,OAAON,KAAP,IAAgBK,SAASK,SAAT,CAAvB;AACD,KAFD,MAGK;AACH,aAAOD,QAAQR,OAAOD,KAAP,IAAgB,IAAxB,EAA8BU,YAAY,CAA1C,CAAP;AACD;AACF;AACF,C;;;;;;;;;;;;QC5DeK,U,GAAAA,U;AAVhB,IAAMC,kBAAkB,SAAxB;;AAEA;;;;;;;;AAQO,SAASD,UAAT,CAAoBE,MAApB,EAA4B;AACjC,MAAIC,MAAM,KAAKD,MAAf;AACA,MAAIE,QAAQH,gBAAgBI,IAAhB,CAAqBF,GAArB,CAAZ;;AAEA,MAAI,CAACC,KAAL,EAAY;AACV,WAAOD,GAAP;AACD;;AAED,MAAIG,MAAJ;AACA,MAAIC,OAAO,EAAX;AACA,MAAIC,QAAQ,CAAZ;AACA,MAAIC,YAAY,CAAhB;;AAEA,OAAKD,QAAQJ,MAAMI,KAAnB,EAA0BA,QAAQL,IAAIpD,MAAtC,EAA8CyD,OAA9C,EAAuD;AACrD,YAAQL,IAAIO,UAAJ,CAAeF,KAAf,CAAR;AACE,WAAK,EAAL;AAAS;AACPF,iBAAS,QAAT;AACA;AACF,WAAK,EAAL;AAAS;AACPA,iBAAS,OAAT;AACA;AACF,WAAK,EAAL;AAAS;AACPA,iBAAS,OAAT;AACA;AACF,WAAK,EAAL;AAAS;AACPA,iBAAS,MAAT;AACA;AACF,WAAK,EAAL;AAAS;AACPA,iBAAS,MAAT;AACA;AACF;AACE;AAjBJ;;AAoBA,QAAIG,cAAcD,KAAlB,EAAyB;AACvBD,cAAQJ,IAAIQ,SAAJ,CAAcF,SAAd,EAAyBD,KAAzB,CAAR;AACD;;AAEDC,gBAAYD,QAAQ,CAApB;AACAD,YAAQD,MAAR;AACD;;AAED,SAAOG,cAAcD,KAAd,GACHD,OAAOJ,IAAIQ,SAAJ,CAAcF,SAAd,EAAyBD,KAAzB,CADJ,GAEHD,IAFJ;AAGD,C;;;;;;;;;;;;QCvDeK,M,GAAAA,M;AAAT,SAASA,MAAT,CAAgBC,MAAhB,EAAwB;AAC7B,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,UAAUhE,MAA9B,EAAsC+D,GAAtC,EAA2C;AACzC,SAAK,IAAIE,IAAT,IAAiBD,UAAUD,CAAV,CAAjB,EAA8B;AAC5BD,aAAOG,IAAP,IAAeD,UAAUD,CAAV,EAAaE,IAAb,CAAf;AACD;AACF;AACD,SAAOH,MAAP;AACD,C;;;;;;;;;;;;QCLeI,Q,GAAAA,Q;;AAFhB;;IAAYC,E;;;;AAEL,SAASD,QAAT,CAAkBE,IAAlB,EAAwBC,KAAxB,EAA+B;AACpCD,SAAK1E,IAAL,CAAU,YAAY;AACpB,YAAI0E,OAAOD,GAAGhD,MAAH,CAAU,IAAV,CAAX;AAAA,YACImD,QAAQF,KAAKA,IAAL,GAAYvB,KAAZ,CAAkB,KAAlB,EAAyB0B,OAAzB,EADZ;AAAA,YAEIC,aAFJ;AAAA,YAGIC,OAAO,EAHX;AAAA,YAIIC,aAAa,CAJjB;AAAA,YAKIC,aAAa,GALjB;AAAA,YAKsB;AAClBC,YAAIR,KAAKS,IAAL,CAAU,GAAV,CANR;AAAA,YAOIC,IAAIV,KAAKS,IAAL,CAAU,GAAV,CAPR;AAAA,YAQIE,KAAK,CART;AAAA,YAQY;AACRC,gBAAQZ,KAAKA,IAAL,CAAU,IAAV,EACKa,MADL,CACY,OADZ,EAEKJ,IAFL,CAEU,GAFV,EAEeD,CAFf,EAGKC,IAHL,CAGU,GAHV,EAGeC,CAHf,EAIKD,IAJL,CAIU,IAJV,EAIgBE,KAAK,IAJrB,CATZ;AAcA,eAAOP,OAAOF,MAAMY,GAAN,EAAd,EAA2B;AACvBT,iBAAKU,IAAL,CAAUX,IAAV;AACAQ,kBAAMZ,IAAN,CAAWK,KAAKW,IAAL,CAAU,GAAV,CAAX;AACA,gBAAIJ,MAAMK,IAAN,GAAaC,qBAAb,KAAuCjB,KAA3C,EAAkD;AAC9CI,qBAAKS,GAAL;AACAF,sBAAMZ,IAAN,CAAWK,KAAKW,IAAL,CAAU,GAAV,CAAX;AACAX,uBAAO,CAACD,IAAD,CAAP;AACAQ,wBAAQZ,KAAKa,MAAL,CAAY,OAAZ,EACKJ,IADL,CACU,GADV,EACeD,CADf,EAEKC,IAFL,CAEU,GAFV,EAEeC,CAFf,EAGKD,IAHL,CAGU,IAHV,EAGgB,EAAEH,UAAF,GAAeC,UAAf,GAA4BI,EAA5B,GAAiC,IAHjD,EAIKX,IAJL,CAIUI,IAJV,CAAR;AAKH;AACJ;AACF,KA7BD;AA8BD,C;;;;;;;;;;;;QC9Bee,Y,GAAAA,Y;QA6CAC,S,GAAAA,S;;AAhDhB;;;;AACA;;;;AAEO,SAASD,YAAT,CAAsBnC,GAAtB,EAA2BlB,KAA3B,EAAkC;AACvC,MAAMuD,OAAO,IAAb;AACA,MAAMC,OAAO3F,MAAM4F,SAAN,CAAgBC,KAAhB,CAAsB3F,IAAtB,CAA2B+D,SAA3B,EAAsC,CAAtC,CAAb;AACA,MAAM6B,QAASzC,QAAQ0C,SAAT,GAAsB1C,GAAtB,GAA4B,IAA1C;;AAEA,MAAI,OAAOlB,KAAP,KAAiB,UAArB,EAAiC;AAC/BuD,SAAKM,MAAL,CAAY,CAAZ,EAAeZ,IAAf,CAAoBU,KAApB;AACA,oBAAKJ,KAAKM,MAAV,EAAkB,UAASC,GAAT,EAAcjC,CAAd,EAAiB;AACjC,UAAIkC,aAAJ;AACA,UAAIlC,IAAI,CAAR,EAAW;AACTkC,eAAO/D,MAAMjC,IAAN,CAAWwF,IAAX,EAAiBO,GAAjB,EAAsBjC,CAAtB,CAAP;AACA,YAAI,OAAOkC,IAAP,KAAgB,WAApB,EAAiC;AAC/BA,iBAAO,IAAP;AACD;AACDR,aAAKM,MAAL,CAAYhC,CAAZ,EAAeoB,IAAf,CAAoBc,IAApB;AACD;AACF,KATD;AAUD,GAZD,MAcK,IAAI,CAAC/D,KAAD,IAAUA,iBAAiBnC,KAA/B,EAAsC;AACzCmC,YAAQA,SAAS,EAAjB;;AAEA,QAAIA,MAAMlC,MAAN,IAAgByF,KAAKM,MAAL,CAAY/F,MAAZ,GAAqB,CAAzC,EAA4C;AAC1CkC,cAAQA,MAAMgE,MAAN,CAAa,8BAAeT,KAAKM,MAAL,CAAY/F,MAAZ,GAAqB,CAArB,GAAyBkC,MAAMlC,MAA9C,CAAb,CAAR;AACD,KAFD,MAGK;AACH;AACA;AACA,sBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B,YAAI0B,KAAKM,MAAL,CAAY/F,MAAZ,GAAoB,CAApB,GAAwBkC,MAAMlC,MAAlC,EAA0C;AACxCwF,oBAAUvF,IAAV,CAAewF,IAAf,EAAqBjD,OAAOiD,KAAKM,MAAL,CAAY/F,MAAnB,CAArB;AACD;AACF,OAJD;AAKD;;AAEDyF,SAAKM,MAAL,CAAY,CAAZ,EAAeZ,IAAf,CAAoBU,KAApB;AACA,oBAAK3D,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B0B,WAAKM,MAAL,CAAYhC,IAAE,CAAd,EAAiB0B,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAsB,CAAvC,IAA4Ca,KAA5C;AACD,KAFD;AAID;;AAED,SAAO4E,IAAP;AACD;;AAEM,SAASD,SAAT,CAAmBpC,GAAnB,EAAwBlB,KAAxB,EAA+B;AACpC,MAAMuD,OAAO,IAAb;AACA,MAAMC,OAAO3F,MAAM4F,SAAN,CAAgBC,KAAhB,CAAsB3F,IAAtB,CAA2B+D,SAA3B,EAAsC,CAAtC,CAAb;AACA,MAAM6B,QAASzC,QAAQ0C,SAAT,GAAsB1C,GAAtB,GAA4B,IAA1C;AACA,MAAM+C,SAAS,EAAf;;AAEAA,SAAOhB,IAAP,CAAYU,KAAZ;;AAEA,MAAI,OAAO3D,KAAP,KAAiB,UAArB,EAAiC;AAC/B,oBAAKuD,KAAKM,MAAL,CAAY,CAAZ,CAAL,EAAqB,UAASF,KAAT,EAAgB9B,CAAhB,EAAkB;AACrC,UAAIqC,YAAJ;AACA,UAAIH,aAAJ;AACA,UAAIlC,IAAI,CAAR,EAAW;AACTqC,cAAMX,KAAKY,YAAL,CAAkBtC,CAAlB,CAAN;AACAkC,eAAO/D,MAAMjC,IAAN,CAAWwF,IAAX,EAAiBW,GAAjB,EAAsBrC,CAAtB,CAAP;AACA,YAAI,OAAOkC,IAAP,KAAgB,WAApB,EAAiC;AAC/BA,iBAAO,IAAP;AACD;AACDE,eAAOhB,IAAP,CAAYc,IAAZ;AACD;AACF,KAXD;AAYAR,SAAKM,MAAL,CAAYZ,IAAZ,CAAiBgB,MAAjB;AACD,GAdD,MAgBK,IAAI,CAACjE,KAAD,IAAUA,iBAAiBnC,KAA/B,EAAsC;AACzCmC,YAAQA,SAAS,EAAjB;;AAEA,QAAIA,MAAMlC,MAAN,IAAgByF,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAwB,CAA5C,EAA+C;AAC7CkC,cAAQA,MAAMgE,MAAN,CAAc,8BAAgBT,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAwB,CAAxB,GAA4BkC,MAAMlC,MAAlD,CAAd,CAAR;AACD,KAFD,MAGK;AACH,sBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B,YAAI0B,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAuB,CAAvB,GAA2BkC,MAAMlC,MAArC,EAA6C;AAC3CuF,uBAAatF,IAAb,CAAkBwF,IAAlB,EAAwBjD,OAAQiD,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAvB,CAAxB;AACD;AACF,OAJD;AAKD;;AAEDyF,SAAKM,MAAL,CAAYZ,IAAZ,CAAiBgB,OAAOD,MAAP,CAAchE,KAAd,CAAjB;AACD;;AAED,SAAOuD,IAAP;AACD,C;;;;;;;;;;;;;kBC1Fc,UAAUa,GAAV,EAAe;AAC5B,MAAMC,OAAO,EAAb;AACA,OAAK,IAAIxC,IAAI,CAAb,EAAgBA,IAAIuC,GAApB,EAAyBvC,GAAzB,EAA8B;AAC5BwC,SAAKpB,IAAL,CAAU,IAAV;AACD;AACD,SAAOoB,IAAP;AACD,C;;;;;;ACND,gD;;;;;;;;;;;;;;;QCAgBC,U,GAAAA,U;QAOAC,U,GAAAA,U;;kBAKD,UAAUvE,KAAV,EAAiB;AAC9B,MAAI,QAAOA,KAAP,yCAAOA,KAAP,OAAiB,QAArB,EAA+B;AAC7B,WAAOsE,WAAWtE,KAAX,CAAP;AACD,GAFD,MAEO,IAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AACpC,WAAOuE,WAAWvE,KAAX,CAAP;AACD;AACD,SAAO,KAAP;AACD,C;;AAnBM,SAASsE,UAAT,CAAoBtE,KAApB,EAA2B;AAChC,MAAIA,UAAU,IAAV,IAAkB,OAAOA,MAAMwE,OAAb,KAAyB,UAA3C,IAAyD,CAACC,MAAMzE,MAAMwE,OAAN,EAAN,CAA9D,EAAsF;AACpF,WAAO,IAAP;AACD;AACD,SAAO,KAAP;AACD;;AAEM,SAASD,UAAT,CAAoBvE,KAApB,EAA2B;AAChC,MAAM0E,WAAW,+DAAjB;AACA,SAAOA,SAASC,IAAT,CAAc3E,KAAd,CAAP;AACD,C;;;;;;;;;;;;;;ACTD;;IAAY+C,M;;AACZ;;IAAY6B,G;;AACZ;;IAAYC,M;;AACZ;;IAAYC,M;;AACZ;;IAAY7F,M;;AACZ;;IAAY8F,I;;AACZ;;IAAYC,M;;AAGZ;;;;AACA;;AACA;;;;;;;;AAZA;AAcO,IAAMC,4BAAU,SAAVA,OAAU,GAAuB;AAAA,MAAbC,MAAa,uEAAJ,EAAI;;AAC5C,MAAI,gBAAgBD,OAAhB,KAA4B,KAAhC,EAAuC;AACrC,WAAO,IAAIA,OAAJ,CAAYC,MAAZ,CAAP;AACD;;AAED,OAAKrB,MAAL,GAAc,CACZ,CAAC,OAAD,CADY,CAAd;AAGA,OAAKsB,IAAL,GAAY;AACVC,UAAMxB;AADI,GAAZ;AAGA,OAAKsB,MAAL,GAAcA,MAAd;AACD,CAZM;;AALP;;;AAmBAD,QAAQxB,SAAR,CAAkB4B,IAAlB,GAAyB,UAAUC,GAAV,EAAe;AACtC,MAAI,CAACxD,UAAUhE,MAAf,EAAuB,OAAO,KAAK+F,MAAZ;AACvB,OAAKA,MAAL,GAAeyB,eAAezH,KAAf,GAAuByH,GAAvB,GAA6B,IAA5C;AACA,SAAO,IAAP;AACD,CAJD;;AAMAL,QAAQxB,SAAR,CAAkB8B,GAAlB,GAAwB,UAAUC,MAAV,EAAkB7G,KAAlB,EAAyB;AAC/C,MAAImD,UAAUhE,MAAV,GAAmB,CAAnB,IAAwB0H,OAAO1H,MAAP,GAAgB,CAA5C,EAA+C;AAC7C,UAAM2H,MAAM,8CAAN,CAAN;AACD;;AAED,MAAIC,WAAW,aAAa,OAAOF,OAAO,CAAP,CAApB,GAAgCA,OAAO,CAAP,CAAhC,GAA4C,KAAK3B,MAAL,CAAY,CAAZ,EAAe8B,OAAf,CAAuBH,OAAO,CAAP,CAAvB,CAA3D;AAAA,MACII,WAAW,aAAa,OAAOJ,OAAO,CAAP,CAApB,GAAgCA,OAAO,CAAP,CAAhC,GAA4CvG,OAAOkF,YAAP,CAAoBpG,IAApB,CAAyB,IAAzB,EAA+B,CAA/B,EAAkC4H,OAAlC,CAA0CH,OAAO,CAAP,CAA1C,CAD3D;;AAGA,MAAIK,YAAY5G,OAAOkF,YAAP,CAAoBpG,IAApB,CAAyB,IAAzB,EAA+ByH,OAAO,CAAP,CAA/B,CAAhB;AAAA,MACIM,YAAY7G,OAAO8G,SAAP,CAAiBhI,IAAjB,CAAsB,IAAtB,EAA4ByH,OAAO,CAAP,CAA5B,CADhB;;AAGA;AACA,MAAIK,UAAU/H,MAAV,GAAmB,CAAvB,EAA0B;AACxBiF,WAAOM,YAAP,CAAoBtF,IAApB,CAAyB,IAAzB,EAA+BuC,OAAOkF,OAAO,CAAP,CAAP,CAA/B;AACAE,eAAW,KAAK7B,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAwB,CAAnC;AACD;;AAED;AACA,MAAIgI,UAAUhI,MAAV,GAAmB,CAAvB,EAA0B;AACxBiF,WAAOO,SAAP,CAAiBvF,IAAjB,CAAsB,IAAtB,EAA4BuC,OAAOkF,OAAO,CAAP,CAAP,CAA5B;AACAI,eAAW,KAAK/B,MAAL,CAAY/F,MAAZ,GAAqB,CAAhC;AACD;;AAED;AACA,OAAK+F,MAAL,CAAa+B,QAAb,EAAyBF,QAAzB,IAAsC/G,KAAtC;AACA,SAAO,IAAP;AACD,CA1BD;;AA4BAsG,QAAQxB,SAAR,CAAkB2B,IAAlB,GAAyB,UAASlE,GAAT,EAAa;AACpC,MAAI,CAACY,UAAUhE,MAAf,EAAuB,OAAO,KAAKqH,IAAL,CAAU,MAAV,CAAP;AACvB,OAAKA,IAAL,CAAU,MAAV,IAAqBjE,MAAMZ,OAAOY,GAAP,CAAN,GAAoB0C,SAAzC;AACA,SAAO,IAAP;AACD,CAJD;;AAMA,oBAAOqB,QAAQxB,SAAf,EAA0BV,MAA1B;AACA,oBAAOkC,QAAQxB,SAAf,EAA0BmB,GAA1B;AACA,oBAAOK,QAAQxB,SAAf,EAA0BoB,MAA1B;AACA,oBAAOI,QAAQxB,SAAf,EAA0BqB,MAA1B;AACA,oBAAOG,QAAQxB,SAAf,EAA0BxE,MAA1B;AACA,oBAAOgG,QAAQxB,SAAf,EAA0BsB,IAA1B;AACA,oBAAOE,QAAQxB,SAAf,EAA0BuB,MAA1B;AACA,oBAAOC,QAAQxB,SAAf,EAA0BuC,kBAA1B;AACAf,QAAQgB,MAAR,GAAiB,uBAAQhB,OAAR,CAAjB;;kBAEeA,O;;;;;;;;;;;;;AC9Ef;;AACA;;AAEA,SAASiB,OAAT,CAAiBZ,GAAjB,EAAsBa,KAAtB,EAA6BC,GAA7B,EAAiC;AAC/B,MAAIb,MAAMD,IAAI5B,KAAJ,CAAUyC,SAAO,CAAjB,EAAqBC,MAAMA,MAAI,CAAV,GAAcd,IAAIxH,MAAvC,CAAV;AAAA,MACIuI,MAAM,CADV;AAAA,MAEIC,MAAM,IAFV;;AAIA;AACA,kBAAKf,GAAL,EAAU,UAASgB,GAAT,EAAc1E,CAAd,EAAgB;AACxB,QAAI,OAAO0E,GAAP,KAAe,QAAf,IAA2B,CAAC9B,MAAM+B,WAAWD,GAAX,CAAN,CAAhC,EAAwD;AACtDF,aAAOG,WAAWD,GAAX,CAAP;AACD;AACF,GAJD;AAKA,SAAOF,MAAMd,IAAIzH,MAAjB;AACD;;AAED,SAAS2I,OAAT,CAAiBnB,GAAjB,EAAsBa,KAAtB,EAA6BC,GAA7B,EAAiC;AAC/B,MAAIb,MAAMD,IAAI5B,KAAJ,CAAUyC,SAAO,CAAjB,EAAqBC,MAAMA,MAAI,CAAV,GAAcd,IAAIxH,MAAvC,CAAV;AAAA,MACI4I,OAAO,EADX;;AAGA;AACA,kBAAKnB,GAAL,EAAU,UAASgB,GAAT,EAAc1E,CAAd,EAAgB;AACxB,QAAI,OAAO0E,GAAP,KAAe,QAAf,IAA2B,CAAC9B,MAAM+B,WAAWD,GAAX,CAAN,CAAhC,EAAwD;AACtDG,WAAKzD,IAAL,CAAUuD,WAAWD,GAAX,CAAV;AACD;AACF,GAJD;AAKA,SAAOhG,KAAKoG,GAAL,CAASC,KAAT,CAAerG,IAAf,EAAqBmG,IAArB,CAAP;AACD;;AAED,SAASG,OAAT,CAAiBvB,GAAjB,EAAsBa,KAAtB,EAA6BC,GAA7B,EAAiC;AAC/B,MAAIb,MAAMD,IAAI5B,KAAJ,CAAUyC,SAAO,CAAjB,EAAqBC,MAAMA,MAAI,CAAV,GAAcd,IAAIxH,MAAvC,CAAV;AAAA,MACI4I,OAAO,EADX;;AAGA;AACA,kBAAKnB,GAAL,EAAU,UAASgB,GAAT,EAAc1E,CAAd,EAAgB;AACxB,QAAI,OAAO0E,GAAP,KAAe,QAAf,IAA2B,CAAC9B,MAAM+B,WAAWD,GAAX,CAAN,CAAhC,EAAwD;AACtDG,WAAKzD,IAAL,CAAUuD,WAAWD,GAAX,CAAV;AACD;AACF,GAJD;AAKA,SAAOhG,KAAKuG,GAAL,CAASF,KAAT,CAAerG,IAAf,EAAqBmG,IAArB,CAAP;AACD;;AAED,SAASL,GAAT,CAAaf,GAAb,EAAkBa,KAAlB,EAAyBC,GAAzB,EAA6B;AAC3B;AACA,MAAIb,MAAMD,IAAI5B,KAAJ,CAAUyC,SAAO,CAAjB,EAAqBC,MAAMA,MAAI,CAAV,GAAcd,IAAIxH,MAAvC,CAAV;AAAA,MACIuI,MAAM,CADV;;AAGA;AACA,kBAAKd,GAAL,EAAU,UAASgB,GAAT,EAAc1E,CAAd,EAAgB;AACxB,QAAI,OAAO0E,GAAP,KAAe,QAAf,IAA2B,CAAC9B,MAAM+B,WAAWD,GAAX,CAAN,CAAhC,EAAwD;AACtDF,aAAOG,WAAWD,GAAX,CAAP;AACD;AACF,GAJD;AAKA,SAAOF,GAAP;AACD;;AAED,IAAMU,mBAAmB,SAAnBA,gBAAmB,CAAUzB,GAAV,EAAe;AACtC,SAAOY,QAAQZ,GAAR,EAAa,CAAb,CAAP;AACD,CAFD;AAGA,IAAM0B,gBAAgBD,gBAAtB;;AAEA,IAAME,eAAe,SAAfA,YAAe,CAAU3B,GAAV,EAAe;AAClC,SAAOe,IAAIf,GAAJ,EAAS,CAAT,CAAP;AACD,CAFD;AAGA,IAAM4B,YAAYD,YAAlB;;AAEA,IAAME,mBAAmB,SAAnBA,gBAAmB,CAAU7B,GAAV,EAAe;AACtC,SAAOmB,QAAQnB,GAAR,EAAa,CAAb,CAAP;AACD,CAFD;AAGA,IAAM8B,gBAAgBD,gBAAtB;;AAEA,IAAME,mBAAmB,SAAnBA,gBAAmB,CAAU/B,GAAV,EAAe;AACtC,SAAOuB,QAAQvB,GAAR,EAAa,CAAb,CAAP;AACD,CAFD;AAGA,IAAMgC,gBAAgBD,gBAAtB;;AAEA,IAAME,iBAAiB,SAAjBA,cAAiB,CAAUjC,GAAV,EAAe;AACpC,SAAOA,IAAI,CAAJ,CAAP;AACD,CAFD;AAGA,IAAMkC,cAAcD,cAApB;;kBAEe;AACbrB,kBADa;AAEbO,kBAFa;AAGbI,kBAHa;AAIbR,UAJa;AAKbU,oCALa;AAMbC,8BANa;AAObC,4BAPa;AAQbC,sBARa;AASbC,oCATa;AAUbC,8BAVa;AAWbC,oCAXa;AAYbC,8BAZa;AAabC,gCAba;AAcbC;AAda,C;;;;;;;;;;;;QC1ECC,a,GAAAA,a;AARhB;;;;;;;;AAQO,SAASA,aAAT,CAAuBC,WAAvB,EAAoC;AACzC,MAAI,OAAOA,WAAP,KAAuB,QAA3B,EAAqC;AACnC,WAAOA,WAAP;AACD;AACD,SAAOA,YAAYC,OAAZ,CAAoB,eAApB,EAAqC,EAArC,CAAP;AACD,C;;;;;;;;;;;;;;;QCXeC,U,GAAAA,U;;AAFhB;;AAEO,SAASA,UAAT,CAAoBhG,MAApB,EAA4B;AACjC,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,UAAUhE,MAA9B,EAAsC+D,GAAtC,EAA2C;AACzC,oBAAKC,UAAUD,CAAV,CAAL,EAAmB,UAASE,IAAT,EAAe8F,GAAf,EAAmB;AACpC,UAAM,OAAOjG,OAAOiG,GAAP,CAAP,KAAuB,WAAvB,IAAsC,OAAO9F,IAAP,KAAgB,WAAxD,IACE,QAAOH,OAAOiG,GAAP,CAAP,MAAuB,QAAvB,IAAsC,QAAO9F,IAAP,yCAAOA,IAAP,OAAgB,QADxD,IAEEH,OAAOiG,GAAP,MAAgB,IAAhB,IAAsC9F,SAAS,IAFrD,EAE6D;AACvD6F,mBAAWhG,OAAOiG,GAAP,CAAX,EAAwB9F,IAAxB;AACL,OAJD,MAKK;AACHH,eAAOiG,GAAP,IAAc9F,IAAd;AACD;AACF,KATD;AAUD;AACD,SAAOH,MAAP;AACD,C;;;;;;;;;;;;kBCduBkG,oB;;AAFxB;;;;;;;;AAEe,SAASA,oBAAT,GAKP;AAAA,iFAAJ,EAAI;AAAA,MAJNC,OAIM,QAJNA,OAIM;AAAA,wBAHNpE,KAGM;AAAA,MAHNA,KAGM,8BAHE,UAGF;AAAA,uBAFNyB,IAEM;AAAA,MAFNA,IAEM,6BAFC,MAED;AAAA,MADNC,IACM,QADNA,IACM;;AACN,MAAM2C,WAAW,qBAAjB;AACA,MAAMC,gBAAgB,6BAAIF,QAAQG,UAAR,CAAmBC,QAAvB,GACnBC,IADmB,CACd;AAAA,WAASC,MAAMC,SAAN,KAAoBN,QAA7B;AAAA,GADc,CAAtB;AAEA,MAAIC,aAAJ,EAAmB;;AAEnB,MAAMM,SAAS1J,SAASC,aAAT,CAAuB,QAAvB,CAAf;AACAyJ,SAAO5I,SAAP,GAAmBgE,KAAnB;AACA4E,SAAOD,SAAP,GAAmBN,QAAnB;AACAO,SAAO3I,gBAAP,CAAwB,OAAxB,EAAiC;AAAA,WAAS,+BAAgB,EAAEzB,YAAF,EAASiH,UAAT,EAAeC,UAAf,EAAhB,CAAT;AAAA,GAAjC;AACA0C,UAAQG,UAAR,CAAmBM,YAAnB,CAAgCD,MAAhC,EAAwCR,QAAQU,WAAhD;AACD,E;;;;;;;;;;;;kBCfuBC,W;;AAHxB;;;;AACA;;;;AAEe,SAASA,WAAT,CAAqBC,GAArB,EAA0B;AAAA,MAC/BxF,IAD+B,GACJwF,GADI,CAC/BxF,IAD+B;AAAA,MACzByF,OADyB,GACJD,GADI,CACzBC,OADyB;AAAA,MAChBC,OADgB,GACJF,GADI,CAChBE,OADgB;;AAEvC,MAAID,OAAJ,EAAa;AACX,QAAIA,UAAU,CAAV,IAAeA,UAAU,CAA7B,EAAgC,MAAMnD,MAAM,8CAAN,CAAN;AAChCqD,yBAAWC,MAAX,CAAkB5F,IAAlB,EAAwB,EAAEyF,gBAAF,EAAWC,gBAAX,EAAxB,EACGG,IADH,CACQ,UAACC,IAAD,EAAU;AACd,6BAAOA,IAAP,EAAa,YAAb;AACD,KAHH;AAID;;AAED,MAAI,CAACL,OAAL,EAAc;AACZE,yBAAWC,MAAX,CAAkB5F,IAAlB,EACG6F,IADH,CACQ,UAACC,IAAD,EAAU;AACd,6BAAOA,IAAP,EAAa,WAAb;AACD,KAHH;AAID;AACF,C;;;;;;;;;;;;kBCFuBC,U;AAjBxB,SAASC,kBAAT,CAA4B9D,IAA5B,EAAkC;AAChC,MAAI+D,aAAa,EAAjB;;AAEA/D,OAAKgE,OAAL,CAAa,UAACvF,GAAD,EAAMjC,CAAN,EAAY;AACvBiC,QAAIuF,OAAJ,CAAY,UAACtF,IAAD,EAAOuF,CAAP,EAAa;AACvBF,oBAAc9I,OAAOyD,IAAP,EAAa4D,OAAb,CAAqB,IAArB,EAA2B,EAA3B,CAAd;AACA,UAAI7D,IAAIhG,MAAJ,GAAawL,IAAI,CAArB,EAAwB;AACtBF,sBAAc,GAAd;AACD;AACF,KALD;AAMA,QAAI/D,KAAKvH,MAAL,GAAc+D,IAAI,CAAtB,EAAyB;AACvBuH,oBAAc,IAAd;AACD;AACF,GAVD;AAWA,0CAAsCG,mBAAmBH,UAAnB,CAAtC;AACD;;AAEc,SAASF,UAAT,CAAoBP,GAApB,EAAyB;AAAA,MAC9BvD,IAD8B,GACfuD,GADe,CAC9BvD,IAD8B;AAAA,MACxBC,IADwB,GACfsD,GADe,CACxBtD,IADwB;;AAEtC,MAAMmE,mBAAmB,CAAC,MAAD,EAAS,KAAT,CAAzB;AACA,MAAMC,SAASrE,KAAKsE,WAAL,EAAf;AACA,MAAI,CAACF,iBAAiBG,QAAjB,CAA0BvE,IAA1B,CAAL,EAAsC;AACpC,UAAM,IAAIK,KAAJ,CAAU,4BAAV,CAAN;AACD;;AAED,MAAMmE,WAAW,OAAjB;AACA,MAAIC,aAAaL,iBAAiB,CAAjB,CAAjB;AACA,MAAIM,UAAU,EAAd;;AAEA,MAAIL,WAAW,MAAf,EAAuB;AACrBK,iDAA2CP,mBAAmBQ,KAAKC,SAAL,CAAe3E,IAAf,CAAnB,CAA3C;AACD;;AAED,MAAIoE,WAAW,KAAf,EAAsB;AACpBK,cAAUX,mBAAmB9D,IAAnB,CAAV;AACAwE,iBAAaJ,MAAb;AACD;;AAED,MAAMQ,cAAcpL,SAASC,aAAT,CAAuB,GAAvB,CAApB;AACAmL,cAAYC,YAAZ,CAAyB,MAAzB,EAAiCJ,OAAjC;AACAG,cAAYC,YAAZ,CAAyB,UAAzB,EAAwCN,QAAxC,SAAoDC,UAApD;AACAhL,WAASE,IAAT,CAAcC,WAAd,CAA0BiL,WAA1B;AACAA,cAAYE,KAAZ;AACAtL,WAASE,IAAT,CAAcI,WAAd,CAA0B8K,WAA1B;AACD,C;;;;;;AC5CD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAwB,+BAA+B,SAA6E,CAAC,wEAAwE,oBAAoB,gCAAgC,+BAA+B,eAAe,+BAA+B,mBAAmB,MAAM,kBAAkB,uEAAuE,KAAK,KAAK,iBAAiB,kHAAkH,EAAE,4EAA4E,SAAS,UAAU,mUAAmU,oBAAoB,wBAAwB,iBAAiB,qBAAqB,gBAAgB,iBAAiB,qOAAqO,eAAe,yBAAyB,0BAA0B,SAAS,6CAA6C,uGAAuG,+TAA+T,qBAAqB,8IAA8I,uCAAuC,6CAA6C,YAAY,IAAI,4BAA4B,wBAAwB,sJAAsJ,kFAAkF,yHAAyH,+QAA+Q,kDAAkD,cAAc,qBAAqB,mCAAmC,wCAAwC,kCAAkC,kFAAkF,GAAG,mIAAmI,EAAE,oHAAoH,sHAAsH,sLAAsL,oBAAoB,qHAAqH,oCAAoC,4OAA4O,ibAAib,qBAAqB,skBAAskB,oBAAoB,0HAA0H,mBAAmB,0jBAA0jB,uBAAuB,yBAAyB,cAAc,2CAA2C,MAAM,iDAAiD,kDAAkD,uCAAuC,kDAAkD,sBAAsB,oDAAoD,qFAAqF,wBAAwB,oDAAoD,qFAAqF,uBAAuB,oCAAoC,4dAA4d,0BAA0B,SAAS,oDAAoD,+BAA+B,0DAA0D,iEAAiE,qBAAqB,WAAW,6HAA6H,6GAA6G,iGAAiG,4DAA4D,yCAAyC,0CAA0C,2BAA2B,4GAA4G,uBAAuB,sDAAsD,0BAA0B,iBAAiB,oCAAoC,mDAAmD,6FAA6F,gBAAgB,wBAAwB,gCAAgC,wCAAwC,kFAAkF,8NAA8N,6DAA6D,8HAA8H,qBAAqB,oCAAoC,wBAAwB,OAAO,+DAA+D,yBAAyB,WAAW,uBAAuB,6BAA6B,oBAAoB,6DAA6D,oCAAoC,iBAAiB,iCAAiC,2BAA2B,gBAAgB,yCAAyC,6CAA6C,6EAA6E,0BAA0B,4DAA4D,2BAA2B,iCAAiC,uBAAuB,8EAA8E,yBAAyB,mEAAmE,gGAAgG,2MAA2M,qBAAqB,wKAAwK,oBAAoB,2HAA2H,sBAAsB,wKAAwK,qCAAqC,yIAAyI,mBAAmB,WAAW,cAAc,8EAA8E,yBAAyB,miBAAmiB,qBAAqB,0aAA0a,sBAAsB,2NAA2N,qBAAqB,qEAAqE,sBAAsB,uEAAuE,uBAAuB,yEAAyE,oBAAoB,mEAAmE,GAAG,E;;;;;;;;;ACVzsY;;AACA;;AAEAG,OAAOC,OAAP,GAAiB;AACfC,WAASC,cADM;AAEfA,yBAFe;AAGftF;AAHe,CAAjB,C;;;;;;;;;;;;;;;;kQCHA;;;AAQA;;;AAFA;;;;;oBA8+BSA,O;;;;AAn/BT;;IAAYhD,E;;AACZ;;;;AAEA;;;;AACA;;;;AAIA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;;;AAEA;AACO,IAAMsI,4BAAU,SAAVA,OAAU,GAAwB;AAAA;;AAAA,MAAdC,OAAc,uEAAJ,EAAI;;AAC7C,MAAI,gBAAgBD,OAAhB,KAA4B,KAAhC,EAAuC;AACrC,WAAO,IAAIA,OAAJ,CAAYC,OAAZ,CAAP;AACD;;AAED,OAAKC,EAAL,GAAUA,WAAV,CAL6C,CAK/B;AACd,OAAKxI,EAAL,GAAUA,EAAV;;AAEA,MAAMyI,kBAAkB,IAAxB;AACA,MAAMC,iBAAiB;AACrBC,6BAAyB,IADJ;AAErBC,wBAAoB,KAFC;;AAIrBC,eAAWlH,SAJU,EAIC;AACtBmH,sBAAkBnH,SALG,EAKQ;;AAE7B;AACA;;AAEAoH,WAAOpH,SAVc;AAWrBqH,eAAW,IAXU;;AAarBC,cAAUtH,SAbW;;AAerBuH,WAAOvH,SAfc;AAgBrBwH,WAAO,cAhBc;;AAkBrBC,YAAQ,CACN,SADM,EACK,SADL,EACgB,SADhB,EAC2B,SAD3B,EACsC,SADtC,EACiD,SADjD,EAEN,SAFM,EAEK,SAFL,EAEgB,SAFhB,EAE2B,SAF3B,EAEsC,SAFtC,EAEiD,SAFjD,EAGN,SAHM,EAGK,SAHL,EAGgB,SAHhB,EAG2B,SAH3B,EAGsC,SAHtC,EAGiD,SAHjD,EAIN,SAJM,EAIK,SAJL,EAIgB,SAJhB,EAI2B,SAJ3B,EAIsC,SAJtC,EAIiD,SAJjD,EAKN,SALM,EAKK,SALL,EAKgB,SALhB,CAlBa;;AA0BrBC,kBAAc,EA1BO;AA2BrBC,QAAI;AACFC,yBAAmB;AADjB,KA3BiB;AA8BrBC,WAAO;AACLC,8BAAwB;AADnB,KA9Bc;;AAkCrBC,aAAS,iBAlCY;AAmCrBC,YAAQ,EAnCa;AAoCrBC,kBAAc,EApCO;AAqCrBC,wBAAoBlI,SArCC;AAsCrBmI,kBAAc,EAtCO;AAuCrBC,uBAAmB,IAvCE;AAwCrBC,aAAS,SAxCY;AAyCrBC,gBAAYtI,SAzCS;AA0CrBuI,mBAAevI,SA1CM;;AA4CrBwI,aAASxI,SA5CY,EA4CD;;AAEpB;AACAwB,UAAMxB,SA/Ce;AAgDrByI,aAAS,KAhDY;AAiDrBC,gBAAY1I,SAjDS;AAkDrB2I,YAAQ;AACNC,YAAM,IADA;AAENhN,gBAAU,OAFJ;AAGNiN,iBAAW,KAHL;AAIN9I,aAAO;AACL+I,uBAAe;AADV,OAJD;AAONC,kBAAY;AACVC,gBAAQ,CADE,EACC;AACXC,eAAO,CAFG,CAED;AAFC,OAPN;AAWNzO,eAAS;AACPoO,cAAM,IADC;AAEPM,iBAAS;AAFF,OAXH;AAeN/H,YAAMnB;AAfA,KAlDa;;AAoErBmJ,UAAM,EApEe;AAqErBC,WAAO,EArEc;AAsErBC,UAAM;AACJ;AADI,KAtEe;AAyErB5N,aAAS;AACPd,WAAK;AADE,KAzEY;AA4ErB2O,WAAO;AACLC,aAAO;AACLC,gBAAQ;AACNC,mBAAS;AADH;AADH,OADF;AAMLC,SAAG,CANE;AAOLd,YAAM,IAPD;AAQLe,mBAAa;AARR,KA5Ec;AAsFrBnP,aAAS;AACPoP,kBAAY,IADL;AAEP/D,cAAQ;AACN;AADM;AAFD,KAtFY;AA4FrB/J,gBAAY;AACV;AADU,KA5FS;AA+FrB2F,UAAM;AACJoI,aAAO,IADH;AAEJC,iBAAW;AACVL,iBAAS,IADC;AAEVM,mBAAW,IAFD;AAGVC,kBAAU;AAHA,OAFP;AAOLC,kBAAY,oBAACC,CAAD,EAAI/F,OAAJ,EAAgB;AAC3B,YAAMgG,gBAAgB,MAAKC,IAAL,CAAUC,UAAV,CAAqBxD,EAArB,CAAwByD,QAAxB,EAAtB;AACA,YAAM7H,MAAM0H,cAAcI,MAAd,CAAqB,UAACC,IAAD,EAAOC,IAAP;AAAA,iBAAgBD,OAAOC,KAAK1P,KAA5B;AAAA,SAArB,EAAwD,CAAxD,CAAZ;AACA,uCAAgB0H,GAAhB;AACA;AAXI,KA/Fe;AA4GtBiI,UAAM;AACJ1L,SAAG;AACD4J,cAAM;AADL;AADC,KA5GgB;AAiHtB+B,8BAA0B;AACxB/B,YAAM5I,SADkB;AAExB0E,iBAAW;AAFa,KAjHJ;AAqHtBkG,cAAU,KArHY;AAsHtBC,WAAO;AACLC,cAAQ;AADH,KAtHe;AAyHtBC,qBAAiB,KAzHK;AA0HtBC,YAAQ;AACNC,aAAO,IADD;AAENC,oBAAc,IAFR;AAGNC,gBAAU;AACRvC,cAAM,KADE;AAERwC,wBAAgB,UAFR;AAGRC,kBAAU;AAHF,OAHJ;AAQNC,6BAAuB,KARjB;AASNC,aAAO,IATD;AAUNC,gBAAU,YAVJ;AAWNC,mBAAa;AAXP,KA1Hc;AAuItBC,WAAO,KAvIe;AAwItBC,WAAO,KAxIe;AAyItBC,eAAW,KAzIW;AA0IrBC,gBAAY;AACVC,WAAK,OADK;AAEVC,eAAS;AACPnD,cAAM,IADC;AAEPS,cAAM,GAFC;AAGPD,eAAO;AAHA,OAFC;AAOV4C,kBAAY;AAPF,KA1IS;AAmJrBC,aAAS;AAnJY,GAAvB;;AAsJA,OAAK3K,MAAL,gBAAmB,4BAAWyF,cAAX,EAA2BH,OAA3B,CAAnB;;AAEA,MAAIA,QAAQsF,OAAZ,EAAqB;AACnB,QAAI,CAACC,gBAASvF,QAAQsF,OAAjB,CAAL,EAA+B;AAC7BE,cAAQC,GAAR,CAAY,0BAAZ,EAAwCzF,QAAQsF,OAAhD;AACD;AACD,SAAK5K,MAAL,CAAYmG,MAAZ,GAAqB0E,gBAASvF,QAAQsF,OAAjB,EAA0BzE,MAA/C;AACD;;AAED,MAAI,KAAKnG,MAAL,CAAYE,IAAhB,EAAsB;AACpB;AACA,SAAKF,MAAL,CAAYE,IAAZ,GAAmB8K,kBAAkB,KAAKhL,MAAL,CAAYE,IAA9B,CAAnB;AACD;;AAED;AACA,MAAG,KAAKF,MAAL,CAAYE,IAAZ,IAAoB,KAAKF,MAAL,CAAYE,IAAZ,CAAiBuE,QAAjB,CAA0B,QAA1B,CAAvB,EAA4D;AAC1D,SAAKzE,MAAL,CAAYqK,KAAZ,GAAoB,IAApB;AACA,SAAKrK,MAAL,CAAYE,IAAZ,GAAmB,KAAKF,MAAL,CAAYE,IAAZ,CAAiBuC,OAAjB,CAAyB,QAAzB,EAAmC,EAAnC,CAAnB;AACA,SAAKzC,MAAL,CAAYqH,MAAZ,CAAmBC,IAAnB,GAA0B,KAA1B;AACA,SAAKtH,MAAL,CAAYiL,QAAZ,GAAuB,QAAvB;AACA,SAAKjL,MAAL,CAAY0G,MAAZ,GAAqB,CAAC,KAAD,EAAQ,KAAR,CAArB;AACA,SAAK1G,MAAL,CAAYmG,MAAZ,GAAqB,CACnB,KAAKnG,MAAL,CAAYmG,MAAZ,CAAmB,CAAnB,CADmB,EAEnB,KAAKnG,MAAL,CAAYmG,MAAZ,CAAmB,CAAnB,CAFmB,CAArB;AAID;;AAED;AACA,MAAI,KAAKnG,MAAL,CAAYiL,QAAhB,EAA0B;AACxB,SAAKjL,MAAL,CAAYmH,OAAZ,GAAsB,IAAtB;AACD;;AAED;AACA,MAAI,KAAKnH,MAAL,CAAYsK,SAAhB,EAA2B;AACzB,SAAKtK,MAAL,CAAYqH,MAAZ,CAAmBC,IAAnB,GAA0B,KAA1B;AACA,SAAKtH,MAAL,CAAY6H,IAAZ,GAAmB;AACjBrK,SAAG;AACD8J,cAAM;AADL,OADc;AAIjB5J,SAAG;AACD4J,cAAM;AADL;AAJc,KAAnB;AAQA,SAAKtH,MAAL,CAAYoJ,IAAZ,GAAmB;AACjB5L,SAAG;AACD8J,cAAM;AADL,OADc;AAIjB5J,SAAG;AACD4J,cAAM;AADL;AAJc,KAAnB;AAQD;;AAED;AACA,MAAI,KAAKtH,MAAL,CAAY4F,SAAhB,EAA2B;AACzB,SAAKsF,EAAL,CAAQ,KAAKlL,MAAL,CAAY4F,SAApB;AACD;;AAED,MAAIN,QAAQ+B,MAAR,KAAmB3I,SAAnB,IAAgC,CAAC4G,QAAQ+B,MAA7C,EAAqD;AACnD,SAAKrH,MAAL,CAAYqH,MAAZ,gBACK/B,OADL;AAEEgC,YAAM;AAFR;AAID;;AAED,MAAIhC,QAAQwC,KAAR,IAAiBxC,QAAQwC,KAAR,CAAcqD,OAAnC,EAA4C;AAC1C;AACA,SAAKnL,MAAL,CAAYmG,MAAZ,GAAqBb,QAAQwC,KAAR,CAAcqD,OAAnC;AACD;;AAED,MAAI,KAAKnL,MAAL,CAAYqH,MAAZ,IACG,KAAKrH,MAAL,CAAYqH,MAAZ,CAAmBnO,OADtB,IAEG,KAAK8G,MAAL,CAAYqH,MAAZ,CAAmBnO,OAAnB,CAA2BoO,IAA3B,KAAoC,KAFvC,IAGG,KAAKtH,MAAL,CAAY9G,OAAZ,CAAoBoO,IAApB,KAA6B5I,SAHpC,EAG+C;AAC7C,SAAKsB,MAAL,CAAY9G,OAAZ,GAAsB,EAAEoO,MAAM,KAAR,EAAtB;AACD;;AAED,OAAK8D,OAAL,GAAe,IAAIrL,gBAAJ,CAAY,KAAKC,MAAjB,CAAf;AACA,OAAK8I,IAAL,GAAY;AACVuC,eAAW,KADD;AAEVC,eAAW,KAFD;AAGVvC,gBAAY,CAAE,eAAF;AAHF,GAAZ;;AAMA1D,UAAQkG,OAAR,CAAgBxN,IAAhB,CAAqB,IAArB;;AAEA,MAAI,KAAKiC,MAAL,CAAY2F,kBAAhB,EAAoC;AAClC,SAAK6F,OAAL;AACD;;AAED,MAAI,CAAC,CAAC,KAAKxL,MAAL,CAAYkH,OAAlB,EAA2B;AACzB,SAAKuE,MAAL,CAAY,KAAKzL,MAAL,CAAYkH,OAAxB;AACD;AACD,OAAKlH,MAAL,CAAY0L,oBAAZ,GAAmC/R,SAASgS,eAA5C;;AAEA,MAAI,CAAC,KAAK3L,MAAL,CAAYuG,KAAZ,CAAkBC,sBAAvB,EAA+C;AAC7C,SAAKxG,MAAL,CAAYG,IAAZ,CAAiBwI,UAAjB,GAA8B,YAAM,CAAE,CAAtC;AACD;;AAED,MAAIrD,QAAQnF,IAAR,IAAgBmF,QAAQnF,IAAR,CAAawI,UAAjC,EAA6C;AAC3C,SAAK3I,MAAL,CAAYG,IAAZ,CAAiBwI,UAAjB,GAA8B,UAACC,CAAD,EAAI/F,OAAJ,EAAgB;AAC5C,UAAM+I,WAAWtG,QAAQnF,IAAR,CAAawI,UAAb,CAAwBkD,IAAxB,CAA6B,IAA7B,EAAmCjD,CAAnC,EAAsC/F,OAAtC,CAAjB;AACA+I;;AAEA,UAAI,MAAK5L,MAAL,CAAYuG,KAAZ,CAAkBC,sBAAtB,EAA8C;AAC5C,YAAMqC,gBAAgB,MAAKC,IAAL,CAAUC,UAAV,CAAqBxD,EAArB,CAAwByD,QAAxB,EAAtB;AACA,YAAM7H,MAAM0H,cAAcI,MAAd,CAAqB,UAACC,IAAD,EAAOC,IAAP;AAAA,iBAAgBD,OAAOC,KAAK1P,KAA5B;AAAA,SAArB,EAAwD,CAAxD,CAAZ;AACA,uCAAgB0H,GAAhB;AACD;AACF,KATD;AAUD;AAEF,CA/QM;;AAkRPkE,QAAQyG,SAAR,GAAoB,EAAE1G,SAAS,EAAX,EAApB;AACA,IAAI,OAAO2G,MAAP,KAAkB,WAAtB,EAAmC;AACjC1G,UAAQyG,SAAR,CAAkB1G,OAAlB,GAA4B,yBAAUC,OAAV,CAA5B;AACD;AACDA,QAAQkG,OAAR,GAAkB,EAAlB;;AAEAlG,QAAQ2G,QAAR,GAAmB,UAAUC,IAAV,EAAgBC,OAAhB,EAAyB;AAC1C7G,UAAQyG,SAAR,CAAkBG,IAAlB,IAA0B5G,QAAQyG,SAAR,CAAkBG,IAAlB,KAA2B,EAArD;AACA,kBAAKC,OAAL,EAAc,UAASC,MAAT,EAAiBxJ,GAAjB,EAAqB;AACjC0C,YAAQyG,SAAR,CAAkBG,IAAlB,EAAwBtJ,GAAxB,IAA+BwJ,MAA/B;AACD,GAFD;AAGD,CALD;;AAOA9G,QAAQnC,IAAR,GAAe,UAASxG,MAAT,EAAgB;AAC7B,MAAI,CAACE,UAAUhE,MAAf,EAAuB,OAAOyM,QAAQkG,OAAf;AACvB,MAAML,KAAKxO,OAAO0P,QAAP,GAAkB1P,MAAlB,GAA2B/C,SAAS0S,aAAT,CAAuB3P,MAAvB,CAAtC;AACA,MAAIT,QAAQ,IAAZ;AACA,kBAAKoJ,QAAQkG,OAAb,EAAsB,UAASe,MAAT,EAAgB;AACpC,QAAIpB,MAAMoB,OAAOtM,MAAP,CAAc4F,SAAxB,EAAkC;AAChC3J,cAAQqQ,MAAR;AACA,aAAO,KAAP;AACD;AACF,GALD;AAMA,SAAOrQ,KAAP;AACD,CAXD;;AAcE;AACA;;AAEFoJ,QAAQ9G,SAAR,CAAkBgO,UAAlB,GAA+B,UAAS9I,GAAT,EAAa;AAC1C,MAAI,KAAKzD,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,0EAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAZ;AACvB,MAAM8I,OAAO,KAAK9I,MAAlB;AACA,kBAAKyD,GAAL,EAAU,UAAS5G,IAAT,EAAe8F,GAAf,EAAmB;AAC3B;AACA,QAAIA,QAAQ,WAAZ,EAAyB;AACvBA,YAAM,MAAN;AACD;AACDmG,SAAKnG,GAAL,IAAY9F,IAAZ;AACD,GAND;AAOA,SAAO,IAAP;AACD,CAdD;;AAgBAwI,QAAQ9G,SAAR,CAAkB1F,IAAlB,GAAyB,UAAS2T,EAAT,EAAY;AACjCA,KAAG3T,IAAH,CAAQ,IAAR;AACA,SAAO,IAAP;AACH,CAHD;;AAKAwM,QAAQ9G,SAAR,CAAkBkO,YAAlB,GAAiC,UAAShJ,GAAT,EAAa;AAC5C,MAAI,KAAKzD,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,4EAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAZ;AACvB,OAAKA,MAAL,GAAc,4BAAW,KAAKA,MAAhB,EAAwByD,GAAxB,CAAd;AACA,SAAO,IAAP;AACD,CAPD;;AASA4B,QAAQ9G,SAAR,CAAkB4H,MAAlB,GAA2B,UAAS/F,GAAT,EAAa;AACtC,MAAI,KAAKJ,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,8EAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYmG,MAAnB;AACvB,OAAKnG,MAAL,CAAYmG,MAAZ,GAAsB/F,eAAezH,KAAf,GAAuByH,GAAvB,GAA6B,EAAnD;AACA,SAAO,IAAP;AACD,CAPD;;AASAiF,QAAQ9G,SAAR,CAAkB6H,YAAlB,GAAiC,UAAS3C,GAAT,EAAa;AAC5C,MAAI,KAAKzD,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,0FAAZ;AACD;AACD,MAAMvF,kBAAkB,IAAxB;AACA,MAAI,CAAC5I,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYoG,YAAnB;AACvB,MAAI3C,QAAQ,IAAZ,EAAkB;AAChB,SAAKzD,MAAL,CAAYoG,YAAZ,GAA2B,EAA3B;AACD,GAFD,MAGK,IAAI,QAAO3C,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;AAChC,oBAAKA,GAAL,EAAU,UAAShK,KAAT,EAAgBkJ,GAAhB,EAAoB;AAC5B6C,sBAAgBxF,MAAhB,CAAuBoG,YAAvB,CAAoCzD,GAApC,IAA4ClJ,QAAQA,KAAR,GAAgB,IAA5D;AACD,KAFD;AAGD;AACD,SAAO,IAAP;AACD,CAfD;;AAiBA4L,QAAQ9G,SAAR,CAAkB4B,IAAlB,GAAyBA,cAAzB;;AAEAkF,QAAQ9G,SAAR,CAAkB6I,UAAlB,GAA+B,UAAS/F,GAAT,EAAa;AAC1C,MAAI,KAAKrB,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,sFAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYoH,UAAnB;AACvB,MAAI,OAAO/F,GAAP,KAAe,QAAf,IAA2B,OAAOA,GAAP,KAAe,UAA9C,EAA0D;AACxD,SAAKrB,MAAL,CAAYoH,UAAZ,GAAyB/F,GAAzB;AACD,GAFD,MAGK;AACH,SAAKrB,MAAL,CAAYoH,UAAZ,GAAyB1I,SAAzB;AACD;AACD,SAAO,IAAP;AACD,CAZD;;AAcA2G,QAAQ9G,SAAR,CAAkBmO,OAAlB,GAA4B,YAAU;AACpC,MAAM3F,UAAU,KAAKA,OAAL,EAAhB;AACA,MAAM7G,OAAO,KAAKF,MAAL,CAAYE,IAAzB;AACA,MAAM2C,UAAU,KAAKqI,EAAL,EAAhB;;AAEE;AACF,MAAI7F,QAAQyG,SAAR,CAAkB/E,OAAlB,KACG1B,QAAQyG,SAAR,CAAkB/E,OAAlB,EAA2B7G,IAA3B,CADP,EACwC;AAClCmF,YAAQyG,SAAR,CAAkB/E,OAAlB,EAA2B7G,IAA3B,EAAiCwM,OAAjC,CAAyC7T,IAAzC,CAA8C,IAA9C;AACL;;AAEC;AACF,MAAIgK,OAAJ,EAAa;AACXA,YAAQ8J,SAAR,GAAoB,EAApB;AACD;AACD,OAAK7D,IAAL,CAAUuC,SAAV,GAAsB,KAAtB;AACA,OAAKvC,IAAL,CAAUwC,SAAV,GAAsB,KAAtB;AACA,OAAKxC,IAAL,CAAUC,UAAV,GAAuB,EAAvB;AACA,SAAO,IAAP;AACD,CAnBD;;AAqBA1D,QAAQ9G,SAAR,CAAkB2M,EAAlB,GAAuB,UAASxO,MAAT,EAAgB;AACrC,MAAM8I,kBAAkB,IAAxB;AACA,MAAI,CAAC5I,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAY6F,gBAAnB;AACvB+G,WAAS,YAAU;AACjB,QAAIlQ,UAAUA,WAAW,IAAzB,EAA+B;AAC7B,UAAIA,OAAO0P,QAAX,EAAqB;AACnB5G,wBAAgBxF,MAAhB,CAAuB6F,gBAAvB,GAA0CnJ,MAA1C;AACD,OAFD,MAGK,IAAI/C,SAAS0S,aAAb,EAA4B;AAC/B7G,wBAAgBxF,MAAhB,CAAuB6F,gBAAvB,GAA0ClM,SAAS0S,aAAT,CAAuB3P,MAAvB,CAA1C;AACD;AACF,KAPD,MAQK;AACH8I,sBAAgBxF,MAAhB,CAAuB6F,gBAAvB,GAA0CnH,SAA1C;AACD;AACF,GAZD;AAaA,SAAO,IAAP;AACD,CAjBD;;AAmBA2G,QAAQ9G,SAAR,CAAkBsO,MAAlB,GAA2B,UAASC,GAAT,EAAa;AACtC,MAAI,KAAK9M,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,2CAAZ;AACD;AACD,SAAO,IAAP;AACD,CALD;;AAOA;AACA1F,QAAQ9G,SAAR,CAAkBkI,OAAlB,GAA4B,UAASzK,GAAT,EAAa;AACvC,MAAI,KAAKgE,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,gFAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYyG,OAAnB;AACvB,OAAKzG,MAAL,CAAYyG,OAAZ,GAAuBzK,MAAMZ,OAAOY,GAAP,CAAN,GAAoB,iBAA3C;AACA,SAAO,IAAP;AACD,CAPD;;AASAqJ,QAAQ9G,SAAR,CAAkBmI,MAAlB,GAA2B,UAAStG,GAAT,EAAa;AACtC,MAAI,KAAKJ,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,8EAAZ;AACD;;AAED,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAY0G,MAAnB;AACvB,OAAK1G,MAAL,CAAY0G,MAAZ,GAAsBtG,eAAezH,KAAf,GAAuByH,GAAvB,GAA6B,EAAnD;;AAEA2M,YAAU,IAAV;;AAEA,SAAO,IAAP;AACD,CAXD;;AAaA,SAASA,SAAT,CAAmBvH,eAAnB,EAAmC;AACjC;AACA,MAAIA,gBAAgBrF,IAAhB,GAAuB,CAAvB,EAA0BvH,MAA1B,KAAqC,CAArC,IAA0C,CAAC,gCAAa4M,gBAAgBrF,IAAhB,GAAuB,CAAvB,EAA0B,CAA1B,CAAb,CAA/C,EAA2F;AACzFqF,oBAAgB4F,OAAhB,CAAwB4B,YAAxB,CAAqC,CAArC,EAAwC,UAASvT,KAAT,EAAgB4C,KAAhB,EAAsB;AAC5D,UAAImJ,gBAAgBxF,MAAhB,CAAuB0G,MAAvB,CAA8BrK,QAAM,CAApC,CAAJ,EAA4C;AAC1C,eAAO,kCAAcjB,OAAOoK,gBAAgBxF,MAAhB,CAAuB0G,MAAvB,CAA8BrK,QAAM,CAApC,CAAP,CAAd,CAAP;AACD;AACD,aAAO,kCAAc5C,KAAd,CAAP;AACD,KALuC,CAKtCoS,IALsC,CAKjCrG,eALiC,CAAxC;AAMD,GAPD,MAQK;AACHA,oBAAgB4F,OAAhB,CAAwB6B,SAAxB,CAAkC,CAAlC,EAAqC,UAASxT,KAAT,EAAgB4C,KAAhB,EAAsB;AACzD,UAAIA,QAAQ,CAAR,IAAamJ,gBAAgBxF,MAAhB,CAAuB0G,MAAvB,CAA8BrK,QAAM,CAApC,CAAjB,EAAyD;AACvD,eAAO,kCAAcjB,OAAOoK,gBAAgBxF,MAAhB,CAAuB0G,MAAvB,CAA8BrK,QAAM,CAApC,CAAP,CAAd,CAAP;AACD;AACD,aAAO,kCAAc5C,KAAd,CAAP;AACD,KALoC,CAKnCoS,IALmC,CAK9BrG,eAL8B,CAArC;AAMD;AACF;;AAEDH,QAAQ9G,SAAR,CAAkBoI,YAAlB,GAAiC,UAASlD,GAAT,EAAa;AAC5C,MAAI,KAAKzD,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,0FAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAY2G,YAAnB;AACvB,MAAIlD,QAAQ,IAAZ,EAAkB;AAChB,SAAKzD,MAAL,CAAY2G,YAAZ,GAA2B,EAA3B;AACD,GAFD,MAGK,IAAI,QAAOlD,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;AAChC,oBAAKA,GAAL,EAAU,UAAShK,KAAT,EAAgBkJ,GAAhB,EAAoB;AAC5B,WAAK3C,MAAL,CAAY2G,YAAZ,CAAyBhE,GAAzB,IAAiClJ,QAAQA,KAAR,GAAgB,IAAjD;AACD,KAFS,CAERoS,IAFQ,CAEH,IAFG,CAAV;AAGD;;AAEDqB,YAAU,IAAV;;AAEA,SAAO,IAAP;AACD,CAjBD;;AAmBA,SAASC,aAAT,OAAkD;AAAA,MAAzB3H,eAAyB,QAAzBA,eAAyB;AAAA,MAAR/L,KAAQ,QAARA,KAAQ;;AAChD,MAAI+L,gBAAgBxF,MAAhB,CAAuB4G,kBAA3B,EAA8C;AAC5C,QAAIwG,qBAAqB3T,KAAzB;AACA+L,oBAAgBxF,MAAhB,CAAuB4G,kBAAvB,CAA0CzC,OAA1C,CAAkD,0BAAkB;AAClE,UAAIkJ,eAAezU,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,YAAI0U,YAAYD,eAAe,CAAf,CAAhB;AACA,YAAIC,UAAU7N,IAAV,CAAehG,KAAf,CAAJ,EAA0B;AACxB2T,+BAAqBC,eAAe,CAAf,CAArB;AACD;AACF;AACF,KAPD;AAQA,WAAO,kCAAcD,kBAAd,CAAP;AACD;AACD,MAAI5H,gBAAgBxF,MAAhB,CAAuB2G,YAAvB,CAAoClN,KAApC,CAAJ,EAAgD;AAC9C,WAAO,kCAAc2B,OAAOoK,gBAAgBxF,MAAhB,CAAuB2G,YAAvB,CAAoClN,KAApC,CAAP,CAAd,CAAP;AACD;AACD,SAAO,kCAAcA,KAAd,CAAP;AACD;;AAED,SAASyT,SAAT,CAAmB1H,eAAnB,EAAmC;AACjC;AACA,MAAI,CAACA,gBAAgBxF,MAAhB,CAAuBuN,qBAA5B,EAAmD;AACjD;AACA,QAAI/H,gBAAgBrF,IAAhB,GAAuB,CAAvB,EAA0BvH,MAA1B,KAAqC,CAArC,IAA0C,CAAC,gCAAa4M,gBAAgBrF,IAAhB,GAAuB,CAAvB,EAA0B,CAA1B,CAAb,CAA/C,EAA2F;AACzFqF,sBAAgBxF,MAAhB,CAAuBuN,qBAAvB,GAA+C,KAA/C;AACD,KAFD,MAEO;AACL/H,sBAAgBxF,MAAhB,CAAuBuN,qBAAvB,GAA+C,QAA/C;AACD;AACF;;AAED,MAAI/H,gBAAgBxF,MAAhB,CAAuBuN,qBAAvB,KAAiD,KAAjD,IACC/H,gBAAgBxF,MAAhB,CAAuBuN,qBAAvB,KAAiD,MADtD,EAC8D;AAC5D/H,oBAAgB4F,OAAhB,CAAwB4B,YAAxB,CAAqC,CAArC,EAAwC,UAASvT,KAAT,EAAe;AACrD,aAAO0T,cAAc,EAAE3H,gCAAF,EAAmB/L,YAAnB,EAAd,CAAP;AACD,KAFuC,CAEtCoS,IAFsC,CAEjCrG,eAFiC,CAAxC;AAGD;;AAED,MAAIA,gBAAgBxF,MAAhB,CAAuBuN,qBAAvB,KAAiD,QAAjD,IACC/H,gBAAgBxF,MAAhB,CAAuBuN,qBAAvB,KAAiD,MADtD,EAC8D;AAC5D/H,oBAAgB4F,OAAhB,CAAwB6B,SAAxB,CAAkC,CAAlC,EAAqC,UAASxT,KAAT,EAAe;AAClD,aAAO0T,cAAc,EAAE3H,gCAAF,EAAmB/L,YAAnB,EAAd,CAAP;AACD,KAFoC,CAEnCoS,IAFmC,CAE9BrG,eAF8B,CAArC;AAGD;AACF;;AAEDH,QAAQ9G,SAAR,CAAkBwI,OAAlB,GAA4B,UAAS/K,GAAT,EAAa;AACrC,MAAI,CAACY,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAY,SAAZ,CAAP;AACvB,OAAKA,MAAL,CAAY,SAAZ,IAA0BhE,MAAMZ,OAAOY,GAAP,CAAN,GAAoB,IAA9C;AACA,SAAO,IAAP;AACH,CAJD;;AAMAqJ,QAAQ9G,SAAR,CAAkBiP,OAAlB,GAA4B,YAAU;AAClC,MAAI,KAAK1E,IAAL,CAAUwC,SAAd,EAAyB;AACvB,SAAKoB,OAAL;AACD;AACD,MAAI,KAAKxB,EAAL,EAAJ,EAAe;AACb,SAAKA,EAAL,GAAUyB,SAAV,GAAsB,EAAtB;AACA,QAAMa,UAAUnI,QAAQyG,SAAR,CAAkB1G,OAAlB,CAA0BoI,OAA1C;AACA,QAAIA,QAAQ/B,MAAZ,EAAoB;AAClB+B,cAAQ/B,MAAR,CAAe/J,KAAf,CAAqB,IAArB,EAA2B9E,SAA3B;AACD;AACF;AACD,SAAO,IAAP;AACH,CAZD;;AAcAyI,QAAQ9G,SAAR,CAAkB0H,KAAlB,GAA0B,UAASjK,GAAT,EAAa;AACrC,MAAI,KAAKgE,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,4EAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYiG,KAAnB;AACvB,OAAKjG,MAAL,CAAYiG,KAAZ,GAAqBjK,MAAMZ,OAAOY,GAAP,CAAN,GAAoB,IAAzC;AACA,SAAO,IAAP;AACD,CAPD;;AASAqJ,QAAQ9G,SAAR,CAAkBiN,OAAlB,GAA4B,YAAU;AAClC,MAAMhG,kBAAkB,IAAxB;;AAEA,MAAI,CAAC,KAAK0F,EAAL,EAAL,EAAgB;AACd,UAAS,KAAKlL,MAAL,CAAY4F,SAArB;AACA;AACD;;AAEDgH,WAAS,YAAU;AACjB,QAAIpH,gBAAgBsD,IAAhB,CAAqBwC,SAAzB,EAAoC;AAClC9F,sBAAgBkH,OAAhB;AACD;AACD,QAAIlH,gBAAgB0F,EAAhB,EAAJ,EAA0B;AACxB1F,sBAAgB0F,EAAhB,GAAqByB,SAArB,GAAiC,EAAjC;AACA,UAAMc,SAASpI,QAAQyG,SAAR,CAAkB1G,OAAlB,CAA0BsI,OAAzC;AACA,UAAID,OAAOhC,MAAX,EAAmB;AACjBgC,eAAOhC,MAAP,CAAc5S,IAAd,CAAmB2M,eAAnB;AACD;AACDA,sBAAgBsD,IAAhB,CAAqBuC,SAArB,GAAiC,IAAjC;AACD;AACF,GAZD;;AAcA,SAAO,IAAP;AACH,CAvBD;;AAyBAhG,QAAQ9G,SAAR,CAAkBkN,MAAlB,GAA2B,YAA6B;AAAA;;AAAA,MAApBvE,OAAoB,uEAAVxI,SAAU;;AACtD,MAAM8G,kBAAkB,IAAxB;;AAEA,MAAI,CAAC,CAAC0B,OAAN,EAAe;AACb,QAAMyG,cAAczG,QAAQ,CAAR,KAAcA,OAAlC;AACA,QACEyG,YAAYC,KAAZ,IACGD,YAAYC,KAAZ,CAAkBC,QADrB,IAEGF,YAAYC,KAAZ,CAAkBE,SAFrB,IAGG,OAAOH,YAAYC,KAAZ,CAAkBE,SAAzB,KAAuC,QAH1C,IAIGH,YAAYC,KAAZ,CAAkBE,SAAlB,CAA4BrJ,QAA5B,CAAqC,OAArC,CAJH,IAKG,KAAKzE,MAAL,CAAYqJ,wBALf,IAMG,KAAKrJ,MAAL,CAAYqJ,wBAAZ,CAAqC/B,IAArC,KAA8C5I,SAPnD,EASA;AACE,WAAKsB,MAAL,CAAYqJ,wBAAZ,CAAqC/B,IAArC,GAA4C,IAA5C;AACD;;AAED,QAAI3O,MAAMoV,OAAN,CAAc7G,OAAd,CAAJ,EAA4B;AAC1B,UAAM8G,aAAa9G,QAAQsD,GAAR,CAAY;AAAA,eAAcyD,WAAWL,KAAX,CAAiBE,SAA/B;AAAA,OAAZ,CAAnB;AACAE,iBAAW7J,OAAX,CAAmB,2BAAmB;AACpC,YAAI+J,iBAAiBF,WAAW9K,IAAX,CAAgB;AAAA,iBACnC2B,KAAKC,SAAL,CAAeqJ,aAAf,MAAkCtJ,KAAKC,SAAL,CAAesJ,eAAf,CADC;AAAA,SAAhB,CAArB;AAGA,YAAIF,cAAJ,EAAmB;AACjB,cAAMG,MAAM,8CAAZ;AACAvD,kBAAQwD,KAAR,CAAcD,GAAd;AACA,gBAAMA,GAAN;AACD;AACF,OATD;AAUA;AACA,aAAO7I,gBACJrF,IADI,CACC+G,QAAQ,CAAR,CADD,EAEJrO,IAFI,CAEC,YAAM;AACV,YAAMiC,QAAQoM,QAAQ,CAAR,CAAd;AACA,eAAKkE,OAAL,CAAamD,YAAb,CAA0B,CAA1B;AAFU;AAAA;AAAA;;AAAA;AAGV,+BAAmBrH,OAAnB,8HAA4B;AAAA,gBAAnBsH,MAAmB;;AAC1B,gBAAI/P,QAAW3D,MAAM8S,KAAN,CAAYa,gBAAvB,SAA2C3T,MAAM8S,KAAN,CAAYc,aAA3D;AACA,gBAAIC,MAAM5O,iBAAQgB,MAAR,CAAe,UAAf,EAA2ByN,MAA3B,CAAV;AACAhJ,4BAAgB4F,OAAhB,CAAwBjN,YAAxB,CAAqCM,KAArC,EAA4CkQ,IAAI1P,YAAJ,CAAiB,CAAjB,EAAoBT,KAApB,CAA0B,CAA1B,CAA5C;AACD;AAPS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQX,OAVI,EAWJiN,MAXI,EAAP;AAYD;;AAED,WAAOjG,gBAAgBrF,IAAhB,CAAqB+G,OAArB,EAA8BuE,MAA9B,EAAP;AACD;AACD,MACG,CAAC,CAAC,KAAKzL,MAAL,CAAY2G,YAAd,IAA8BiI,OAAOC,IAAP,CAAY,KAAK7O,MAAL,CAAY2G,YAAxB,EAAsC/N,MAAtC,GAA+C,CAA9E,IAEC,CAAC,CAAC,KAAKoH,MAAL,CAAY4G,kBAAd,IAAoC,KAAK5G,MAAL,CAAY4G,kBAAZ,CAA+BhO,MAA/B,GAAwC,CAH/E,EAIC;AACCsU,cAAU1H,eAAV;AACD;AACD,MAAI,CAAC,CAAC,KAAKxF,MAAL,CAAY0G,MAAd,IAAwBkI,OAAOC,IAAP,CAAY,KAAK7O,MAAL,CAAY0G,MAAxB,EAAgC9N,MAAhC,GAAyC,CAArE,EAAuE;AACrEmU,cAAUvH,eAAV;AACD;AACD,MAAI,CAAC,CAAC,KAAKxF,MAAL,CAAYgH,UAAlB,EAA8B;AAC5BA,eAAWxB,eAAX;AACD;AACD,MAAI,CAAC,CAAC,KAAKxF,MAAL,CAAYiH,aAAlB,EAAiC;AAC/BA,kBAAczB,eAAd;AACD;;AAED,MAAMiI,SAASpI,QAAQyG,SAAR,CAAkB1G,OAAlB,CAA0BsI,OAAzC;AACA,MAAM3G,UAAU,KAAK/G,MAAL,CAAY+G,OAA5B;AACA,MAAM7G,OAAO,KAAKF,MAAL,CAAYE,IAAzB;AACA,MAAM2F,mBAAmB,KAAKqF,EAAL,EAAzB;;AAEA,MAAI,CAACrF,gBAAD,IAAqBA,qBAAqBnH,SAA9C,EAAyD;AACvD,QAAM2P,MAAS,KAAKrO,MAAL,CAAY4F,SAArB,qEAAN;AACAkF,YAAQwD,KAAR,CAAcD,GAAd;AACA,UAAMA,GAAN;AACA;AACD;;AAED,MAAIS,cAActJ,eAAlB;;AAEA,MAAIA,gBAAgBxF,MAAhB,CAAuB+O,eAA3B,EAA4C;AAC1CD,kBAAc,IAAIE,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC7C,UAAMC,iBAAiB,OAAKnP,MAAL,CAAYoP,UAAnC;AACA5J,sBAAgBxF,MAAhB,CAAuBoP,UAAvB,GAAoC,YAAM;AACxC,YAAID,cAAJ,EAAoB;AAClBA;AACD;AACDF,gBAAQzJ,eAAR;AACD,OALD;AAMD,KARa,CAAd;AASD;;AAEDoH,WAAS,YAAU;AACjB,QAAMyC,gCAAgC7J,gBAAgB8J,kBAAhB,IACjC9J,gBAAgBxF,MAAhB,CAAuBqG,EADU,IAEjCb,gBAAgBxF,MAAhB,CAAuBqG,EAAvB,CAA0BC,iBAF/B;AAGA,QAAMiJ,0BAA0B/J,gBAAgBxF,MAAhB,CAAuBqG,EAAvB,IAC3Bb,gBAAgBxF,MAAhB,CAAuBqG,EAAvB,CAA0BmJ,OADC,IAE3BhK,gBAAgBxF,MAAhB,CAAuBqG,EAAvB,CAA0BmJ,OAA1B,CAAkCC,QAFP,IAG3BjK,gBAAgBxF,MAAhB,CAAuBqG,EAAvB,CAA0BmJ,OAA1B,CAAkCC,QAAlC,CAA2CvP,IAHhD;AAIA,QAAIsF,gBAAgBsD,IAAhB,CAAqBuC,SAArB,IAAkCoC,OAAOf,OAA7C,EAAsD;AACpDe,aAAOf,OAAP,CAAehL,KAAf,CAAqB8D,eAArB,EAAsC5I,SAAtC;AACD;AACDiJ,qBAAiB8G,SAAjB,GAA6B,EAA7B;;AAEA,QAAItH,QAAQyG,SAAR,CAAkB/E,OAAlB,MAA+B,WAAnC,EAA+C;AAC7C;AACA,UAAMsH,0BAAN;AACA7I,sBAAgBgI,OAAhB,CAAwBa,IAAxB;AACA,YAAMA,IAAN;AACA;AACD,KAND,MAOK;AACH,UAAI,OAAOhJ,QAAQyG,SAAR,CAAkB/E,OAAlB,EAA2B7G,IAA3B,CAAP,KAA4C,WAAhD,EAA6D;AAC3D,YAAMmO,8BAAN;AACA,YAAMqB,YAAY,KAAK1P,MAAL,CAAY6G,YAAZ,CAAyBwH,KAAzB,KAAiCA,KAAnD;AACA7I,wBAAgBgI,OAAhB,CAAwBkC,SAAxB;AACA,cAAMrB,KAAN;AACA;AACD,OAND,MAOK;AACHsB,wBAAgB9J,gBAAhB,EACEL,gBAAgBxF,MADlB;AAGA,YAAIuP,uBAAJ,EAA6B;AAC3B,2CAAqB;AACnB1M,qBAASgD,gBADU;AAEnB1F,kBAAMqF,gBAAgB4F,OAAhB,CAAwBzM,MAFX;AAGnBuB,kBAAMsF,gBAAgBxF,MAAhB,CAAuBqG,EAAvB,CAA0BmJ,OAA1B,CAAkCC,QAAlC,CAA2CvP,IAH9B;AAInBzB,mBAAO+G,gBAAgBxF,MAAhB,CAAuBqG,EAAvB,CAA0BmJ,OAA1B,CAAkCC,QAAlC,CAA2ChR;AAJ/B,WAArB;AAMD;AACD,YAAI4Q,6BAAJ,EAAmC;AACjC,iDAAwB;AACtBxM,qBAASgD,gBADa;AAEtB1F,kBAAMqF,gBAAgB8J;AAFA,WAAxB;AAID;AAjBE,YAkBK7F,eAlBL,GAkByBjE,gBAAgBxF,MAlBzC,CAkBKyJ,eAlBL;;AAmBH,YAAGA,eAAH,EAAmB;AACjB,cAAG,OAAOmG,oBAAP,KAAgC,WAAnC,EAA+C;AAC7C,gBAAMC,uBAAuB,SAAvBA,oBAAuB,CAACC,MAAD,EAASC,QAAT,EAAsB;AACjDD,qBAAO3L,OAAP,CAAe,cAAM;AACnB,oBAAG+G,GAAG8E,cAAN,EAAqB;AACnB,sBAAG,CAACxK,gBAAgBsD,IAAhB,CAAqBwC,SAAzB,EAAmC;AACjCjG,4BAAQyG,SAAR,CAAkB/E,OAAlB,EAA2B7G,IAA3B,EAAiCuL,MAAjC,CAAwC5S,IAAxC,CAA6C2M,eAA7C;AACAA,oCAAgBsD,IAAhB,CAAqBwC,SAArB,GAAiC,IAAjC;AACD;AACF;AACF,eAPD;AAQD,aATD;AAUA,gBAAMyE,WAAW,IAAIH,oBAAJ,CAAyBC,oBAAzB,CAAjB;AACAE,qBAASE,OAAT,CAAiBpK,gBAAjB;AACA;AACD;AACF;AACD,YAAGL,gBAAgBxF,MAAhB,CAAuB0L,oBAAvB,KAAgD,QAAnD,EAA4D;AAC1D,cAAG,OAAO/R,QAAP,KAAoB,WAAvB,EAAoC;AAClC,gBAAIuW,eAAJ;AAAA,gBAAYC,yBAAZ;AACA,gBAAI,OAAOxW,SAASuW,MAAhB,KAA2B,WAA/B,EAA4C;AAC1CA,uBAAS,QAAT;AACAC,iCAAmB,kBAAnB;AACD,aAHD,MAGO,IAAI,OAAOxW,SAASyW,QAAhB,KAA6B,WAAjC,EAA8C;AACnDF,uBAAS,UAAT;AACAC,iCAAmB,oBAAnB;AACD,aAHM,MAGA,IAAI,OAAOxW,SAAS0W,YAAhB,KAAiC,WAArC,EAAkD;AACvDH,uBAAS,cAAT;AACAC,iCAAmB,wBAAnB;AACD;AACD,gBAAMG,yBAAyB,SAAzBA,sBAAyB,GAAM;AACnC,kBAAG,CAAC3W,SAASuW,MAAT,CAAD,IAAqB1K,gBAAgBsD,IAAhB,CAAqBC,UAArB,CAAgCxD,EAAxD,EAA4D;AAC1DC,gCAAgBsD,IAAhB,CAAqBC,UAArB,CAAgCxD,EAAhC,CAAmCgL,IAAnC,CAAwC/K,gBAAgB4F,OAAhB,CAAwBzM,MAAhE;AACD;AACF,aAJD;AAKA,gBAAG,OAAOhF,SAASe,gBAAhB,KAAqC,WAArC,IACAwV,WAAWxR,SADd,EACwB;AACtB/E,uBAASe,gBAAT,CAA0ByV,gBAA1B,EAA4CG,sBAA5C,EAAoE;AAClEE,sBAAM;AAD4D,eAApE;AAGD;AACF;AACF;AACDnL,gBAAQyG,SAAR,CAAkB/E,OAAlB,EAA2B7G,IAA3B,EAAiCuL,MAAjC,CAAwC5S,IAAxC,CAA6C2M,eAA7C;AACAA,wBAAgBsD,IAAhB,CAAqBwC,SAArB,GAAiC,IAAjC;AACD;AACF;AACF,GA9FD;;AAgGA,SAAOwD,WAAP;AACD,CA3LD;;AA6LAzJ,QAAQ9G,SAAR,CAAkByI,UAAlB,GAA+B,UAAShL,GAAT,EAAa;AAC1C,MAAI,KAAKgE,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,sFAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYgH,UAAnB;AACvB,OAAKhH,MAAL,CAAYgH,UAAZ,GAA0BhL,MAAMZ,OAAOY,GAAP,CAAN,GAAoB,IAA9C;;AAEAgL,aAAW,IAAX,EAAiBhL,GAAjB;;AAEA,SAAO,IAAP;AACD,CAVD;;AAYA,SAASgL,UAAT,CAAoBxB,eAApB,EAAoC;AAClC;AACA,MAAIA,gBAAgBxF,MAAhB,CAAuBgH,UAAvB,IAAqCxB,gBAAgBrF,IAAhB,GAAuBvH,MAAvB,GAAgC,CAAzE,EAA4E;AAC1E,QAAI,gCAAa4M,gBAAgBrF,IAAhB,GAAuB,CAAvB,EAA0B,CAA1B,CAAb,CAAJ,EAAgD;AAC9CqF,sBAAgB4F,OAAhB,CAAwBqF,WAAxB,CAAoCjL,gBAAgBxF,MAAhB,CAAuBgH,UAA3D,EAAuExB,gBAAgB4F,OAAhB,CAAwBrJ,YAA/F;AACD,KAFD,MAGK;AACHyD,sBAAgB4F,OAAhB,CAAwBsF,QAAxB,CAAiClL,gBAAgBxF,MAAhB,CAAuBgH,UAAxD,EAAoExB,gBAAgB4F,OAAhB,CAAwBpJ,SAA5F;AACD;AACF;AACF;;AAEDqD,QAAQ9G,SAAR,CAAkB0I,aAAlB,GAAkC,UAASjL,GAAT,EAAa;AAC7C,MAAI,KAAKgE,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,4FAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYiH,aAAnB;AACvB,OAAKjH,MAAL,CAAYiH,aAAZ,GAA6BjL,MAAMZ,OAAOY,GAAP,CAAN,GAAoB,IAAjD;;AAEAiL,gBAAc,IAAd;;AAEA,SAAO,IAAP;AACD,CAVD;;AAYA,SAASA,aAAT,CAAuBzB,eAAvB,EAAuC;AACrC,MAAIA,gBAAgBxF,MAAhB,CAAuBiH,aAA3B,EAA0C;AACxCzB,oBAAgB4F,OAAhB,CAAwBsF,QAAxB,CAAiClL,gBAAgBxF,MAAhB,CAAuBiH,aAAxD;AACD;AACF;;AAED5B,QAAQ9G,SAAR,CAAkB4I,OAAlB,GAA4B,UAASwJ,IAAT,EAAc;AACxC,MAAI,KAAK3Q,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,gFAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYmH,OAAnB;AACvB,OAAKnH,MAAL,CAAYmH,OAAZ,GAAsBwJ,OAAO,IAAP,GAAc,KAApC;AACA,SAAO,IAAP;AACD,CAPD;;AASAtL,QAAQ9G,SAAR,CAAkB2H,KAAlB,GAA0B,UAASlK,GAAT,EAAa;AACrC,MAAI,KAAKgE,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,4EAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYkG,KAAnB;AACvB,OAAKlG,MAAL,CAAYkG,KAAZ,GAAqBlK,MAAMZ,OAAOY,GAAP,CAAN,GAAoB,IAAzC;AACA,SAAO,IAAP;AACD,CAPD;;AASAqJ,QAAQ9G,SAAR,CAAkBuH,KAAlB,GAA0B,UAAS9J,GAAT,EAAa;AACrC,MAAI,KAAKgE,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,4EAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAY8F,KAAnB;AACvB,OAAK9F,MAAL,CAAY8F,KAAZ,GAAqB9J,MAAMZ,OAAOY,GAAP,CAAN,GAAoB,IAAzC;AACA,SAAO,IAAP;AACD,CAPD;;AASAqJ,QAAQ9G,SAAR,CAAkB2B,IAAlB,GAAyB,UAASlE,GAAT,EAAa;AACpC,MAAI,KAAKgE,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,0EAAZ;AACD;AACD,MAAI,CAACnO,UAAUhE,MAAf,EAAuB,OAAO,KAAKoH,MAAL,CAAYE,IAAnB;AACvB,OAAKF,MAAL,CAAYE,IAAZ,GAAoBlE,MAAMgP,kBAAkBhP,GAAlB,CAAN,GAA+B,IAAnD;AACA,SAAO,IAAP;AACD,CAPD;;AASAqJ,QAAQ9G,SAAR,CAAkBuB,MAAlB,GAA2B,YAAU;AACnC,MAAMiH,UAAU,KAAK/G,MAAL,CAAY+G,OAA5B;AACA,MAAM7G,OAAO,KAAKF,MAAL,CAAYE,IAAzB;AACA,MAAM2C,UAAU,KAAKqI,EAAL,EAAhB;AACA,MAAInE,WAAW7G,IAAX,IAAmB2C,OAAnB,IAA8BwC,QAAQyG,SAAR,CAAkB/E,OAAlB,EAA2B7G,IAA3B,EAAiCJ,MAAnE,EAA2E;AACzEuF,YAAQyG,SAAR,CAAkB/E,OAAlB,EAA2B7G,IAA3B,EAAiCJ,MAAjC,CAAwC4B,KAAxC,CAA8C,IAA9C,EAAoD9E,SAApD;AACD;AACD,SAAO,IAAP;AACD,CARD;;AAUAyI,QAAQ9G,SAAR,CAAkBtB,KAAlB,GAA0B,UAAS6P,GAAT,EAAa;AACrC,MAAI,KAAK9M,MAAL,CAAY0F,uBAAhB,EAAyC;AACvCoF,YAAQC,GAAR,CAAY,0CAAZ;AACD;AACD,SAAO,IAAP;AACD,CALD;;AAOA1F,QAAQ9G,SAAR,CAAkBiF,WAAlB,GAAgC,YAAiD;AAAA,kFAAJ,EAAI;AAAA,4BAAtCE,OAAsC;AAAA,MAAtCA,OAAsC,iCAA5B,CAA4B;AAAA,4BAAzBC,OAAyB;AAAA,MAAzBA,OAAyB,iCAAf,MAAe;;AAC/E,2BAAY;AACV1F,UAAM,KAAK+B,MAAL,CAAY6F,gBADR;AAEVnC,oBAFU;AAGVC;AAHU,GAAZ;AAKD,CAND;;AAQA0B,QAAQ9G,SAAR,CAAkByF,UAAlB,GAA+B,YAAsB;AAAA,MAAb9D,IAAa,uEAAR,MAAQ;;AACnD,4BAAW;AACTC,UAAM,KAAKiL,OAAL,CAAazM,MADV;AAETuB;AAFS,GAAX;AAID,CALD;;AAOA;AACAmF,QAAQ9G,SAAR,CAAkBqS,SAAlB,GAA8BvL,QAAQ9G,SAAR,CAAkB2B,IAAhD;AACAmF,QAAQ9G,SAAR,CAAkB+P,KAAlB,GAA0BjJ,QAAQ9G,SAAR,CAAkBiP,OAA5C;AACAnI,QAAQ9G,SAAR,CAAkBsS,YAAlB,GAAiCxL,QAAQ9G,SAAR,CAAkB4B,IAAnD;AACAkF,QAAQ9G,SAAR,CAAkBuS,YAAlB,GAAiC,YAAU;AACzC;AACA,SAAO,IAAP;AACD,CAHD;AAIAzL,QAAQ9G,SAAR,CAAkBwS,UAAlB,GAA+B,YAAU;AACvC;AACA,SAAO,IAAP;AACD,CAHD;;AAKA1L,QAAQ2L,OAAR,GAAkBC,kBAAID,OAAtB;;AAEA;;AAEA,SAASrB,eAAT,CAAyBzE,EAAzB,EAA6B5F,OAA7B,EAAsC;AACpC,MAAIlJ,OAAO,EAAX;AACA,MAAI8U,sBAAsB,EAA1B;AACA,MAAIC,aAAa,EAAjB;AACA,MAAI7L,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,KAA5B,IAAqCgL,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,QAArE,EAA+E;AAC7E4W,0BAAsB,sBAAtB;AACD;AACD,MAAI5L,QAAQ+E,KAAZ,EAAmB;AACjB8G,iBAAa,oBAAb;AACD;AACD,MAAIvL,sCAAoCsL,mBAApC,SAA2DC,UAA3D,aAAJ;AACA,MAAMC,oBAAoB,CAAC,KAAD,EAAQ,QAAR,EAAkB,QAAlB,CAA1B;AACA,MAAMC,sBAAsB,CAAC,MAAD,EAAS,QAAT,EAAmB,OAAnB,CAA5B;AACA,MAAIC,QAAQ,YAAZ;AACA,MAAIC,mBAAmB,QAAvB;AACA,MAAIF,oBAAoB5M,QAApB,CAA6Ba,QAAQ+B,MAAR,CAAeE,SAA5C,CAAJ,EAA4D;AAC1DgK,uBAAmBjM,QAAQ+B,MAAR,CAAeE,SAAlC;AACD;AACD,MAAIjC,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,MAA5B,IAAsCgL,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,OAAtE,EAA+E;AAC7EgX,YAAQ,UAAR;AACA,QAAIF,kBAAkB3M,QAAlB,CAA2Ba,QAAQ+B,MAAR,CAAeE,SAA1C,CAAJ,EAA0D;AACxDgK,yBAAmBjM,QAAQ+B,MAAR,CAAeE,SAAlC;AACD;AACF;AACD,MAAIjC,QAAQ+B,MAAR,IAAkB/B,QAAQ+B,MAAR,CAAeC,IAArC,EAA2C;AACzC,QAAIhC,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,KAA5B,IAAqCgL,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,MAArE,EAA6E;AAC3EsL,iEAAyD0L,KAAzD,wBAAiFhM,QAAQ+B,MAAR,CAAe/M,QAAhG,8BAAiIiX,gBAAjI,gBAA4J3L,SAA5J;AACD,KAFD,MAEO;AACLA,kBAAeA,SAAf,kDAAqE0L,KAArE,wBAA6FhM,QAAQ+B,MAAR,CAAe/M,QAA5G,8BAA6IiX,gBAA7I;AACD;AACF;AACD,MAAG,CAACjM,QAAQ8E,KAAZ,EAAkB;AAChBhO,6BAAuBkJ,QAAQY,KAA/B;AACD;AACD,MAAIZ,QAAQQ,KAAR,IAAiBR,QAAQS,SAA7B,EAAwC;AACtC3J,gDAA0CkJ,QAAQY,KAAlD,gBAAkEZ,QAAQQ,KAA1E;AACD;AACD,MAAIR,QAAQU,QAAZ,EAAsB;AACpB5J,mDAA6CkJ,QAAQY,KAArD,mBAAwEZ,QAAQU,QAAhF;AACD;AACD5J,yEAAqEkV,KAArE,SAA8EhM,QAAQY,KAAtF,mBAAyGZ,QAAQY,KAAjH,mBAAoIoL,KAApI,UAA8I1L,SAA9I;AACA,MAAIN,QAAQW,KAAZ,EAAmB;AACjB7J,gDAA0CkJ,QAAQY,KAAlD,gBAAkEZ,QAAQW,KAA1E;AACD;AACD,MAAG,CAACX,QAAQ8E,KAAZ,EAAkB;AAChBhO,YAAQ,QAAR;AACD;;AAED8O,KAAGyB,SAAH,GAAevQ,IAAf;AACD;;AAED,SAAS4O,iBAAT,CAA2BhP,GAA3B,EAAgC;AAC9B,MAAMwO,MAAM;AACVgH,eAAW,MADD;AAEVC,cAAU,gBAFA;AAGVC,iBAAa,KAHH;AAIVC,eAAW,MAJD;AAKVC,cAAU;AALA,GAAZ;AAOA,SAAOpH,IAAIxO,GAAJ,KAAYA,GAAnB;AACD;;AAED,SAAS6V,OAAT,CAAiBrF,EAAjB,EAAqB;AACnB,MAAI,KAAK/M,IAAL,CAAU9F,SAASmY,UAAnB,CAAJ,EAAoC;AAClClX,eAAW,YAAM;AACfiX,cAAQrF,EAAR;AACD,KAFD,EAEG,CAFH;AAGD,GAJD,MAIO;AACLA;AACD;AACF;;AAED,SAASI,QAAT,CAAkBJ,EAAlB,EAAsB;AACpB,MAAI,OAAO7S,QAAP,KAAoB,WAApB,IAAmC,OAAOoS,MAAP,KAAkB,WAAzD,EAAsE;AACpES;AACA;AACD;AACD;AACA,MAAI7S,SAASmY,UAAT,IAAuB,IAAvB,IAA+BnY,SAASe,gBAA5C,EAA8D;AAC5Df,aAASe,gBAAT,CAA0B,kBAA1B,EAA8C,SAASqX,gBAAT,GAA4B;AACxEpY,eAASqY,mBAAT,CAA6B,kBAA7B,EAAiDD,gBAAjD,EAAmE,KAAnE;AACApY,eAASmY,UAAT,GAAsB,UAAtB;AACD,KAHD,EAGG,KAHH;AAIAnY,aAASmY,UAAT,GAAsB,SAAtB;AACD;AACDD,UAAQrF,EAAR;AACD;;kBAIcnH,O;;;;;;;;;;;;QCp/BCkJ,Y,GAAAA,Y;QAYA0D,S,GAAAA,S;;AAdhB;;AAEO,SAAS1D,YAAT,CAAsB2D,CAAtB,EAAyB;AAC9B,MAAM7T,OAAO,IAAb;AACA,MAAMhC,QAAS,OAAO6V,CAAP,KAAa,QAAd,GAA0BA,CAA1B,GAA8B,KAAKvT,MAAL,CAAY,CAAZ,EAAe8B,OAAf,CAAuByR,CAAvB,CAA5C;;AAEA,MAAI7V,QAAQ,CAAC,CAAb,EAAgB;AACd,oBAAKgC,KAAKM,MAAV,EAAkB,UAASC,GAAT,EAAcjC,CAAd,EAAgB;AAChC0B,WAAKM,MAAL,CAAYhC,CAAZ,EAAewV,MAAf,CAAsB9V,KAAtB,EAA6B,CAA7B;AACD,KAFD;AAGD;AACD,SAAOgC,IAAP;AACD;;AAEM,SAAS4T,SAAT,CAAmBC,CAAnB,EAAsB;AAC3B,MAAI7V,QAAS,OAAO6V,CAAP,KAAa,QAAd,GAA0BA,CAA1B,GAA8B,KAAKjT,YAAL,CAAkB,CAAlB,EAAqBwB,OAArB,CAA6ByR,CAA7B,CAA1C;;AAEA,MAAI7V,QAAQ,CAAC,CAAb,EAAgB;AACd,SAAKsC,MAAL,CAAYwT,MAAZ,CAAmB9V,KAAnB,EAA0B,CAA1B;AACD;AACD,SAAO,IAAP;AACD,C;;;;;;;;;;;;QCnBe+V,a,GAAAA,a;QAqBAC,U,GAAAA,U;;AAvBhB;;AAEO,SAASD,aAAT,CAAuB5F,EAAvB,EAA2B;AAChC,MAAMnO,OAAO,IAAb;AACA,MAAMiU,QAAQ,EAAd;;AAEA,kBAAKjU,KAAKM,MAAV,EAAkB,UAASC,GAAT,EAAcjC,CAAd,EAAiB;AACjC2V,UAAMvU,IAAN,CAAW,EAAX;AACD,GAFD;;AAIA,kBAAKM,KAAKM,MAAL,CAAY,CAAZ,CAAL,EAAqB,UAASK,GAAT,EAAcrC,CAAd,EAAgB;AACnC,QAAI4V,iBAAiBlU,KAAKY,YAAL,CAAkBtC,CAAlB,CAArB;AACA,QAAIA,KAAK,CAAL,IAAU6P,GAAG3T,IAAH,CAAQwF,IAAR,EAAckU,cAAd,EAA8B5V,CAA9B,CAAd,EAAgD;AAC9C,sBAAK4V,cAAL,EAAqB,UAAS1T,IAAT,EAAe2T,EAAf,EAAkB;AACrCF,cAAME,EAAN,EAAUzU,IAAV,CAAec,IAAf;AACD,OAFD;AAGD;AACF,GAPD;;AASAR,OAAK8B,IAAL,CAAUmS,KAAV;AACA,SAAOjU,IAAP;AACD;;AAEM,SAASgU,UAAT,CAAoB7F,EAApB,EAAwB;AAC7B,MAAMnO,OAAO,IAAb;AACA,MAAMiU,QAAQ,EAAd;;AAEA,kBAAKjU,KAAKM,MAAV,EAAkB,UAASC,GAAT,EAAcjC,CAAd,EAAgB;AAChC,QAAIA,KAAK,CAAL,IAAU6P,GAAG3T,IAAH,CAAQwF,IAAR,EAAcO,GAAd,EAAmBjC,CAAnB,CAAd,EAAqC;AACnC2V,YAAMvU,IAAN,CAAWa,GAAX;AACD;AACF,GAJD;;AAMAP,OAAK8B,IAAL,CAAUmS,KAAV;AACA,SAAOjU,IAAP;AACD,C;;;;;;;;;;;;QC/BeoU,Y,GAAAA,Y;QA6CAC,S,GAAAA,S;;AAjDhB;;AACA;;;;AACA;;;;AAEO,SAASD,YAAT,CAAsBpW,KAAtB,EAA6BL,GAA7B,EAAkClB,KAAlC,EAAyC;AAC9C,MAAMuD,OAAO,IAAb;AACA,MAAMI,QAASzC,QAAQ0C,SAAT,GAAsB1C,GAAtB,GAA4B,IAA1C;;AAEA,MAAI,OAAOlB,KAAP,KAAiB,UAArB,EAAiC;;AAE/BuD,SAAKM,MAAL,CAAY,CAAZ,EAAewT,MAAf,CAAsB9V,KAAtB,EAA6B,CAA7B,EAAgCoC,KAAhC;AACA,oBAAKJ,KAAKM,MAAV,EAAkB,UAASC,GAAT,EAAcjC,CAAd,EAAiB;AACjC,UAAIkC,IAAJ;AACA,UAAIlC,IAAI,CAAR,EAAW;AACTkC,eAAO/D,MAAMjC,IAAN,CAAWwF,IAAX,EAAiBO,GAAjB,EAAsBjC,CAAtB,CAAP;AACA,YAAI,OAAOkC,IAAP,KAAgB,WAApB,EAAiC;AAC/BA,iBAAO,IAAP;AACD;AACDR,aAAKM,MAAL,CAAYhC,CAAZ,EAAewV,MAAf,CAAsB9V,KAAtB,EAA6B,CAA7B,EAAgCwC,IAAhC;AACD;AACF,KATD;AAWD,GAdD,MAgBK,IAAI,CAAC/D,KAAD,IAAUA,iBAAiBnC,KAA/B,EAAsC;AACzCmC,YAAQA,SAAS,EAAjB;;AAEA,QAAIA,MAAMlC,MAAN,IAAgByF,KAAKM,MAAL,CAAY/F,MAAZ,GAAqB,CAAzC,EAA4C;AAC1CkC,cAAQA,MAAMgE,MAAN,CAAc,8BAAeT,KAAKM,MAAL,CAAY/F,MAAZ,GAAqB,CAArB,GAAyBkC,MAAMlC,MAA9C,CAAd,CAAR;AACD,KAFD,MAGK;AACH;AACA;AACA,sBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B,YAAI0B,KAAKM,MAAL,CAAY/F,MAAZ,GAAoB,CAApB,GAAwBkC,MAAMlC,MAAlC,EAA0C;AACxCwF,4BAAUvF,IAAV,CAAewF,IAAf,EAAqBjD,OAAQiD,KAAKM,MAAL,CAAY/F,MAApB,CAArB;AACD;AACF,OAJD;AAKD;;AAEDyF,SAAKM,MAAL,CAAY,CAAZ,EAAewT,MAAf,CAAsB9V,KAAtB,EAA6B,CAA7B,EAAgCoC,KAAhC;AACA,oBAAK3D,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B0B,WAAKM,MAAL,CAAYhC,IAAE,CAAd,EAAiBwV,MAAjB,CAAwB9V,KAAxB,EAA+B,CAA/B,EAAkC5C,KAAlC;AACD,KAFD;AAID;AACD,SAAO4E,IAAP;AACD;;AAEM,SAASqU,SAAT,CAAmBrW,KAAnB,EAA0BL,GAA1B,EAA+BlB,KAA/B,EAAsC;AAC3C,MAAMuD,OAAO,IAAb;AACA,MAAMU,SAAS,EAAf;AACA,MAAMN,QAASzC,QAAQ0C,SAAT,GAAsB1C,GAAtB,GAA4B,IAA1C;AACA+C,SAAOhB,IAAP,CAAYU,KAAZ;;AAEA,MAAI,OAAO3D,KAAP,KAAiB,UAArB,EAAiC;AAC/B,oBAAKuD,KAAKM,MAAL,CAAY,CAAZ,CAAL,EAAqB,UAASF,KAAT,EAAgB9B,CAAhB,EAAmB;AACtC,UAAIqC,YAAJ;AACA,UAAIH,aAAJ;AACA,UAAIlC,IAAI,CAAR,EAAW;AACTqC,cAAMX,KAAKY,YAAL,CAAkBtC,CAAlB,CAAN;AACAkC,eAAO/D,MAAMjC,IAAN,CAAWwF,IAAX,EAAiBW,GAAjB,EAAsBrC,CAAtB,CAAP;AACA,YAAI,OAAOkC,IAAP,KAAgB,WAApB,EAAiC;AAC/BA,iBAAO,IAAP;AACD;AACDE,eAAOhB,IAAP,CAAYc,IAAZ;AACD;AACF,KAXD;AAYAR,SAAKM,MAAL,CAAYwT,MAAZ,CAAmB9V,KAAnB,EAA0B,CAA1B,EAA6B0C,MAA7B;AACD,GAdD,MAgBK,IAAI,CAACjE,KAAD,IAAUA,iBAAiBnC,KAA/B,EAAsC;AACzCmC,YAAQA,SAAS,EAAjB;;AAEA,QAAIA,MAAMlC,MAAN,IAAgByF,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAwB,CAA5C,EAA+C;AAC7CkC,cAAQA,MAAMgE,MAAN,CAAc,8BAAgBT,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAwB,CAAxB,GAA4BkC,MAAMlC,MAAlD,CAAd,CAAR;AACD,KAFD,MAGK;AACH,sBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B,YAAI0B,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAuB,CAAvB,GAA2BkC,MAAMlC,MAArC,EAA6C;AAC3CuF,+BAAatF,IAAb,CAAkBwF,IAAlB,EAAwBjD,OAAQiD,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAvB,CAAxB;AACD;AACF,OAJD;AAKD;;AAEDyF,SAAKM,MAAL,CAAYwT,MAAZ,CAAmB9V,KAAnB,EAA0B,CAA1B,EAA6B0C,OAAOD,MAAP,CAAchE,KAAd,CAA7B;AACD;;AAED,SAAOuD,IAAP;AACD,C;;;;;;;;;;;;QCvFeY,Y,GAAAA,Y;QAYA4B,S,GAAAA,S;;AAdhB;;AAEO,SAAS5B,YAAT,CAAsBiT,CAAtB,EAAyB;AAC9B,MAAM1D,SAAS,EAAf;AACA,MAAMnS,QAAS,OAAO6V,CAAP,KAAa,QAAd,GAA0BA,CAA1B,GAA8B,KAAKvT,MAAL,CAAY,CAAZ,EAAe8B,OAAf,CAAuByR,CAAvB,CAA5C;;AAEA,MAAI7V,QAAQ,CAAC,CAAT,IAAc,OAAO,KAAKsC,MAAL,CAAY,CAAZ,EAAetC,KAAf,CAAP,KAAiC,WAAnD,EAAgE;AAC9D,oBAAK,KAAKsC,MAAV,EAAkB,UAASC,GAAT,EAAcjC,CAAd,EAAiB;AACjC6R,aAAOzQ,IAAP,CAAYa,IAAIvC,KAAJ,CAAZ;AACD,KAFD;AAGD;AACD,SAAOmS,MAAP;AACD;;AAEM,SAAS3N,SAAT,CAAmBqR,CAAnB,EAAsB;AAC3B,MAAI1D,SAAS,EAAb;AACA,MAAMnS,QAAS,OAAO6V,CAAP,KAAa,QAAd,GAA0BA,CAA1B,GAA8B,KAAKjT,YAAL,CAAkB,CAAlB,EAAqBwB,OAArB,CAA6ByR,CAA7B,CAA5C;;AAEA,MAAI7V,QAAQ,CAAC,CAAT,IAAc,OAAO,KAAKsC,MAAL,CAAYtC,KAAZ,CAAP,KAA8B,WAAhD,EAA6D;AAC3DmS,aAAS,KAAK7P,MAAL,CAAYtC,KAAZ,CAAT;AACD;AACD,SAAOmS,MAAP;AACD,C;;;;;;;;;;;;QCnBeiC,W,GAAAA,W;QA8BAC,Q,GAAAA,Q;;AAjChB;;AACA;;;;;;AAEO,SAASD,WAAT,CAAqBzU,GAArB,EAA0B2W,IAA1B,EAAgC;AACrC,MAAItU,OAAO,IAAX;AAAA,MACIuU,OAAO,KAAKjU,MAAL,CAAY,CAAZ,EAAeH,KAAf,CAAqB,CAArB,CADX;AAAA,MACoC;AAChCqU,SAAO,EAFX;AAAA,MAGIP,QAAQ,EAHZ;AAAA,MAII9F,KAAKmG,QAAQG,mBAAoBzQ,cAJrC;;AAMA;AACA,kBAAKuQ,IAAL,EAAW,UAAS/T,IAAT,EAAelC,CAAf,EAAkB;AAC3BkW,SAAK9U,IAAL,CAAUM,KAAKY,YAAL,CAAkBtC,IAAE,CAApB,EAAuB6B,KAAvB,CAA6B,CAA7B,CAAV;AACD,GAFD;AAGAqU,OAAKhT,IAAL,CAAU,UAASkT,CAAT,EAAWC,CAAX,EAAa;AACrB;AACA,QAAIC,KAAKzG,GAAG3T,IAAH,CAAQwF,IAAR,EAAc0U,CAAd,IAAmBvG,GAAG3T,IAAH,CAAQwF,IAAR,EAAc2U,CAAd,CAA5B;AACA,QAAIC,EAAJ,EAAQ;AACN,aAAQjX,QAAQ,KAAR,GAAgB,CAAhB,GAAoB,CAAC,CAA7B;AACD,KAFD,MAEO,IAAI,CAACiX,EAAL,EAAS;AACd,aAAQjX,QAAQ,KAAR,GAAgB,CAAC,CAAjB,GAAqB,CAA7B;AACD,KAFM,MAEA;AACL,aAAO,CAAP;AACD;AACF,GAVD;AAWA,kBAAK6W,IAAL,EAAW,UAAS7T,GAAT,EAAcrC,CAAd,EAAiB;AAC1B0B,SACGkQ,YADH,CACgB5R,IAAE,CADlB,EAEG8V,YAFH,CAEgB9V,IAAE,CAFlB,EAEqBqC,IAAI,CAAJ,CAFrB,EAE6BA,IAAIR,KAAJ,CAAU,CAAV,CAF7B;AAGD,GAJD;AAKA,SAAOH,IAAP;AACD;;AAEM,SAASqS,QAAT,CAAkB1U,GAAlB,EAAuB2W,IAAvB,EAA6B;AAClC,MAAItU,OAAO,IAAX;AAAA,MACIuU,OAAO,KAAKjU,MAAL,CAAYH,KAAZ,CAAkB,CAAlB,EAAoB,CAApB,CADX;AAAA,MAEI3E,OAAO,KAAK8E,MAAL,CAAYH,KAAZ,CAAkB,CAAlB,CAFX;AAAA,MAGIgO,KAAKmG,QAAQG,mBAAoBxQ,WAHrC;AAIAzI,OAAKgG,IAAL,CAAU,UAASkT,CAAT,EAAYC,CAAZ,EAAc;AACtB;AACA,QAAIC,KAAKzG,GAAG3T,IAAH,CAAQwF,IAAR,EAAc0U,CAAd,IAAmBvG,GAAG3T,IAAH,CAAQwF,IAAR,EAAc2U,CAAd,CAA5B;AACA,QAAIC,EAAJ,EAAQ;AACN,aAAQjX,QAAQ,KAAR,GAAgB,CAAhB,GAAoB,CAAC,CAA7B;AACD,KAFD,MAEO,IAAI,CAACiX,EAAL,EAAS;AACd,aAAQjX,QAAQ,KAAR,GAAgB,CAAC,CAAjB,GAAqB,CAA7B;AACD,KAFM,MAEA;AACL,aAAO,CAAP;AACD;AACF,GAVD;AAWAqC,OAAK8B,IAAL,CAAUyS,KAAK9T,MAAL,CAAYjF,IAAZ,CAAV;AACA,SAAOwE,IAAP;AACD,C;;;;;;;;;;;;QC/Ce2O,Y,GAAAA,Y;QA4CAC,S,GAAAA,S;;AAhDhB;;AACA;;;;AACA;;;;AAEO,SAASD,YAAT,CAAsBkF,CAAtB,EAAyBpX,KAAzB,EAAgC;AACrC,MAAIuD,OAAO,IAAX;AAAA,MACIhC,QAAS,OAAO6V,CAAP,KAAa,QAAd,GAA0BA,CAA1B,GAA8B,KAAKvT,MAAL,CAAY,CAAZ,EAAe8B,OAAf,CAAuByR,CAAvB,CAD1C;;AAGA,MAAI7V,QAAQ,CAAC,CAAb,EAAgB;;AAEd,QAAI,OAAOvB,KAAP,KAAiB,UAArB,EAAiC;;AAE/B,sBAAKuD,KAAK8B,IAAL,EAAL,EAAkB,UAASvB,GAAT,EAAcjC,CAAd,EAAgB;AAChC,YAAIkC,IAAJ;AACA,YAAIlC,IAAI,CAAR,EAAW;AACTkC,iBAAO/D,MAAMjC,IAAN,CAAWwF,IAAX,EAAiBO,IAAIvC,KAAJ,CAAjB,EAA6BM,CAA7B,EAAgCiC,GAAhC,CAAP;AACA,cAAI,OAAOC,IAAP,KAAgB,WAApB,EAAiC;AAC/BR,iBAAKM,MAAL,CAAYhC,CAAZ,EAAeN,KAAf,IAAwBwC,IAAxB;AACD;AACF;AACF,OARD;AAUD,KAZD,MAYO,IAAI,CAAC/D,KAAD,IAAUA,iBAAiBnC,KAA/B,EAAsC;AAC3CmC,cAAQA,SAAS,EAAjB;;AAEA,UAAIA,MAAMlC,MAAN,IAAgByF,KAAK8B,IAAL,GAAYvH,MAAZ,GAAqB,CAAzC,EAA4C;AAC1CkC,gBAAQA,MAAMgE,MAAN,CAAc,8BAAeT,KAAK8B,IAAL,GAAYvH,MAAZ,GAAqB,CAArB,GAAyBkC,MAAMlC,MAA9C,CAAd,CAAR;AACD,OAFD,MAGK;AACH;AACA;AACA,wBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B,cAAI0B,KAAKM,MAAL,CAAY/F,MAAZ,GAAoB,CAApB,GAAwBkC,MAAMlC,MAAlC,EAA0C;AACxCwF,8BAAUvF,IAAV,CAAewF,IAAf,EAAqBjD,OAAQiD,KAAKM,MAAL,CAAY/F,MAApB,CAArB;AACD;AACF,SAJD;AAKD;;AAED,sBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B0B,aAAKM,MAAL,CAAYhC,IAAE,CAAd,EAAiBN,KAAjB,IAA0B5C,KAA1B;AACD,OAFD;AAID;AAEF;AACD,SAAO4E,IAAP;AACD;;AAEM,SAAS4O,SAAT,CAAmBiF,CAAnB,EAAsBpX,KAAtB,EAA4B;AACjC,MAAIuD,OAAO,IAAX;AAAA,MACIhC,QAAS,OAAO6V,CAAP,KAAa,QAAd,GAA0BA,CAA1B,GAA8B,KAAKjT,YAAL,CAAkB,CAAlB,EAAqBwB,OAArB,CAA6ByR,CAA7B,CAD1C;;AAGA,MAAI7V,QAAQ,CAAC,CAAb,EAAgB;;AAEd,QAAI,OAAOvB,KAAP,KAAiB,UAArB,EAAiC;;AAE/B,sBAAKuD,KAAK8B,IAAL,GAAY9D,KAAZ,CAAL,EAAyB,UAAS5C,KAAT,EAAgBkD,CAAhB,EAAkB;AACzC,YAAIqC,MAAMX,KAAKY,YAAL,CAAkBtC,CAAlB,CAAV;AAAA,YACAkC,OAAO/D,MAAMjC,IAAN,CAAWwF,IAAX,EAAiB5E,KAAjB,EAAwBkD,CAAxB,EAA2BqC,GAA3B,CADP;AAEA,YAAI,OAAOH,IAAP,KAAgB,WAApB,EAAiC;AAC/BR,eAAKM,MAAL,CAAYtC,KAAZ,EAAmBM,CAAnB,IAAwBkC,IAAxB;AACD;AACF,OAND;AAQD,KAVD,MAUO,IAAI,CAAC/D,KAAD,IAAUA,iBAAiBnC,KAA/B,EAAsC;AAC3CmC,cAAQA,SAAS,EAAjB;;AAEA,UAAIA,MAAMlC,MAAN,IAAgByF,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAwB,CAA5C,EAA+C;AAC7CkC,gBAAQA,MAAMgE,MAAN,CAAc,8BAAgBT,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAwB,CAAxB,GAA4BkC,MAAMlC,MAAlD,CAAd,CAAR;AACD,OAFD,MAGK;AACH,wBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B,cAAI0B,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAf,GAAuB,CAAvB,GAA2BkC,MAAMlC,MAArC,EAA6C;AAC3CuF,iCAAatF,IAAb,CAAkBwF,IAAlB,EAAwBjD,OAAQiD,KAAKM,MAAL,CAAY,CAAZ,EAAe/F,MAAvB,CAAxB;AACD;AACF,SAJD;AAKD;;AAED,sBAAKkC,KAAL,EAAY,UAASrB,KAAT,EAAgBkD,CAAhB,EAAkB;AAC5B0B,aAAKM,MAAL,CAAYtC,KAAZ,EAAmBM,IAAE,CAArB,IAA0BlD,KAA1B;AACD,OAFD;AAGD;AAEF;AACD,SAAO4E,IAAP;AACD,C;;;;;;;;;;;;kBC/EuB0S,U;;AAJxB;;AACA;;AACA;;AAJA,IAAIhR,gBAAJ,C,CAAa;;AAME,SAASgR,UAAT,CAAoBmC,GAApB,EAAwB;AACrCnT,YAAUmT,GAAV;AACA,SAAO,UAASjH,IAAT,EAAc;AACnB,QAAI3G,UAAU3M,MAAM4F,SAAN,CAAgBC,KAAhB,CAAsB3F,IAAtB,CAA2B+D,SAA3B,EAAsC,CAAtC,CAAd;;AAEA,QAAI,CAACuW,QAAQlH,IAAR,CAAL,EAAoB;AAClB,YAAM,iCAAN;AACD,KAFD,MAGK;AACH,aAAOkH,QAAQlH,IAAR,EAAcvK,KAAd,CAAoB,IAApB,EAA0B4D,OAA1B,CAAP;AACD;AACF,GATD;AAUD;;AAED,SAAS8N,WAAT,GAAsB;AACpB,SAAO,UAASC,GAAT,EAAa;AAClB,WAAO,IAAItT,OAAJ,GACJM,GADI,CACA,CAAC,OAAD,EAAU,QAAV,CADA,EACqBgT,IAAI7E,MADzB,EAEJtO,IAFI,CAEC,QAFD,CAAP;AAGD,GAJD;AAKD;;AAED;AACA,SAASoT,aAAT,GAAwB;AACtB,MAAIhO,UAAU3M,MAAM4F,SAAN,CAAgBC,KAAhB,CAAsB3F,IAAtB,CAA2B+D,SAA3B,CAAd;AACA,SAAO,UAASyW,GAAT,EAAa;AAClB,QAAIjI,UAAU,IAAIrL,OAAJ,GACXG,IADW,CACN,UADM,CAAd;AAEA,oBAAKmT,IAAI7E,MAAT,EAAiB,UAAS+E,MAAT,EAAiB5W,CAAjB,EAAmB;AAClC,UAAIN,QAAQiJ,QAAQ,CAAR,KAAcA,QAAQ,CAAR,MAAe,eAA7B,GAA+CiO,OAAOzF,SAAP,CAAiB5M,GAAhE,GAAsEqS,OAAOzF,SAAP,CAAiB7M,KAAnG;AACAmK,cAAQ/K,GAAR,CAAY,CAAC,QAAD,EAAWhE,KAAX,CAAZ,EAA+BkX,OAAO9Z,KAAtC;AACD,KAHD;AAIA,WAAO2R,OAAP;AACD,GARD;AASD;;AAED,SAASoI,kBAAT,GAA6B;AAC3B,SAAO,UAASH,GAAT,EAAa;AAClB,QAAIjI,UAAU,IAAIrL,OAAJ,GACXG,IADW,CACN,gBADM,CAAd;AAEA,oBAAKmT,IAAI7E,MAAT,EAAiB,UAAS+E,MAAT,EAAiB5W,CAAjB,EAAmB;AAClC,UAAI8B,KAAJ;AACA,sBAAK8U,MAAL,EAAa,UAAS9Z,KAAT,EAAgBkJ,GAAhB,EAAoB;AAC/B,YAAIA,QAAQ,QAAZ,EAAsB;AACpBlE,kBAAQkE,GAAR;AACD;AACF,OAJD;AAKAyI,cAAQ/K,GAAR,CAAY,CAAC,QAAD,EAAWjF,OAAOmY,OAAO9U,KAAP,CAAP,CAAX,CAAZ,EAA+C8U,OAAO/E,MAAtD;AACD,KARD;AASA,WAAOpD,OAAP;AACD,GAbD;AAcD;;AAED;AACA,SAASqI,oBAAT,GAA+B;AAC7B,MAAInO,UAAU3M,MAAM4F,SAAN,CAAgBC,KAAhB,CAAsB3F,IAAtB,CAA2B+D,SAA3B,CAAd;AACA,SAAO,UAASyW,GAAT,EAAa;AAClB,QAAIjI,UAAU,IAAIrL,OAAJ,GACXG,IADW,CACN,kBADM,CAAd;AAEA,oBAAKmT,IAAI7E,MAAT,EAAiB,UAAS+E,MAAT,EAAiB5W,CAAjB,EAAmB;AAClC,UAAIN,QAAQiJ,QAAQ,CAAR,KAAcA,QAAQ,CAAR,MAAe,eAA7B,GAA+CiO,OAAOzF,SAAP,CAAiB5M,GAAhE,GAAsEqS,OAAOzF,SAAP,CAAiB7M,KAAnG;AACA,UAAIsS,OAAO9Z,KAAP,CAAab,MAAjB,EAAyB;AACvB,wBAAK2a,OAAO9Z,KAAZ,EAAmB,UAASia,KAAT,EAAgBtP,CAAhB,EAAkB;AACnC,cAAI3F,KAAJ;AACA,0BAAKiV,KAAL,EAAY,UAASja,KAAT,EAAgBkJ,GAAhB,EAAoB;AAC9B,gBAAIA,QAAQ,QAAZ,EAAsB;AACpBlE,sBAAQkE,GAAR;AACD;AACF,WAJD;AAKAyI,kBAAQ/K,GAAR,CAAY,CAAEjF,OAAOsY,MAAMjV,KAAN,CAAP,CAAF,EAAwBpC,KAAxB,CAAZ,EAA6CqX,MAAMlF,MAAnD;AACD,SARD;AASD,OAVD,MAWK;AACHpD,gBAAQhN,SAAR,CAAkB/B,KAAlB;AACD;AACF,KAhBD;AAiBA,WAAO+O,OAAP;AACD,GArBD;AAsBD;;AAED;AACA,SAASuI,wBAAT,GAAmC;AACjC,MAAIrO,UAAU3M,MAAM4F,SAAN,CAAgBC,KAAhB,CAAsB3F,IAAtB,CAA2B+D,SAA3B,CAAd;AACA,MAAI,CAAC0I,QAAQ,CAAR,CAAL,EAAiB,MAAM,kGAAN;AACjB,SAAO,UAAS+N,GAAT,EAAa;AAClB,QAAIjI,UAAU,IAAIrL,OAAJ,GACXG,IADW,CACN,uBADM,CAAd;AAEA,oBAAKmT,IAAI7E,MAAT,EAAiB,UAAS+E,MAAT,EAAiB5W,CAAjB,EAAmB;AAClC,UAAIiX,WAAWL,OAAOjO,QAAQ,CAAR,EAAW,CAAX,CAAP,IAAwB,GAAxB,GAA8BiO,OAAOjO,QAAQ,CAAR,EAAW,CAAX,CAAP,CAA7C;AACA8F,cAAQ/K,GAAR,CAAY,CAAE,QAAF,EAAYuT,QAAZ,CAAZ,EAAoCL,OAAO/E,MAA3C;AACD,KAHD;AAIA,WAAOpD,OAAP;AACD,GARD;AASD;;AAED;AACA,SAASyI,0BAAT,GAAqC;AACnC,MAAIvO,UAAU3M,MAAM4F,SAAN,CAAgBC,KAAhB,CAAsB3F,IAAtB,CAA2B+D,SAA3B,CAAd;AACA,MAAI,CAAC0I,QAAQ,CAAR,CAAL,EAAiB,MAAM,kGAAN;AACjB,SAAO,UAAS+N,GAAT,EAAa;AAClB,QAAIjI,UAAU,IAAIrL,OAAJ,GACXG,IADW,CACN,yBADM,CAAd;AAEA,oBAAKmT,IAAI7E,MAAT,EAAiB,UAAS+E,MAAT,EAAiB5W,CAAjB,EAAmB;AAClC,UAAIN,QAAQiJ,QAAQ,CAAR,KAAcA,QAAQ,CAAR,MAAe,eAA7B,GAA+CiO,OAAOzF,SAAP,CAAiB5M,GAAhE,GAAsEqS,OAAOzF,SAAP,CAAiB7M,KAAnG;AACA,sBAAKsS,OAAO,OAAP,CAAL,EAAsB,UAAS9Z,KAAT,EAAgB2K,CAAhB,EAAkB;AACtC,YAAI3F,QAAQhF,MAAM6L,QAAQ,CAAR,EAAW,CAAX,CAAN,IAAuB,GAAvB,GAA6B7L,MAAM6L,QAAQ,CAAR,EAAW,CAAX,CAAN,CAAzC;AACA8F,gBAAQ/K,GAAR,CAAY,CAAE5B,KAAF,EAASpC,KAAT,CAAZ,EAA8B5C,MAAM+U,MAApC;AACD,OAHD;AAID,KAND;AAOA,WAAOpD,OAAP;AACD,GAXD;AAYD;;AAED,SAAS0I,WAAT,GAAsB;AACpB,SAAO,UAAST,GAAT,EAAa;AAClB,QAAI7E,MAAJ,EAAYuF,KAAZ,EAAmB3I,OAAnB;AACA,QAAI,OAAOiI,IAAIU,KAAX,KAAqB,WAArB,IACG,OAAOV,IAAI7E,MAAX,KAAsB,WADzB,IAEK6E,IAAI7E,MAAJ,YAAsB7V,KAF/B,EAEsC;AAC9B;AACA6V,eAAS6E,IAAI7E,MAAb;AACAuF,cAAQV,IAAIU,KAAZ;AACP,KAND,MAOK,IAAI,OAAOV,IAAI7E,MAAJ,CAAWuF,KAAlB,KAA4B,WAA5B,IACF,OAAOV,IAAI7E,MAAJ,CAAWA,MAAlB,KAA6B,WAD3B,IAEA6E,IAAI7E,MAAJ,CAAWA,MAAX,YAA6B7V,KAFjC,EAEwC;AACrC;AACA6V,eAAS6E,IAAI7E,MAAJ,CAAWA,MAApB;AACAuF,cAAQV,IAAI7E,MAAJ,CAAWuF,KAAnB;AACP;AACD3I,cAAU,IAAIrL,OAAJ,GAAcG,IAAd,CAAmB,QAAnB,CAAV;AACAkL,YAAQjN,YAAR,CAAqB,YAArB;AACA,oBAAKqQ,MAAL,EAAa,UAAS/U,KAAT,EAAgBkD,CAAhB,EAAkB;AAC7B,UAAI,OAAOoX,KAAP,KAAiB,WAAjB,IAAgCA,MAAMpX,CAAN,CAApC,EAA8C;AAC5CyO,gBAAQhN,SAAR,CAAkBhD,OAAO2Y,MAAMpX,CAAN,EAAS8R,gBAAhB,CAAlB,EAAqD,CAAChV,KAAD,CAArD;AACD;AACF,KAJD;AAKA,WAAO2R,OAAP;AACD,GAxBD;AAyBD;;AAED,SAAS4I,SAAT,GAAoB;AAClB,SAAO,UAASX,GAAT,EAAa;AAClB,QAAIjI,UAAU,IAAIrL,OAAJ,GACXG,IADW,CACN,MADM,CAAd;AAEA,oBAAKmT,IAAI7E,MAAT,EAAiB,UAAS/U,KAAT,EAAgBkD,CAAhB,EAAkB;AACjCyO,cAAQ/K,GAAR,CAAa,CAAE,QAAF,EAAYjF,OAAOuB,IAAE,CAAT,CAAZ,CAAb,EAAwClD,KAAxC;AACD,KAFD;AAGA,WAAO2R,OAAP;AACD,GAPD;AAQD;;AAED,SAAS6I,eAAT,GAA0B;AACxB,MAAIjU,SAAS,KAAKA,MAAlB;AACA,SAAO,UAASqT,GAAT,EAAa;AAClB,QAAMa,oBAAoB,IAAInU,OAAJ,GACvBG,IADuB,CAClB,YADkB,CAA1B;;AAGA;AACA,QAAIiU,QAAQvF,OAAOC,IAAP,CAAY,sBAAQwE,IAAI7E,MAAJ,CAAW,CAAX,CAAR,CAAZ,CAAZ;;AAEA,QAAM4F,cAAcpU,UAAUA,OAAOuJ,KAArC;AACA,QAAI6K,eAAeA,YAAY5K,MAAZ,KAAuB,SAA1C,EAAqD;AACnD,UAAMtC,UAAUmM,IAAI7E,MAApB;AACA,UAAMK,OAAO,EAAb;AACA3H,cAAQ/C,OAAR,CAAgB,sBAAc;AAC5B,YAAMkQ,aAAazF,OAAOC,IAAP,CAAY,sBAAQZ,UAAR,CAAZ,CAAnB;AACA,YAAIoG,cAAcA,WAAWzb,MAA7B,EAAqC;AACnCyb,qBAAWlQ,OAAX,CAAmB,mBAAW;AAC5B,gBAAI,CAAC0K,KAAKyF,OAAL,CAAL,EAAoB;AAClBzF,mBAAKyF,OAAL,IAAgB,IAAhB;AACD;AACF,WAJD;AAKD;AACF,OATD;AAUAH,cAAQvF,OAAOC,IAAP,CAAYA,IAAZ,CAAR;AACD;;AAED,QAAI0F,QAAQ,CAAZ;AACAJ,UAAMhQ,OAAN,CAAc,iBAAS;AACrB+P,wBAAkB7T,GAAlB,CAAsB,CAAE5G,KAAF,EAAS,GAAT,CAAtB,EAAsCA,KAAtC;AACA8a;AACD,KAHD;;AAKA,QAAIxU,OAAJ,EAAa;AACX,UAAIC,UACCA,OAAOuJ,KADR,IAECvJ,OAAOuJ,KAAP,CAAaiL,OAFlB,EAE2B;AACzBL,gBAAQnU,OAAOuJ,KAAP,CAAaiL,OAArB;AACD;AACF;;AAED,SAAK,IAAI7X,IAAE,CAAX,EAAcA,IAAE0W,IAAI7E,MAAJ,CAAW5V,MAA3B,EAAmC+D,GAAnC,EAAuC;AACrC,UAAI4W,SAAS,CAAC5W,IAAE,CAAH,CAAb;AACA,WAAK,IAAI8X,SAAO,CAAhB,EAAmBA,SAAON,MAAMvb,MAAhC,EAAwC6b,QAAxC,EAAiD;AAC/ClB,eAAOxV,IAAP,CAAY,4BAAesV,IAAI7E,MAAJ,CAAW7R,CAAX,CAAf,EAA8BwX,MAAMM,MAAN,CAA9B,CAAZ;AACD;AACDP,wBAAkBvV,MAAlB,CAAyBvD,OAAOuB,IAAE,CAAT,CAAzB,IAAwC4W,MAAxC;AACD;;AAEDW,sBAAkB3F,YAAlB,CAA+B,CAA/B;;AAEA,WAAO2F,iBAAP;AACD,GAjDD;AAkDD;;AAED,SAASQ,gBAAT,GAA4B;AAC1B,SAAO,UAASrB,GAAT,EAAc;AACnB,QAAMsB,iBAAiB,IAAI5U,OAAJ,GACpBG,IADoB,CACf,SADe,CAAvB;;AAGA,oBAAKmT,IAAI7E,MAAT,EAAiB,UAAS/U,KAAT,EAAgBkD,CAAhB,EAAkB;AACjC,UAAMiY,UAAUhG,OAAOC,IAAP,CAAYpV,KAAZ,CAAhB;AACA,UAAM+D,IAAI/D,MAAMmb,QAAQ,CAAR,CAAN,CAAV;AACA,UAAMlX,IAAIjE,MAAMmb,QAAQ,CAAR,CAAN,CAAV;AACAD,qBAAevW,SAAf,CAAyB,CAAEhD,OAAOoC,CAAP,CAAF,EAAapC,OAAOsC,CAAP,CAAb,EAAwBjE,MAAM+U,MAA9B,CAAzB;AACD,KALD;AAMA,WAAOmG,cAAP;AACD,GAXD;AAYD;;AAED;AACA,IAAMxB,UAAU;AACd0B,UAAQzB,WADM;AAEdvF,YAAUyF,aAFI;AAGd,oBAAkBE,kBAHJ;AAId,sBAAoBC,oBAJN;AAKd,2BAAyBE,wBALX;AAMd,6BAA2BE,0BANb;AAOdnK,UAAQoK,WAPM;AAQd3U,QAAM6U,SARQ;AASdc,cAAYb,eATE;AAUd,kBAAgBS;AAVF,CAAhB,C;;;;;;;;;;;;;;;QCjOgBK,O,GAAAA,O;AAHhB;AACA;;AAEO,SAASA,OAAT,CAAiBC,EAAjB,EAAoB;AACzB,MAAIC,WAAW,EAAf;AACA,OAAK,IAAItY,CAAT,IAAcqY,EAAd,EAAkB;AAChB,QAAI,CAACA,GAAGlc,cAAH,CAAkB6D,CAAlB,CAAL,EAA2B;AAC3B,QAAI,QAAQqY,GAAGrY,CAAH,CAAR,KAAkB,QAAlB,IAA8BqY,GAAGrY,CAAH,MAAU,IAA5C,EAAkD;AAChD,UAAIuY,aAAaH,QAAQC,GAAGrY,CAAH,CAAR,CAAjB;AACA,WAAK,IAAIa,CAAT,IAAc0X,UAAd,EAA0B;AACxB,YAAI,CAACA,WAAWpc,cAAX,CAA0B0E,CAA1B,CAAL,EAAmC;AACnCyX,iBAAStY,IAAI,GAAJ,GAAUa,CAAnB,IAAwB0X,WAAW1X,CAAX,CAAxB;AACD;AACF,KAND,MAMO;AACLyX,eAAStY,CAAT,IAAcqY,GAAGrY,CAAH,CAAd;AACD;AACF;AACD,SAAOsY,QAAP;AACD,E;;;;;;;;;;;;QClBeE,c,GAAAA,c;AAAT,SAASA,cAAT,CAAwB1R,GAAxB,EAA6B2R,EAA7B,EAAiC3b,KAAjC,EAAwC;AAC7C,MAAI,OAAO2b,EAAP,IAAa,QAAjB,EACE,OAAOD,eAAe1R,GAAf,EAAoB2R,GAAG3Z,KAAH,CAAS,GAAT,CAApB,EAAmChC,KAAnC,CAAP,CADF,KAEK,IAAI2b,GAAGxc,MAAH,IAAW,CAAX,IAAgBa,UAAQiF,SAAxB,IAAqC+E,QAAQ,IAA7C,IACP,OAAOA,IAAI2R,GAAG,CAAH,CAAJ,CAAP,KAAsB,WADnB,EAEH,OAAO3R,IAAI2R,GAAG,CAAH,CAAJ,IAAa3b,KAApB,CAFG,KAGA,IAAI2b,GAAGxc,MAAH,IAAW,CAAf,EACH,OAAO6K,GAAP,CADG,KAEA,IAAI,OAAO2R,EAAP,KAAc,WAAd,IAA6B,OAAO3R,GAAP,KAAe,WAA5C,IACJ2R,OAAO,IADH,IACW3R,QAAQ,IADnB,IAEJ,OAAOA,IAAI2R,GAAG,CAAH,CAAJ,CAAP,KAAsB,WAFtB,EAGH,OAAO,IAAP,CAHG,KAKH,OAAOD,eAAe1R,IAAI2R,GAAG,CAAH,CAAJ,CAAf,EAA2BA,GAAG5W,KAAH,CAAS,CAAT,CAA3B,EAAwC/E,KAAxC,CAAP;AACH,C;;;;;;;;;;;;;;;;;;;kBCVc,UAAU0G,IAAV,EAAgB;AAC7B,MAAI,CAACvD,UAAUhE,MAAf,EAAuB,OAAO,KAAKwS,OAAL,CAAajL,IAAb,EAAP;AACvB,MAAIA,gBAAgBJ,iBAApB,EAA6B;AAC3B,SAAKqL,OAAL,GAAejL,IAAf;AACA,WAAO,IAAP;AACD;AACC,SAAOkV,cAAcxc,IAAd,CAAmB,IAAnB,EAAyBsH,IAAzB,CAAP;AACH,C;;AAXD;;;;AACA;;AACA;;;;AASC;;AAED,SAASkV,aAAT,CAAuBC,QAAvB,EAAiC;AAC/B,MAAIlK,OAAJ;AAAA,MACI3E,OADJ;AAAA,MAEIxG,IAFJ;AAAA,MAGIc,MAHJ;AAAA,MAIIwU,aAAa,EAJjB;AAAA,MAKI3H,KALJ;AAAA,MAMI4H,cANJ;AAAA,MAOI1P,KAPJ;AAAA,MAQI5F,IARJ;;AAUAuG,YAAU,KAAKzG,MAAL,CAAYyG,OAAtB;AACAxG,SAAOqV,SAASG,QAAT,IAAqB,EAA5B;AACA7H,UAAS,OAAO0H,SAAS1H,KAAhB,KAA0B,WAA3B,GAA0C0H,SAAS1H,KAAnD,GAA2D,EAAnE;;AAEA;AACAA,UAAQ,oBAAO;AACbc,mBAAe,IADF;AAEbD,sBAAkB,IAFL;AAGbiH,aAAS,EAHI;AAIbC,cAAU,IAJG;AAKb9H,cAAU,IALG;AAMbC,eAAW,IANE;AAObxE,cAAU;AAPG,GAAP,EAQLsE,KARK,CAAR;;AAUA,MAAIA,MAAMc,aAAN,KAAwB,QAA5B,EAAsC;AACpC3N,aAAS,QAAT;AACD,GAFD,MAGK,IAAI6M,MAAMc,aAAN,KAAwB,YAA5B,EAAyC;AAC5C3N,aAAS,YAAT;AACD,GAFI,MAGA,IAAI6M,MAAMc,aAAN,KAAwB,eAA5B,EAA6C;AAChD,QAAI,CAACd,MAAM+H,QAAP,IAAmB,CAAC/H,MAAMC,QAA9B,EAAwC;AACtC9M,eAAS,MAAT;AACD;AACD;AACD,GALI,MAMA,IAAI6M,MAAMc,aAAV,EAAyB;AAC5B,QAAI,CAACd,MAAM+H,QAAP,IAAmB,CAAC/H,MAAMC,QAA9B,EAAwC;AACtC9M,eAAS,QAAT;AACD,KAFD,MAGK,IAAI6M,MAAM+H,QAAN,IAAkB,CAAC/H,MAAMC,QAA7B,EAAuC;AAC1C,UAAID,MAAM+H,QAAN,YAA0Bhd,KAA1B,IAAmCiV,MAAM+H,QAAN,CAAe/c,MAAf,GAAwB,CAA/D,EAAkE;AAChEmI,iBAAS,uBAAT;AACAwU,mBAAWxX,IAAX,CAAgB6P,MAAM+H,QAAtB;AACD,OAHD,MAIK;AACH5U,iBAAS,gBAAT;AACD;AACF,KARI,MASA,IAAI6M,MAAMC,QAAN,IAAkB,CAACD,MAAM+H,QAA7B,EAAuC;AAC1C5U,eAAS,UAAT;AACAwU,iBAAWxX,IAAX,CAAgB0I,OAAhB;AACD,KAHI,MAIA,IAAImH,MAAM+H,QAAN,IAAkB/H,MAAMC,QAA5B,EAAsC;AACzC,UAAID,MAAM+H,QAAN,YAA0Bhd,KAA1B,IAAmCiV,MAAM+H,QAAN,CAAe/c,MAAf,GAAwB,CAA/D,EAAkE;AAChEmI,iBAAS,yBAAT;AACAwU,mBAAWxX,IAAX,CAAgB6P,MAAM+H,QAAtB;AACAJ,mBAAWxX,IAAX,CAAgB0I,OAAhB;AACD,OAJD,MAKK;AACH1F,iBAAS,kBAAT;AACAwU,mBAAWxX,IAAX,CAAgB0I,OAAhB;AACD;AACF;AACF;;AAED,MAAI,CAAC1F,MAAL,EAAa;;AAEX;AACA;AACA,QAAI,OAAOuU,SAAS9G,MAAhB,KAA2B,QAA/B,EAAwC;AACtCzN,eAAS,QAAT;AACD;;AAED;AACA;AACA,QAAIuU,SAAS9G,MAAT,YAA2B7V,KAA3B,IAAoC2c,SAAS9G,MAAT,CAAgB5V,MAAhB,GAAyB,CAAjE,EAAmE;;AAEjE;AACA;AACA,UAAI0c,SAAS9G,MAAT,CAAgB,CAAhB,EAAmBV,SAAnB,KAAiC,OAAOwH,SAAS9G,MAAT,CAAgB,CAAhB,EAAmB/U,KAA1B,IAAmC,QAAnC,IAA+C6b,SAAS9G,MAAT,CAAgB,CAAhB,EAAmB/U,KAAnB,IAA4B,IAA5G,CAAJ,EAAuH;AACrHsH,iBAAS,UAAT;AACAwU,mBAAWxX,IAAX,CAAgB0I,OAAhB;AACD;;AAED;AACA;AACA,UAAI,OAAO6O,SAAS9G,MAAT,CAAgB,CAAhB,EAAmBA,MAA1B,IAAoC,QAAxC,EAAiD;AAC/CzN,iBAAS,gBAAT;AACD;;AAED;AACA,UAAI,KAAKf,MAAL,CAAYE,IAAZ,KAAqB,SAArB,IAAkC0O,OAAOC,IAAP,CAAYyG,SAAS9G,MAAT,CAAgB,CAAhB,MAAuB,CAAvB,IAA4B,OAAO8G,SAAS9G,MAAT,CAAgB,CAAhB,EAAmBA,MAA1B,KAAqC,QAA7E,CAAtC,EAA8H;AAC5HzN,iBAAS,cAAT;AACD;;AAED;AACA;AACA,UAAIuU,SAAS9G,MAAT,CAAgB,CAAhB,EAAmB/U,KAAnB,YAAoCd,KAAxC,EAA8C;AAC5CoI,iBAAS,kBAAT;AACAwU,mBAAWxX,IAAX,CAAgB0I,OAAhB;AACD;;AAED;AACA;AACA,UAAI,OAAO6O,SAAS9G,MAAT,CAAgB,CAAhB,CAAP,KAA8B,QAA9B,IACC,OAAO8G,SAASvB,KAAhB,KAA0B,WAD/B,EAC2C;AACvChT,iBAAS,QAAT;AACA;AACA6M,cAAMmG,KAAN,GAAcuB,SAASvB,KAAvB;AACH;;AAED;AACA;AACA,UAAI,CAAC,OAAOuB,SAAS9G,MAAT,CAAgB,CAAhB,CAAP,KAA8B,QAA9B,IAA0C,OAAO8G,SAAS9G,MAAT,CAAgB,CAAhB,CAAP,IAA6B,QAAxE,KAAqF,OAAO8G,SAASvB,KAAhB,KAA0B,WAAnH,EAA+H;AAC7HhT,iBAAS,MAAT;AACD;;AAED;AACA;AACA,UAAI,CAACA,MAAL,EAAa;AACXA,iBAAS,YAAT;AACD;AACF;;AAED,QAAI,CAACA,MAAL,EAAa;AACXA,eAAS,YAAT;AACD;AACF;;AAED;AACA,MAAI,KAAKf,MAAL,CAAY8F,KAAZ,KAAsBpH,SAA1B,EAAqC;AACnC,QAAIuB,KAAK2V,YAAT,EAAuB;AACrB9P,cAAQ7F,KAAK2V,YAAb;AACD,KAFD,MAGK;AACH9P,cAAQ+P,gBAAgBjI,KAAhB,CAAR;AACD;AACD,SAAK5N,MAAL,CAAY8F,KAAZ,GAAoBA,KAApB;AACD;;AAED;AACA,MAAI,CAAC,KAAK9F,MAAL,CAAYE,IAAjB,EAAuB;AACrB,QAAID,KAAK6V,aAAL,IAAsB7V,KAAK6V,aAAL,CAAmBC,UAA7C,EAAyD;AACvD7V,aAAOD,KAAK6V,aAAL,CAAmBC,UAA1B;AACD,KAFD,MAGK;AACH7V,aAAO8V,eAAejV,MAAf,CAAP;AACD;AACD,SAAKf,MAAL,CAAYE,IAAZ,GAAmBA,IAAnB;AACD;;AAED;AACAsV,mBAAiBzV,kBAAQgB,MAAR,CAAeW,KAAf,CAAqB,IAArB,EAA2B,CAACX,MAAD,EAASjC,MAAT,CAAgByW,UAAhB,CAA3B,CAAjB;;AAEA;AACAnK,YAAUoK,eAAe,oBAAOF,QAAP,EAAiB,EAAE,SAAS1H,KAAX,EAAjB,CAAf,CAAV;;AAEA;AACA,MAAI7M,OAAON,OAAP,CAAe,UAAf,IAA6B,CAAC,CAAlC,EAAqC;AACnC2K,YAAQ4B,YAAR,CAAqB,CAArB,EAAwB,UAASvT,KAAT,EAAgBkD,CAAhB,EAAkB;AACxC,aAAO,IAAIsZ,IAAJ,CAASxc,KAAT,CAAP;AACD,KAFD;AAGD;;AAED2R,UAAQ6B,SAAR,CAAkB,CAAlB,EAAqB,UAASxT,KAAT,EAAgBkD,CAAhB,EAAkB;AACrC,WAAO,kCAAclD,KAAd,CAAP;AACD,GAFD;;AAIA,OAAK2R,OAAL,GAAeA,OAAf;;AAEA,MAAIkK,SAAShG,kBAAb,EAAiC;AAC/B,SAAKA,kBAAL,GAA0BgG,SAAShG,kBAAnC;AACD;;AAED,SAAO,IAAP;AACD;;AAED,SAASuG,eAAT,CAAyBjI,KAAzB,EAAgC;AAC9B,MAAIsI,WAAWtI,MAAMc,aAAN,GAAsBd,MAAMc,aAAN,CAAoBjM,OAApB,CAA4B,GAA5B,EAAiC,GAAjC,CAAtB,GAA8D,EAA7E;AAAA,MACIqD,KADJ;;AAGAA,UAAQoQ,SAASzT,OAAT,CAAkB,MAAlB,EAA0B,UAASsQ,CAAT,EAAW;AAC3C,WAAOA,EAAEoD,WAAF,EAAP;AACD,GAFO,CAAR;;AAIA,MAAIvI,MAAMa,gBAAV,EAA4B;AAC1B3I,aAAS,QAAQ8H,MAAMa,gBAAvB;AACD;AACD,SAAO3I,KAAP;AACD;;AAED,SAASkQ,cAAT,CAAwBjV,MAAxB,EAAgC;AAC9B,MAAIb,aAAJ;AACA,UAAQa,MAAR;AACE,SAAK,QAAL;AACEb,aAAO,QAAP;AACA;AACF,SAAK,UAAL;AACEA,aAAO,MAAP;AACA;AACF,SAAK,gBAAL;AACA,SAAK,uBAAL;AACEA,aAAO,KAAP;AACA;AACF,SAAK,kBAAL;AACA,SAAK,yBAAL;AACEA,aAAO,MAAP;AACA;AACF,SAAK,QAAL;AACEA,aAAO,gBAAP;AACA;AACF,SAAK,MAAL;AACA,SAAK,YAAL;AACA;AACEA,aAAO,OAAP;AArBJ;AAuBA,SAAOA,IAAP;AACD,C;;;;;;;;;;;;;;;kBChNc,UAASgT,GAAT,EAAc;AAC3B,MAAIkD,cAAJ;AACAC,qBAAmB,YAAU;AAC3B,QAAID,KAAJ,EAAW;AACTE,mBAAaF,KAAb;AACD;AACD,QAAMG,QAASrD,IAAI3H,OAAJ,CAAY3S,MAAZ,GAAqB,EAAtB,GAA4B,IAA5B,GAAmC,GAAjD;AACAwd,YAAQxb,WAAW,YAAU;AAC3B,sBAAKsY,IAAI3H,OAAT,EAAkB,UAASiL,KAAT,EAAe;AAC/B,YAAMC,UAAUD,MAAM1N,IAAN,CAAWC,UAAX,CAAsBxD,EAAtC;AACA,YAAIkR,OAAJ,EAAa;AACX,cAAMC,cAAcD,QAAQ5T,OAAR,CAAgBG,UAAhB,CAA2BA,UAA3B,CAAsC2T,WAA1D;AACA,cAAI1Z,QAAQyZ,WAAZ;AACA,cAAIF,MAAMxW,MAAN,CAAaqH,MAAb,IAAuBmP,MAAMxW,MAAN,CAAaqH,MAAb,CAAoBC,IAA3C,KAAoDkP,MAAMxW,MAAN,CAAaqH,MAAb,CAAoB/M,QAApB,KAAiC,MAAjC,IAA2Ckc,MAAMxW,MAAN,CAAaqH,MAAb,CAAoB/M,QAApB,KAAiC,OAAhI,CAAJ,EAA8I;AAC5I,gBAAMsc,mBAAmBH,QAAQ5T,OAAR,CAAgBU,WAAhB,GAA8BkT,QAAQ5T,OAAR,CAAgBU,WAAhB,CAA4BoT,WAA1D,GAAwE,CAAjG;AACA,gBAAME,mBAAmBJ,QAAQ5T,OAAR,CAAgBiU,eAAhB,GAAkCL,QAAQ5T,OAAR,CAAgBiU,eAAhB,CAAgCH,WAAlE,GAAgF,CAAzG;AACA1Z,oBAAQyZ,cAAcG,gBAAd,GAAiCD,gBAAzC;AACD;;AAEDH,kBAAQM,MAAR,CAAe;AACb9Z;AADa,WAAf;AAID;AACF,OAhBD;AAiBD,KAlBO,EAkBLsZ,KAlBK,CAAR;AAmBD,GAxBD;;AA0BA,SAAOS,UAAP;AACD,C;;AAtDD;;;;AAEA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;AA+BC;;AAED,SAASA,QAAT,GAAmB;AACjB,MAAMC,QAAQ;AACZzJ,8BADY;AAEZqH,4BAFY;AAGZtL,0BAHY;AAIZmE,8BAJY;AAKZ,cAAU,IAAIwJ,gBAAJ,EALE;AAMZ,iBAAa,IAAIC,kBAAJ,EAND;AAOZ,yBAAqB,IAAIC,0BAAJ,EAPT;AAQZ,4BAAwB,IAAIC,4BAAJ,EARZ;AASZ,oBAAgB,IAAIC,qBAAJ,EATJ;AAUZ,eAAW,IAAIC,iBAAJ,EAVC;AAWZ,kBAAc,IAAIC,oBAAJ;AAXF,GAAd;;AAcA,MAAMC,UAAU;AACd;AACA,QAFc,EAGd,aAHc,EAId,WAJc,EAKd,KALc,EAMd,OANc,EAOd,OAPc,EAQd,MARc,EASd,KATc,EAUd,MAVc,EAWd,QAXc;;AAad;AACA,mBAdc,EAed,wBAfc,EAgBd,sBAhBc,EAiBd,gBAjBc,EAkBd,iBAlBc,EAmBd,iBAnBc,EAoBd,mBApBc,CAAhB;;AAuBA,MAAMC,cAAc,SAAdA,WAAc,CAAC7U,OAAD,EAAU8U,WAAV,EAA0B;AAC5C,WAAOC,SAAS7L,OAAO8L,gBAAP,CAAwBhV,OAAxB,cAA2C8U,WAA3C,EAA0DlV,OAA1D,CAAkE,IAAlE,EAAwE,EAAxE,CAAT,CAAP;AACD,GAFD;;AAIA,WAASqV,iBAAT,GAA4B;AAC1B,QAAMC,mBAAmB;AACvBC,cAAQ,KAAK9M,EAAL,GAAUmB,aAAV,CAAwB,MAAM,KAAKrM,MAAL,CAAYkG,KAAlB,GAA0B,sBAAlD,CADe;AAEvB4B,aAAO;AACLqD,iBAAS,KAAKnL,MAAL,CAAYmG;AADhB,OAFgB;AAKvBhG,YAAM;AACJgG,6BAAa,KAAKnG,MAAL,CAAYoG,YAAzB,CADI;AAEJoO,iBAAS,EAFL;AAGJtU,cAAM,KAAKF,MAAL,CAAYE,IAAZ,CAAiBuC,OAAjB,CAAyB,aAAzB,EAAwC,EAAxC;AAHF;AALiB,KAAzB;;AAYA,QAAMwV,mBAAmB,KAAK/M,EAAL,EAAzB;;AAEA,QAAI2B,SAASoL,iBAAiBC,YAA9B;;AAEArL,cAAW6K,YAAYO,gBAAZ,EAA8B,KAA9B,IAAuCP,YAAYO,gBAAZ,EAA8B,QAA9B,CAAlD;;AAEA,QAAI,KAAKjY,MAAL,CAAY+F,SAAhB,EAA2B;AACzB,UAAMoS,eAAe,KAAKjN,EAAL,GAAUmB,aAAV,CAAwB,qBAAxB,CAArB;AACA,UAAI8L,YAAJ,EAAkB;AAChBtL,kBAAUsL,aAAaD,YAAvB;AACD,OAFD,MAEO;AACLrL,kBAAU+K,SACR7L,OACG8L,gBADH,CACoB,KAAK3M,EAAL,EADpB,EAC+B,IAD/B,EAEG,WAFH,EAEgBzI,OAFhB,CAEwB,IAFxB,EAE6B,EAF7B,CADQ,CAAV;AAKD;AACF;;AAED,QAAI,KAAKzC,MAAL,CAAYgG,QAAhB,EAA0B;AACxB,UAAMoS,kBAAkB,KAAKlN,EAAL,GAAUmB,aAAV,CAAwB,wBAAxB,CAAxB;AACA,UAAI+L,eAAJ,EAAqB;AACnBvL,kBAAUuL,gBAAgBF,YAA1B;AACD,OAFD,MAEO;AACLrL,kBAAU+K,SACR7L,OACG8L,gBADH,CACoB,KAAK3M,EAAL,EADpB,EAC+B,IAD/B,EAEG,WAFH,EAEgBzI,OAFhB,CAEwB,IAFxB,EAE6B,EAF7B,CADQ,CAAV;AAKD;AACF;;AAED,QAAI,KAAKzC,MAAL,CAAYiG,KAAhB,EAAuB;AACrB,UAAMoS,eAAe,KAAKnN,EAAL,GAAUmB,aAAV,CAAwB,qBAAxB,CAArB;AACA,UAAIgM,YAAJ,EAAkB;AAChBxL,kBAAUwL,aAAaH,YAAvB;AACD,OAFD,MAEO;AACLrL,kBAAU+K,SACR7L,OACG8L,gBADH,CACoB,KAAK3M,EAAL,EADpB,EAC+B,IAD/B,EAEG,WAFH,EAEgBzI,OAFhB,CAEwB,IAFxB,EAE6B,EAF7B,CADQ,CAAV;AAKD;AACF;;AAED,QAAIxF,QAAQ,KAAKiO,EAAL,GAAUmB,aAAV,CAAwB,WAAxB,EAAqCsK,WAArC,IACPe,YAAYO,gBAAZ,EAA8B,MAA9B,IAAwCP,YAAYO,gBAAZ,EAA8B,OAA9B,CADjC,CAAZ;AAEA,QAAIhb,QAAQ,CAAZ,EAAe;AACbA,cAAQ,CAAR;AACD;;AAED,QAAMqb,kBAAkB;AACtBvQ,YAAM;AACJ9K,oBADI;AAEJ4P,gBACEA,SAAS,CAAT,GACEA,MADF,GAEInO;AALF;AADgB,KAAxB;;AAUA,QAAM6Z,iBAAiB,4BAAW,EAAX,EAAeD,eAAf,EAAgC,KAAKtY,MAArC,EAA6C+X,gBAA7C,CAAvB;;AAEA,WAAOQ,cAAP;AACD;;AAED,kBAAKd,OAAL,EAAc,UAASvX,IAAT,EAAe7D,KAAf,EAAsB;AAClC4a,UAAM/W,IAAN,IAAc;AACZuL,cAAQ,kBAAU;AAAA;;AAChB,YAAMnG,UAAUwS,kBAAkBjf,IAAlB,CAAuB,IAAvB,CAAhB;;AAEA;AACA,YAAM2f,WAAW,gDAAwB,KAAKpN,OAAL,CAAazM,MAArC,CAAjB;AACA,YAAI8Z,YAAY,EAAhB;AACA,YAAInT,QAAQ2F,QAAR,KAAqB,SAArB,KAAmC/K,SAAS,KAAT,IAAkBA,SAAS,gBAA3B,IAA+CA,SAAS,MAAxD,IAAkEA,SAAS,WAA3E,IAA0FA,SAAS,aAAtI,CAAJ,EAA0J;AACxJuY,sBAAY,KAAKrN,OAAL,CAAazM,MAAzB;AACA,eAAKyM,OAAL,CAAazM,MAAb,IAAuB,KAAKyM,OAAL,CAAazM,MAAb,CAAoB,CAApB,CAAvB,4BAAkD,0CAAkB,KAAKyM,OAAL,CAAazM,MAA/B,EAAuC6Z,QAAvC,CAAlD;AACA,cAAG,CAAClT,QAAQgF,SAAZ,EAAsB;AACpBhF,oBAAQuC,IAAR,GAAe;AACbnK,iBAAG;AACDvD,yBAAS;AACPd,uBAAK;AADE,iBADR;AAIDqf,sBAAM;AACJnU,0BAAQ;AAAA,2BAAQqE,CAAR;AAAA;AADJ;AAJL;AADU,aAAf;AAUD;AACF;;AAED;AACA,YAAItD,QAAQ+E,KAAZ,EAAmB;AACjB,eAAKe,OAAL,CAAazM,MAAb,IAAuB,KAAKyM,OAAL,CAAazM,MAAb,CAAoB,CAApB,CAAvB,4BAAkD,8BAAe,KAAKyM,OAAL,CAAazM,MAA5B,CAAlD;AACD;;AAED,YAAI,CAAC,CAAC,KAAKqB,MAAL,CAAY2Y,aAAd,IAA+BrT,QAAQnF,IAAR,CAAaqU,OAAb,CAAqB5b,MAApD,IAA8D,KAAKwS,OAAnE,IAA8E,KAAKA,OAAL,CAAanL,IAA/F,EAAqG;AACnG,cAAM2Y,cAAc,KAAKxN,OAAL,CAAanL,IAAb,IAAqB,EAAzC;;AADmG,kCAE7E2Y,WAF6E,CAE3F1Y,IAF2F;AAAA,cAE3FA,KAF2F,qCAEpF,EAFoF;;AAGnG,cAAI2Y,aAAa,CAAjB;AACA,cAAMC,gBAAgB,CAAC,UAAD,CAAtB;AACA,cAAIA,cAAcrU,QAAd,CAAuBvE,KAAvB,CAAJ,EAAkC;AAChC2Y,yBAAa,CAAb;AACD;AACDvT,kBAAQnF,IAAR,CAAaqU,OAAb,CAAqBrC,MAArB,CAA4B0G,UAA5B;AACD;;AAED,YAAI,KAAK1Y,IAAL,GAAY,CAAZ,EAAevH,MAAf,KAA0B,CAA1B,IAA+B,KAAKuH,IAAL,GAAYvH,MAAZ,KAAuB,CAA1D,EAA6D;AAC3D,cAAMyV,MAAM,oBAAZ;AACA,cAAMqB,YAAY,KAAK1P,MAAL,CAAY6G,YAAZ,CAAyBwH,GAAzB,KAAiCA,GAAnD;AACA,cAAI,KAAKrO,MAAL,CAAY8G,iBAAhB,EAAmC;AACjC,iBAAK0G,OAAL,CAAakC,SAAb;AACD;AACD;AACD;;AAED,YAAIqJ,eAAe,KAAnB;;AAEA,YAAI7Y,SAAS,OAAb,EAAsB;AACpB;AACAoF,kBAAQ+B,MAAR,CAAeC,IAAf,GAAsB,KAAtB;AACAhC,kBAAQnF,IAAR,CAAaqU,OAAb,GAAuB,CAAC,CACtB,KAAKxU,MAAL,CAAY8F,KAAZ,IAAqB,KAAK3F,IAAL,GAAY,CAAZ,EAAe,CAAf,CADC,EAEtB,KAAKA,IAAL,GAAY,CAAZ,EAAe,CAAf,CAFsB,CAAD,CAAvB;AAIA4Y,yBAAe,IAAf;AACD,SARD,MASK,IAAI7Y,SAAS,KAAT,IAAkBA,SAAS,OAA/B,EAAwC;AAC3CoF,kBAAQnF,IAAR,CAAaqU,OAAb,GAAuB,KAAKrU,IAAL,GAAY3B,KAAZ,CAAkB,CAAlB,CAAvB;AACD,SAFI,MAGA;;AAEH;AACA,cAAI0B,KAAKO,OAAL,CAAa,aAAb,IAA8B,CAAC,CAAnC,EAAsC;AACpC6E,oBAAQuC,IAAR,CAAamR,OAAb,GAAuB9Y,KAAKO,OAAL,CAAa,aAAb,IAA8B,CAAC,CAAtD;AACD;;AAED,cAAI,gCAAa,KAAKN,IAAL,GAAY,CAAZ,EAAe,CAAf,CAAb,CAAJ,EAAqC;AACnC;AACAmF,oBAAQuC,IAAR,CAAarK,CAAb,GAAiB8H,QAAQuC,IAAR,CAAarK,CAAb,IAAkB,EAAnC;AACA8H,oBAAQuC,IAAR,CAAarK,CAAb,CAAe0C,IAAf,GAAsB,YAAtB;AACAoF,oBAAQuC,IAAR,CAAarK,CAAb,CAAekb,IAAf,GAAsBpT,QAAQuC,IAAR,CAAarK,CAAb,CAAekb,IAAf,IAAuB;AAC3CnU,sBAAQ,KAAKvE,MAAL,CAAYoH,UAAZ,IAA0B,iCAAoB,KAAKjH,IAAL,GAAY,CAAZ,EAAe,CAAf,CAApB,EAAuC,KAAKA,IAAL,GAAY,CAAZ,IAAiB,KAAKA,IAAL,GAAY,CAAZ,EAAe,CAAf,CAAjB,GAAqC,KAAKA,IAAL,GAAY,CAAZ,EAAe,CAAf,CAA5E,CADS;AAE3C8Y,uBAAS,EAAExX,KAAK,CAAP;AAFkC,aAA7C;;AAKA6D,oBAAQnF,IAAR,CAAaqU,OAAb,CAAqB,CAArB,IAA0B,EAA1B;AACA,4BAAK,KAAKpJ,OAAL,CAAanM,YAAb,CAA0B,CAA1B,CAAL,EAAmC,UAASJ,IAAT,EAAelC,CAAf,EAAiB;AAClD,kBAAIA,IAAI,CAAR,EAAW;AACTkC,uBAAO,IAAIoX,IAAJ,CAASpX,IAAT,CAAP;AACD;AACDyG,sBAAQnF,IAAR,CAAaqU,OAAb,CAAqB,CAArB,EAAwB7X,CAAxB,IAA6BkC,IAA7B;AACD,aALD;AAMAyG,oBAAQnF,IAAR,CAAaqU,OAAb,CAAqB,CAArB,EAAwB,CAAxB,IAA6B,GAA7B;AACAlP,oBAAQnF,IAAR,CAAa3C,CAAb,GAAiB,GAAjB;AACA,gBAAI,KAAKwC,MAAL,CAAYmH,OAAZ,IAAuB,KAAKhH,IAAL,GAAY,CAAZ,EAAevH,MAAf,GAAwB,CAAnD,EAAsD;AACpD0M,sBAAQnF,IAAR,CAAa+Y,MAAb,GAAsB,CAAE,KAAK9N,OAAL,CAAavK,SAAb,CAAuB,CAAvB,EAA0BrC,KAA1B,CAAgC,CAAhC,CAAF,CAAtB;AACD;AACF,WArBD,MAsBK;AACH;AACA8G,oBAAQuC,IAAR,CAAarK,CAAb,GAAiB8H,QAAQuC,IAAR,CAAarK,CAAb,IAAkB,EAAnC;AACA8H,oBAAQuC,IAAR,CAAarK,CAAb,CAAe0C,IAAf,GAAsB,UAAtB;AACAoF,oBAAQuC,IAAR,CAAarK,CAAb,CAAe2b,UAAf,GAA4B,KAAK/N,OAAL,CAAanM,YAAb,CAA0B,CAA1B,EAA6BT,KAA7B,CAAmC,CAAnC,CAA5B;AACA,gBAAI,KAAKwB,MAAL,CAAYmH,OAAZ,IAAuB,KAAKhH,IAAL,GAAY,CAAZ,EAAevH,MAAf,GAAwB,CAAnD,EAAsD;AACpD0M,sBAAQnF,IAAR,CAAa+Y,MAAb,GAAsB,CAAE,KAAK9N,OAAL,CAAavK,SAAb,CAAuB,CAAvB,EAA0BrC,KAA1B,CAAgC,CAAhC,CAAF,CAAtB;AACD;AACF;;AAED,cAAI,KAAK2B,IAAL,GAAY,CAAZ,EAAevH,MAAf,KAA0B,CAA9B,EAAiC;AAC/B0M,oBAAQ+B,MAAR,CAAeC,IAAf,GAAsB,KAAtB;AACAyR,2BAAe,IAAf;AACD;;AAED,0BAAK,KAAK5Y,IAAL,GAAY,CAAZ,CAAL,EAAqB,UAAStB,IAAT,EAAelC,CAAf,EAAiB;AACpC,gBAAIA,IAAI,CAAR,EAAW;AACT2I,sBAAQnF,IAAR,CAAaqU,OAAb,CAAqBzW,IAArB,CAA0B,KAAKqN,OAAL,CAAanM,YAAb,CAA0BtC,CAA1B,CAA1B;AACD;AACF,WAJoB,CAInBkP,IAJmB,CAId,IAJc,CAArB;AAKD;;AAED,YAAIkN,YAAJ,EAAiB;AACf,cAAMK,gBAAgB,KAAKlO,EAAL,GAAUmB,aAAV,CAAwB,iBAAxB,CAAtB;AACA,cAAI+M,aAAJ,EAAmB;AACjBA,0BAAcC,MAAd;AACA/T,oBAAQyC,IAAR,CAAa9K,KAAb,GAAqB,KAAKiO,EAAL,GAAUmB,aAAV,CAAwB,WAAxB,EAAqCsK,WAA1D;AACD;AACDrR,kBAAQ+B,MAAR,CAAeC,IAAf,GAAsB,KAAtB;AACD;;AAED,YAAMgS,yCAAyC,CAAC,MAAD,EAAS,aAAT,EAAwB,WAAxB,EAAqC,MAArC,EAA6C,QAA7C,EAAuD,MAAvD,CAA/C;;AAEA,YAAIhU,QAAQ+D,wBAAR,IACC/D,QAAQ+D,wBAAR,CAAiC/B,IADlC,IAECgS,uCAAuC7Y,OAAvC,CAA+C6E,QAAQpF,IAAvD,IAA+D,CAAC,CAFrE,EAGE;AACA,cAAMgH,UAAU5B,QAAQnF,IAAR,CAAaqU,OAAb,IAAwBlP,QAAQnF,IAAR,CAAaqU,OAAb,CAAqB,CAArB,CAAxC;AACA,cAAItN,WAAWA,QAAQtO,MAAR,GAAiB,CAAhC,EAAmC;AACjC,gBAAM2gB,uBAAuB;AAC3B1R,oBAAM,GADqB;AAE3B5G,qBAAO,IAAIgV,IAAJ,CAAS/O,QAAQA,QAAQtO,MAAR,GAAiB,CAAzB,CAAT,CAFoB;AAG3B4gB,qBAAOlU,QAAQ+D,wBAAR,CAAiCjG;AAHb,aAA7B;AAKAkC,oBAAQmU,OAAR,gCAAuBnU,QAAQmU,OAAR,IAAmB,EAA1C,IAA+CF,oBAA/C;AACD;AACF;;AAED,YACE,EAAEjU,QAAQpM,OAAR,IAAmBoM,QAAQpM,OAAR,CAAgBoO,IAAhB,KAAyB,KAA9C,MAEChC,QAAQ+B,MAAR,CAAeC,IAAf,KAAwB,IAAxB,IACAhC,QAAQ+B,MAAR,IACI/B,QAAQ+B,MAAR,CAAenO,OADnB,IAEIoM,QAAQ+B,MAAR,CAAenO,OAAf,CAAuBoO,IAL5B,CADF,EAOK;;AAEH;AACAhC,kBAAQpM,OAAR,GAAkB;AAChBwgB,sBAAUC,yBADM;AAEhBpV,oBAAQ;AACNuB,qBAAO,KAAK9F,MAAL,CAAY9G,OAAZ,CAAoBqL,MAApB,CAA2BuB,KAD5B;AAENrM,qBAAO,eAACA,MAAD,EAAQmgB,KAAR,EAAeC,EAAf,EAAmBxd,KAAnB,EAA6B;AAClC,oBAAIyd,iBAAiBC,yBAAyBlhB,IAAzB,CAA8B,KAA9B,EAAoCY,MAApC,EAA2CmgB,KAA3C,EAAkDC,EAAlD,EAAsDxd,KAAtD,CAArB;AACA,oBAAI,MAAK2D,MAAL,CAAY9G,OAAZ,IAAuB,MAAK8G,MAAL,CAAY9G,OAAZ,CAAoBqL,MAA3C,IAAqD,MAAKvE,MAAL,CAAY9G,OAAZ,CAAoBqL,MAApB,CAA2B9K,KAApF,EACA;AACEqgB,mCAAiB,MAAK9Z,MAAL,CAAY9G,OAAZ,CAAoBqL,MAApB,CAA2B9K,KAA3B,CAAiCZ,IAAjC,CAAsC,KAAtC,EAA4CihB,cAA5C,EAA4DF,KAA5D,EAAmEC,EAAnE,EAAuExd,KAAvE,CAAjB;AACA;AACA,sBAAIiJ,QAAQ2F,QAAR,KAAqB,SAArB,KAAmC/K,SAAS,KAAT,IAAkBA,SAAS,gBAA3B,IAA+CA,SAAS,MAAxD,IACpCA,SAAS,WAD2B,IACZA,SAAS,aADhC,CAAJ,EACoD;AAClD4Z,qCAAiBxY,WAAW,CAAEwY,iBAAiB,GAAlB,GAAyBtB,SAASnc,KAAT,CAA1B,EAA2C2d,OAA3C,CAAmD,CAAnD,CAAX,CAAjB;AACD;AACD;AACA,sBAAI1U,QAAQ+E,KAAZ,EAAmB;AACjB,wBAAGwP,OAAO,KAAV,EAAgB;AACdC,wCAAkB,MAAK1O,OAAL,CAAazM,MAAb,CAAoBtC,QAAM,CAA1B,EAA6B,CAA7B,CAAlB;AACD;AACF;AACD,yBAAOyd,cAAP;AACD;AACD;AACA,oBAAIxU,QAAQ2F,QAAR,KAAqB,SAArB,KAAmC/K,SAAS,KAAT,IAAkBA,SAAS,gBAA3B,IAA+CA,SAAS,MAAxD,IACpCA,SAAS,WAD2B,IACZA,SAAS,aADhC,CAAJ,EACoD;AAClD4Z,mCAAiB,CAAEA,iBAAiB,GAAlB,GAAyBtB,SAASnc,KAAT,CAA1B,EAA2C2d,OAA3C,CAAmD,CAAnD,CAAjB;AACA,yBAAO1Y,WAAWwY,cAAX,CAAP;AACD;AACD;AACA,oBAAIxU,QAAQ+E,KAAZ,EAAmB;AACjB,sBAAGwP,OAAO,KAAV,EAAgB;AACdC,sCAAkB,MAAK1O,OAAL,CAAazM,MAAb,CAAoBtC,QAAM,CAA1B,EAA6B,CAA7B,CAAlB;AACD;AACF;AACD,uBAAOyd,cAAP;AACD;AAjCK;AAFQ,WAAlB;AAsCD;;AAED,YAAIxU,QAAQ+B,MAAR,CAAeC,IAAf,KAAwB,IAA5B,EAAkC;AAC9B,cAAM2S,yBAAiB3U,OAAjB,CAAN;AACI;AACJ2U,oBAAU9Z,IAAV,CAAe2H,KAAf,GAAuBoS,oBAAoBrO,IAApB,CAAyB,IAAzB,CAAvB;;AAEAoO,oBAAU5S,MAAV,CAAiB8S,IAAjB,GAAwB,IAAxB,CAL8B,CAKA;;AAE9B;AACA,eAAKrR,IAAL,CAAUC,UAAV,CAAqB,IAArB,IAA6BxD,YAAG6U,QAAH,CAAYH,SAAZ,CAA7B;;AAEAI,qCAAmBxhB,IAAnB,CAAwB,IAAxB,eAAkCyM,OAAlC,IAA2CgV,kBAAkB,4BAAM;AACjE,kBAAMlB,gBAAgB,MAAKlO,EAAL,GAAUmB,aAAV,CAAwB,iBAAxB,CAAtB;AACA,kBAAI+M,aAAJ,EAAmB;AACjB,oBACI9T,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,KAA5B,IACAgL,QAAQ+B,MAAR,CAAe/M,QAAf,KAA4B,QAFhC,EAGE;AACA2f,4BAAUlS,IAAV,CAAe8E,MAAf,IAAyBuM,cAAclB,YAAvC;AACA,wBAAKpP,IAAL,CAAUC,UAAV,CAAqB,IAArB,EAA2BgO,MAA3B,CAAkC,EAAElK,QAAQoN,UAAUlS,IAAV,CAAe8E,MAAzB,EAAlC;AACD,iBAND,MAMO;AACL,sBAAIoN,UAAUlS,IAAV,CAAe9K,KAAf,KAAyB,CAA7B,EAAgC;AAC9Bgd,8BAAUlS,IAAV,CAAe9K,KAAf,GAAuB,MAAKiO,EAAL,GAAUyL,WAAV,GACnBe,YAAY,MAAKxM,EAAL,EAAZ,EAAuB,MAAvB,CADmB,GAEnBwM,YAAY,MAAKxM,EAAL,EAAZ,EAAuB,OAAvB,CAFJ;AAGD;AACD+O,4BAAUlS,IAAV,CAAe9K,KAAf,IAAwBmc,cAAczC,WAAtC;AACA,wBAAK7N,IAAL,CAAUC,UAAV,CAAqB,IAArB,EAA2BgO,MAA3B,CAAkC,EAAE9Z,OAAOgd,UAAUlS,IAAV,CAAe9K,KAAxB,EAAlC;AACD;AACF;AACF,aAnBD;AAoBAsd,yBAAa,uBAAM;AACjB,oBAAKzR,IAAL,CAAUC,UAAV,CAAqB,IAArB,EAA2ByR,KAA3B;AACD;AAtBD;AAwBH,SAlCD,MAmCK;AACH,eAAK1R,IAAL,CAAUC,UAAV,CAAqB,IAArB,IAA6BxD,YAAG6U,QAAH,CAAY9U,OAAZ,CAA7B;AACD;AAEF,OArOW;AAsOZxF,cAAQ,kBAAU;AAChB;AACA,aAAK2L,MAAL;AACD,OAzOW;AA0OZiB,eAAS,mBAAU;AACjB,YAAI,KAAK5D,IAAL,CAAUC,UAAV,CAAqB,IAArB,CAAJ,EAAgC;AAC9B,eAAKD,IAAL,CAAUC,UAAV,CAAqB,IAArB,EAA2B2D,OAA3B;AACA,eAAK5D,IAAL,CAAUC,UAAV,CAAqB,IAArB,IAA6B,IAA7B;AACD;AACF;AA/OW,KAAd;AAiPD,GAlPD;;AAoPA,SAAOkO,KAAP;AACD;;AAED,SAASiD,mBAAT,CAA6BpS,KAA7B,EAAoCc,CAApC,EAAuC;AACrC,MAAM1I,OAAO,KAAKF,MAAL,CAAYE,IAAzB;AACA,MAAI,KAAK4I,IAAL,CAAUC,UAAV,CAAqBtB,UAArB,IACCvH,SAAS;AACV;gCAFJ,EAGoC;AAC5B,UAAMua,QAAQ,KAAK3R,IAAL,CAAUC,UAAV,CAAqBtB,UAArB,CAAgCf,MAA9C;AACA,UAAKkC,EAAEiR,EAAF,IAAQY,MAAMha,OAAN,CAAcmI,EAAEiR,EAAhB,IAAsB,CAAC,CAAhC,IACEjR,KAAK,CAACA,EAAEiR,EAAR,IAAcY,MAAMha,OAAN,CAAcmI,CAAd,IAAmB,CAAC,CADxC,EAC4C;AACxC,eAAOd,KAAP;AACH,OAHD,MAIK;AACH,YAAI5H,SAAS,OAAT,IAAoBA,SAAS,KAAjC,EAAwC;AACtC,iBAAO,gBAAP;AACD,SAFD,MAGK;AACH,iBAAO,iBAAP;AACD;AACF;AACR,KAjBD,MAkBK;AACH,WAAO4H,KAAP;AACD;AACF;;AAED,SAASiS,wBAAT,CAAkCtgB,KAAlC,EAAyCmgB,KAAzC,EAAgDC,EAAhD,EAAoDxd,KAApD,EAA2D;AACzD,MAAM6D,OAAO,KAAKF,MAAL,CAAYE,IAAzB;;AAEA,MAAI,KAAK4I,IAAL,CAAUC,UAAV,CAAqBtB,UAArB,IACCvH,SAAS;AACV;gCAFJ,EAGoC;AAC5B,UAAMua,QAAQ,KAAK3R,IAAL,CAAUC,UAAV,CAAqBtB,UAArB,CAAgCf,MAA9C;AACA,UAAI+T,MAAMha,OAAN,CAAcoZ,EAAd,IAAoB,CAAC,CAAzB,EAA4B;AAC1B,eAAOpgB,KAAP;AACD;AACR,KARD,MASK;AACH,WAAOA,KAAP;AACD;AACF;;AAED,SAAS4c,kBAAT,CAA4B7J,EAA5B,EAA+B;AAC7B,MAAI,OAAOT,MAAP,KAAkB,WAAtB,EAAmC;AACnCA,SAAO2O,QAAP,GAAkB3O,OAAOgL,MAAP,GAAgB,YAAU,CAAE,CAA9C;AACA,MAAIhL,OAAOrR,gBAAX,EAA6B;AAC3BqR,WAAOrR,gBAAP,CAAwB,QAAxB,EAAkC8R,EAAlC,EAAsC,IAAtC;AACD,GAFD,MAGK,IAAIT,OAAO4O,WAAX,EAAwB;AAC3B5O,WAAO4O,WAAP,CAAmB,UAAnB,EAA+BnO,EAA/B;AACD;AACF,C;;;;;;;;;;;;;kBC3dc,UAAUoO,SAAV,EAAqBC,OAArB,EAA8B;AAC3C,MAAMC,WAAWzf,KAAKC,GAAL,CAAS,IAAI2a,IAAJ,CAAS2E,SAAT,EAAoBtb,OAApB,KAAgC,IAAI2W,IAAJ,CAAS4E,OAAT,EAAkBvb,OAAlB,EAAzC,CAAjB;AACA,MAAMyb,SAAS,CACb,KADa,EAEb,KAFa,EAGb,KAHa,EAIb,KAJa,EAKb,KALa,EAMb,MANa,EAOb,MAPa,EAQb,KARa,EASb,MATa,EAUb,KAVa,EAWb,KAXa,EAYb,KAZa,CAAf;;AAeA;AACA,MAAID,YAAY,UAAhB,EAA4B;AAC1B,WAAO,UAASE,EAAT,EAAY;AACjB,UAAMC,OAAO,IAAIhF,IAAJ,CAAS+E,EAAT,CAAb;AACA,aAAOD,OAAOE,KAAKC,QAAL,EAAP,IAA0B,GAA1B,GAAgCD,KAAKE,WAAL,EAAvC;AACD,KAHD;AAID;AACD;AANA,OAOK,IAAIL,YAAY,QAAhB,EAA0B;AAC7B,aAAO,UAASE,EAAT,EAAY;AACjB,YAAMC,OAAO,IAAIhF,IAAJ,CAAS+E,EAAT,CAAb;AACA,eAAOD,OAAOE,KAAKC,QAAL,EAAP,IAA0B,GAA1B,GAAgCD,KAAKG,OAAL,EAAvC;AACD,OAHD;AAID;AACD;AANK,SAOA,IAAIN,YAAY,OAAhB,EAAyB;AAC5B,eAAO,UAAP;AACD;AACD;AAHK,WAIA;AACH,iBAAO,aAAP;AACD;AACF,C;;;;;;;;;;;;;;;kBCnCc,UAAUxV,OAAV,EAAmB;AAChC,MAAMuN,OAAOvN,QAAQnF,IAAR,CAAaqU,OAA1B;AACA,MAAMhP,kBAAkB,IAAxB;AACA,MAAMgR,QAAQ,KAAK1N,IAAL,CAAUC,UAAV,CAAqBxD,EAAnC;AACA,MAAIiP,UAAU,EAAd;AACA,MAAM6G,UAAU,KAAKnQ,EAAL,GAAUmB,aAAV,CAAwB,MAAM7G,gBAAgBxF,MAAhB,CAAuBkG,KAA7B,GAAqC,YAA7D,CAAhB;AACA,MAAMoV,eAAe9V,gBAAgBxF,MAAhB,CAAuBqH,MAA5C;;AAEA,MAAMI,aAAa,KAAKqB,IAAL,CAAUC,UAAV,CAAqBtB,UAArB,YACd;AACDyI,YAAQ,EADP;AAEDxJ,YAAQ,EAFP;AAGDgB,YAAQ,CAHP;AAIDC,WAAOtM,KAAKkgB,KAAL,CAAW,CAACF,QAAQnD,YAAR,GAAuB,EAAxB,IAA8B,EAAzC,CAJN;AAKDsD,WAAO;AALN,GADc,EAQdF,aAAa7T,UARC,CAAnB;;AAWA,MAAInC,QAAQ+B,MAAR,CAAexH,IAAnB,EAAyB;AACvB2U,cAAUlP,QAAQ+B,MAAR,CAAexH,IAAf,CAAoBgT,IAApB,CAAV;;AAEA;AACA,QAAM4I,gBAAgB,EAAtB;AACA,QAAMC,oBAAoB,EAA1B;AACA,QAAI7I,KAAK,CAAL,EAAQ,CAAR,MAAe,GAAnB,EAAwB;AACtB6I,wBAAkB3d,IAAlB,CAAuB8U,KAAK,CAAL,CAAvB;AACD;AACD2B,YAAQrQ,OAAR,CAAgB,kBAAU;AACxB,UAAIwX,aAAarW,QAAQnF,IAAR,CAAaqU,OAAb,CAAqBtR,IAArB,CAA0B;AAAA,eAAQ0Y,KAAK,CAAL,MAAYC,MAApB;AAAA,OAA1B,CAAjB;AACAH,wBAAkB3d,IAAlB,CAAuB4d,UAAvB;AACD,KAHD;AAIArW,YAAQnF,IAAR,CAAaqU,OAAb,GAAuBkH,iBAAvB;AACD,GAdD,MAcO;AACL,SAAK,IAAI/e,IAAI,CAAb,EAAgBA,IAAIkW,KAAKja,MAAzB,EAAiC+D,GAAjC,EAAsC;AACpC,UAAIkW,KAAKlW,CAAL,EAAQ,CAAR,MAAe,GAAf,IAAsB,CAAC,gCAAakW,KAAKlW,CAAL,EAAQ,CAAR,CAAb,CAA3B,EAAqD;AACnD6X,gBAAQzW,IAAR,CAAa8U,KAAKlW,CAAL,EAAQ,CAAR,CAAb;AACD;AACF;AACF;;AAED,MAAMyc,gBAAgB,KAAKlO,EAAL,GAAUmB,aAAV,CAAwB,iBAAxB,CAAtB;;AAEA,MAAIiF,QAAQ,UAAZ;AACA,MAAIgK,aAAahhB,QAAb,KAA0B,KAA1B,IAAmCghB,aAAahhB,QAAb,KAA0B,QAAjE,EAA2E;AACzEgX,YAAQ,YAAR;AACD;;AAED,MAAMwK,gCAAgCniB,SAASC,aAAT,CAAuB,KAAvB,CAAtC;AACAkiB,gCAA8B9W,YAA9B,CAA2C,OAA3C,EAAoD,2EAApD;AACA,MAAIsM,UAAU,YAAd,EAA4B;AAC1B8H,kBAAcvb,MAAd,CAAqBie,6BAArB;AACD;;AAED,MAAMC,qBAAqBpiB,SAASC,aAAT,CAAuB,KAAvB,CAA3B;AACAmiB,qBAAmB/W,YAAnB,CAAgC,OAAhC,2CAAgFsM,KAAhF;AACA8H,gBAAcvb,MAAd,CAAqBke,kBAArB;;AAEA,MAAMC,0BAA0BriB,SAASC,aAAT,CAAuB,KAAvB,CAAhC;AACAoiB,0BAAwBhX,YAAxB,CAAqC,OAArC,EAA8C,2DAA9C;AACA,MAAIsM,UAAU,UAAd,EAA0B;AACxB8H,kBAAcvb,MAAd,CAAqBme,uBAArB;AACD;;AAED,MAAMC,iCAAiCtiB,SAASC,aAAT,CAAuB,KAAvB,CAAvC;AACAqiB,iCAA+BjX,YAA/B,CAA4C,OAA5C,EAAqD,4EAArD;AACA,MAAIsM,UAAU,YAAd,EAA4B;AAC1B8H,kBAAcvb,MAAd,CAAqBoe,8BAArB;AACD;;AAEDC;;AAEA,WAASA,YAAT,GAAuB;AACrBzU,eAAWf,MAAX,GAAoB8N,QAAQhW,KAAR,CAAciJ,WAAWC,MAAzB,EAAiCD,WAAWC,MAAX,GAAoBD,WAAWE,KAAhE,CAApB;AACAF,eAAW+T,KAAX,GAAmBhH,QAAQ5b,MAA3B;AACAujB,0BAAsBtjB,IAAtB,CAA2B2M,eAA3B,EAA4CiC,WAAWf,MAAvD;AACA,QAAIe,WAAW+T,KAAX,GAAmB/T,WAAWE,KAAlC,EAAyC;AACvCyU,gCAA0BvjB,IAA1B,CAA+B2M,eAA/B;AACD;AACD,QAAIF,QAAQiV,WAAZ,EAAwB;AACtBjV,cAAQiV,WAAR;AACD;AACF;;AAED,WAAS4B,qBAAT,GAAgC;AAC9BJ,uBAAmBpP,SAAnB,GAA+B,EAA/B;;AAEAlF,eAAWf,MAAX,CAAkBvC,OAAlB,CAA0B,iBAAS;AACjC,UAAMkY,iBAAiBf,aAAa7c,KAAb,CAAmB+I,aAAnB,GAAmC/I,MAAMD,KAAN,CAAY,CAAZ,EAAe8c,aAAa7c,KAAb,CAAmB+I,aAAnB,GAAmC,CAAlD,CAAnC,GAA0F/I,KAAjH;AACA,UAAM6d,aAAa3iB,SAASC,aAAT,CAAuB,KAAvB,CAAnB;AACA0iB,iBAAW3P,SAAX,yCAAyD0P,cAAzD;AACAC,iBAAWC,WAAX,GAAyB9d,KAAzB;AACA6d,iBAAWtX,YAAX,CAAwB,OAAxB,EAAiC,aAAjC;AACA+W,yBAAmBle,MAAnB,CAA0Bye,UAA1B;;AAEA,UAAME,wBAAwB7iB,SAASC,aAAT,CAAuB,MAAvB,CAA9B;AACA4iB,4BAAsBxX,YAAtB,CAAmC,OAAnC,EAA4C,0BAA5C;AACAwX,4BAAsBrjB,KAAtB,CAA4BiB,eAA5B,GAA8Coc,MAAM1O,KAAN,CAAYwU,WAAWC,WAAvB,CAA9C;AACAD,iBAAWG,OAAX,CAAmBD,qBAAnB;;AAEA,UAAME,iBAAiB/iB,SAASC,aAAT,CAAuB,KAAvB,CAAvB;AACA0iB,iBAAW5hB,gBAAX,CAA4B,WAA5B,EAAyC,UAACzB,KAAD,EAAW;AAClDud,cAAMvO,KAAN,CAAYqU,WAAWC,WAAvB;AACA,YAAIjB,aAAapiB,OAAb,CAAqBoO,IAArB,IAA6BgV,WAAWC,WAAX,CAAuB3jB,MAAvB,GAAgC0iB,aAAa7c,KAAb,CAAmB+I,aAApF,EAAmG;AACjGkV,yBAAe1X,YAAf,CAA4B,OAA5B,4DAA6FsW,aAAahhB,QAA1G;AACAoiB,yBAAe/P,SAAf,SAEIrH,QAAQ+B,MAAR,CAAenO,OAAf,CAAuB0O,OAAvB,+CAFJ,IAGK0U,WAAWC,WAHhB;AAIAD,qBAAWze,MAAX,CAAkB6e,cAAlB;AACD;AACF,OAVD;AAWAJ,iBAAW5hB,gBAAX,CAA4B,UAA5B,EAAwC,UAACzB,KAAD,EAAW;AACjDud,cAAMmG,MAAN;AACAD,uBAAerD,MAAf;AACD,OAHD;AAIAiD,iBAAW5hB,gBAAX,CAA4B,OAA5B,EAAqC,UAACzB,KAAD,EAAW;AAC9C,YAAIG,UAAU,CAAd;AACA,YAAMwjB,WAAWnV,WAAWyI,MAAX,CAAkBzP,OAAlB,CAA0B6b,WAAWC,WAArC,CAAjB;AACA,YAAIK,WAAW,CAAf,EAAkB;AAChBnV,qBAAWyI,MAAX,CAAkBnS,IAAlB,CAAuBue,WAAWC,WAAlC;AACAnjB,oBAAU,GAAV;AACD,SAHD,MAIK;AACHqO,qBAAWyI,MAAX,CAAkBiC,MAAlB,CAAyByK,QAAzB,EAAmC,CAAnC;AACAxjB,oBAAU,CAAV;AACD;AACDkjB,mBAAWnjB,KAAX,CAAiBC,OAAjB,GAA2BA,OAA3B;AACAod,cAAMqG,MAAN,CAAaP,WAAWC,WAAxB;AACD,OAbD;AAcH,KA3CC;;AA6CA,QAAIjX,QAAQgV,gBAAZ,EAA6B;AAC3BhV,cAAQgV,gBAAR;AACAhV,cAAQgV,gBAAR,GAA2B,IAA3B;AACD;AAEF;;AAED,WAAS8B,yBAAT,GAAoC;AAClCJ,4BAAwBrP,SAAxB,GAAoC,EAApC;AACAmP,kCAA8BnP,SAA9B,GAA0C,EAA1C;AACAsP,mCAA+BtP,SAA/B,GAA2C,EAA3C;;AAEA,QAAMmQ,UAAUnjB,SAASC,aAAT,CAAuB,GAAvB,CAAhB;AACA,QAAMmjB,YAAYpjB,SAASC,aAAT,CAAuB,GAAvB,CAAlB;;AAEA,QAAMojB,WAAW,SAAXA,QAAW,CAACC,SAAD,EAAe;AAC9B,UAAIA,cAAc,SAAlB,EAA6B;AAC3B,YAAMC,QAAOzV,WAAWC,MAAX,GAAoBD,WAAWE,KAA5C;AACA,YAAIuV,QAAOzV,WAAW+T,KAAtB,EAA6B;AAC3B/T,qBAAWC,MAAX,GAAoBwV,KAApB;AACA;AACD;AACDzV,mBAAWC,MAAX,GAAoB,CAApB;AACA;AACD;;AAED,UAAMwV,OAAOzV,WAAWC,MAAX,GAAoBD,WAAWE,KAA5C;AACA,UAAIuV,QAAQ,CAAZ,EAAe;AACbzV,mBAAWC,MAAX,GAAoBwV,IAApB;AACA;AACD;;AAEDzV,iBAAWC,MAAX,GAAoBrM,KAAK8hB,KAAL,CAAW1V,WAAW+T,KAAX,GAAiB/T,WAAWE,KAAvC,IAAgDF,WAAWE,KAA/E;AACD,KAlBD;;AAoBAoV,cAAUriB,gBAAV,CAA2B,OAA3B,EAAoC,YAAM;AACxCsiB,eAAS,SAAT;AACAd;AACAkB;AACD,KAJD;;AAMAN,YAAQpiB,gBAAR,CAAyB,OAAzB,EAAkC,YAAM;AACtCsiB,eAAS,UAAT;AACAd;AACAkB;AACD,KAJD;;AAMA,QAAI9B,aAAahhB,QAAb,KAA0B,MAA1B,IAAoCghB,aAAahhB,QAAb,KAA0B,OAAlE,EAA2E;AACzEwiB,cAAQ9X,YAAR,CAAqB,OAArB,EAA8B,IAA9B;AACA+X,gBAAU/X,YAAV,CAAuB,OAAvB,EAAgC,MAAhC;AACAgX,8BAAwBne,MAAxB,CAA+Bkf,SAA/B;AACAf,8BAAwBne,MAAxB,CAA+Bif,OAA/B;AACD,KALD,MAKO;AACL;AACAA,cAAQ9X,YAAR,CAAqB,OAArB,EAA8B,MAA9B;AACA+X,gBAAU/X,YAAV,CAAuB,OAAvB,EAAgC,OAAhC;AACA8W,oCAA8Bje,MAA9B,CAAqCif,OAArC;AACAb,qCAA+Bpe,MAA/B,CAAsCkf,SAAtC;AACD;AAEF;;AAED,WAASK,iBAAT,GAA6B;AAC3B,QAAI5U,kBAAJ;AACA,QAAI7O,SAAS6O,SAAT,IAAsB7O,SAAS6O,SAAT,CAAmB6U,KAA7C,EAAoD;AAClD7U,kBAAY7O,SAAS6O,SAArB;AACAA,gBAAU6U,KAAV;AACD,KAHD,MAIK,IAAItR,OAAOuR,YAAX,EAAyB;AAC5B9U,kBAAYuD,OAAOuR,YAAP,EAAZ;AACA9U,gBAAU+U,eAAV;AACD;AACF;AACF,C;;AAjND;;IAAYxgB,E;;AAEZ;;;;;;;;;;;;;;;;;;;kBCAe,UAAU6L,CAAV,EAAa4U,kBAAb,EAAiCC,kBAAjC,EAAqD3V,KAArD,EAA4D;AACzE,MAAI9K,aAAJ;AACA,MAAI8I,cAAJ;AACA;AACA,MAAM4X,aAAa,KAAK1d,MAAL,CAAY2d,mBAAZ,IAAmC,UAAU1R,IAAV,EAAgB;AAAE,WAAOA,IAAP;AAAc,GAAtF;AACA,MAAM2R,cAAc,KAAK5d,MAAL,CAAY6d,oBAAZ,IAAoCL,kBAAxD;AACA,MAAMM,cAAc,KAAK9d,MAAL,CAAY+d,oBAAZ,IAAoCN,kBAAxD;;AAEA;AACA,OAAK,IAAI9gB,IAAI,CAAb,EAAgBA,IAAIiM,EAAEhQ,MAAtB,EAA8B+D,GAA9B,EAAmC;AACjC,QAAI,EAAGiM,EAAEjM,CAAF,MAASiM,EAAEjM,CAAF,EAAKlD,KAAL,IAAcmP,EAAEjM,CAAF,EAAKlD,KAAL,KAAe,CAAtC,CAAH,CAAJ,EAAkD;AAAE;AAAW;AAC/D,QAAI,CAACuD,IAAL,EAAW;AACT8I,cAAQ8X,cAAcA,YAAYhV,EAAEjM,CAAF,EAAKa,CAAjB,CAAd,GAAoCoL,EAAEjM,CAAF,EAAKa,CAAjD;AACAR,aAAO,mBAAmB,KAAKghB,KAAL,CAAW9kB,OAA9B,GAAwC,IAAxC,IAAgD4M,SAASA,UAAU,CAAnB,GAAuB,yBAAyB,4BAAWA,KAAX,CAAzB,GAA6C,YAApE,GAAmF,EAAnI,CAAP;AACD;AACD,QAAImG,OAAOyR,WAAW9U,EAAEjM,CAAF,EAAKsP,IAAhB,CAAX;AACA,QAAIxS,QAAQqkB,YAAYlV,EAAEjM,CAAF,EAAKlD,KAAjB,EAAwBmP,EAAEjM,CAAF,EAAKid,KAA7B,EAAoChR,EAAEjM,CAAF,EAAKkd,EAAzC,EAA6CjR,EAAEjM,CAAF,EAAKN,KAAlD,CAAZ;AACA,QAAIsH,UAAU,KAAKsa,UAAL,GAAkB,KAAKA,UAAL,CAAgBrV,EAAEjM,CAAF,EAAKlD,KAArB,CAAlB,GAAgDqO,MAAMc,EAAEjM,CAAF,EAAKkd,EAAX,CAA9D;AACA,QAAIpgB,SAAS,CAAC8F,MAAM9F,KAAN,CAAd,EAA4B;AAC1BuD,cAAQ,gBAAgB,KAAKghB,KAAL,CAAWE,WAA3B,GAAyC,GAAzC,GAA+CtV,EAAEjM,CAAF,EAAKkd,EAApD,GAAyD,IAAjE;AACA,UAAI5N,KAAKxL,OAAL,CAAa,+BAAb,MAAkD,CAAC,CAAvD,EAA0D;AACxDzD,gBAAU,oDAAoD2G,OAApD,GAA8D,WAA9D,GAA4E,4BAAWsI,IAAX,CAA5E,GAA+F,OAAzG;AACD;AACDjP,cAAU,uBAAuB,4BAAWvD,KAAX,CAAvB,GAA2C,OAArD;AACAuD,cAAQ,OAAR;AACD;AACF;AACD,SAAOA,OAAO,UAAd;AACD,C;;AA9BD,yC;;;;;;;;;;;;kBCAwBmhB,c;AAAT,SAASA,cAAT,CAAwBxf,MAAxB,EAAgC;AAC7C,MAAMyf,YAAYzf,OAAOH,KAAP,CAAa,CAAb,EAAgBgM,GAAhB,CAAoB;AAAA,WAAK5B,EAAE4B,GAAF,CAAM,UAAC7P,CAAD,EAAIgC,CAAJ,EAAU;AACzD,UAAI,OAAOhC,CAAP,KAAa,QAAjB,EAA2B;AACzB,YAAIgC,MAAM,CAAV,EAAa;AACX,iBAAOhC,IAAIiO,EAAEjM,IAAI,CAAN,CAAX;AACD;AACF;AACD,aAAOhC,CAAP;AACD,KAP0C,CAAL;AAAA,GAApB,CAAlB;AAQA,SAAOyjB,SAAP;AACD,C;;;;;;;;;;;;QCVeC,uB,GAAAA,uB;QAiBAC,iB,GAAAA,iB;AAjBT,SAASD,uBAAT,CAAiC1f,MAAjC,EAAyC;AAC9C,MAAM6Z,WAAW,EAAjB;AACA7Z,SAAOH,KAAP,CAAa,CAAb,EAAgB2F,OAAhB,CAAwB,UAACyE,CAAD,EAAIjM,CAAJ,EAAU;AAChCiM,MAAEzE,OAAF,CAAU,UAACxJ,CAAD,EAAO;AACf,UAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B;AACzB,YAAI,CAAC6d,SAAS7b,CAAT,CAAL,EAAkB;AAChB6b,mBAAS7b,CAAT,IAAchC,CAAd;AACA,iBAAO6d,SAAS7b,CAAT,CAAP;AACD;AACD6b,iBAAS7b,CAAT,KAAehC,CAAf;AACD;AACD,aAAO6d,SAAS7b,CAAT,CAAP;AACD,KATD;AAUD,GAXD;AAYA,SAAO6b,QAAP;AACD;;AAEM,SAAS8F,iBAAT,CAA2B3f,MAA3B,EAAmC6Z,QAAnC,EAA6C;AAClD,MAAM4F,YAAYzf,OAAOH,KAAP,CAAa,CAAb,EAAgBgM,GAAhB,CAAoB,UAAC5B,CAAD,EAAIjM,CAAJ;AAAA,WAAUiM,EAAE4B,GAAF,CAAM,UAAC7P,CAAD,EAAO;AAC3D,UAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B;AACzB,eAAQA,IAAI6d,SAAS7b,CAAT,CAAL,GAAoB,GAA3B;AACD;AACD,aAAOhC,CAAP;AACD,KAL+C,CAAV;AAAA,GAApB,CAAlB;AAMA,SAAOyjB,SAAP;AACD,C;;;;;;;;;;;;;ACzBD;;AACA;;;;AACA;;;;;;kBAEe;AACb3S,UAAQ,gBAASzO,IAAT,EAAc;AACpB,QAAMuhB,QAAQ5kB,SAASC,aAAT,CAAuB,KAAvB,CAAd;AACA,QAAM4kB,QAAQ7kB,SAASC,aAAT,CAAuB,KAAvB,CAAd;AACA,QAAMyU,MAAM1U,SAASC,aAAT,CAAuB,MAAvB,CAAZ;;AAEA,QAAM6kB,iBAAiB9kB,SAASC,aAAT,CAAuB,KAAvB,CAAvB;AACA,QAAM8kB,oBAAoB/kB,SAASC,aAAT,CAAuB,KAAvB,CAA1B;AACA,QAAM+kB,iBAAiBhlB,SAASC,aAAT,CAAuB,KAAvB,CAAvB;;AAEA2kB,UAAMnb,SAAN,GAAkB,KAAKpD,MAAL,CAAYkG,KAAZ,GAAoB,mBAAtC;AACAsY,UAAMpb,SAAN,GAAkB,KAAKpD,MAAL,CAAYkG,KAAZ,GAAoB,UAAtC;;AAEA;AACAuY,mBAAerb,SAAf,GAA2B,KAAKpD,MAAL,CAAYkG,KAAZ,GAAoB,QAA/C;AACAuY,mBAAe9R,SAAf,GAA2B,4BAAW,KAAK3M,MAAL,CAAY8F,KAAZ,IAAqB,EAAhC,CAA3B;AACA4Y,sBAAkBtb,SAAlB,GAA8B,KAAKpD,MAAL,CAAYkG,KAAZ,GAAoB,WAAlD;AACAwY,sBAAkB/R,SAAlB,GAA8B,4BAAW,KAAK3M,MAAL,CAAYgG,QAAZ,IAAwB,EAAnC,CAA9B;AACA2Y,mBAAevb,SAAf,GAA2B,KAAKpD,MAAL,CAAYkG,KAAZ,GAAoB,QAA/C;AACAyY,mBAAehS,SAAf,GAA2B,4BAAW,KAAK3M,MAAL,CAAYiG,KAAZ,IAAqB,EAAhC,CAA3B;;AAEAoI,QAAI1B,SAAJ,GAAgB,4BAAW3P,IAAX,KAAoB,EAApC;AACAwhB,UAAM1kB,WAAN,CAAkBuU,GAAlB;;AAEA,QAAI,KAAKrO,MAAL,CAAY8F,KAAZ,IAAqB,KAAK9F,MAAL,CAAY+F,SAArC,EAAgD;AAC9CwY,YAAMzkB,WAAN,CAAkB2kB,cAAlB;AACD;;AAED,QAAI,KAAKze,MAAL,CAAYgG,QAAhB,EAA0B;AACxBuY,YAAMzkB,WAAN,CAAkB4kB,iBAAlB;AACD;;AAEDH,UAAMzkB,WAAN,CAAkB0kB,KAAlB;;AAEA,QAAI,KAAKxe,MAAL,CAAYiG,KAAhB,EAAuB;AACrBsY,YAAMzkB,WAAN,CAAkB6kB,cAAlB;AACD;;AAED,QAAI,KAAK3e,MAAL,CAAYqG,EAAZ,IACC,KAAKrG,MAAL,CAAYqG,EAAZ,CAAemJ,OADhB,IAEC,KAAKxP,MAAL,CAAYqG,EAAZ,CAAemJ,OAAf,CAAuBC,QAFxB,IAGC,KAAKzP,MAAL,CAAYqG,EAAZ,CAAemJ,OAAf,CAAuBC,QAAvB,CAAgCvP,IAHrC,EAG2C;AACvC,uCAAqB;AACnB2C,iBAAS,KAAKqI,EAAL,EADU;AAEnB/K,cAAM,4BAAWnD,IAAX,KAAoB,EAFP;AAGnBkD,cAAM,KAAKF,MAAL,CAAYqG,EAAZ,CAAemJ,OAAf,CAAuBC,QAAvB,CAAgCvP,IAHnB;AAInBzB,eAAO,KAAKuB,MAAL,CAAYqG,EAAZ,CAAemJ,OAAf,CAAuBC,QAAvB,CAAgChR;AAJpB,OAArB;AAMD;;AAED,QAAI,KAAKuB,MAAL,CAAYuG,KAAZ,IACC,KAAKvG,MAAL,CAAYuG,KAAZ,CAAkBC,sBADvB,EAC+C;AAC3CiY,qBAAe/jB,gBAAf,CAAgC,OAAhC,EAAyC;AAAA,eAAK,+BAAgBC,EAAE+B,MAAF,CAASjC,SAAzB,EAAoCE,CAApC,CAAL;AAAA,OAAzC;AACAgkB,qBAAejkB,gBAAf,CAAgC,OAAhC,EAAyC;AAAA,eAAK,+BAAgBC,EAAE+B,MAAF,CAASjC,SAAzB,EAAoCE,CAApC,CAAL;AAAA,OAAzC;AACA0T,UAAI3T,gBAAJ,CAAqB,OAArB,EAA8B;AAAA,eAAK,+BAAgBC,EAAE+B,MAAF,CAASjC,SAAzB,EAAoCE,CAApC,CAAL;AAAA,OAA9B;AACD;;AAEL,SAAKuQ,EAAL,GAAUyB,SAAV,GAAsB,EAAtB;AACA,SAAKzB,EAAL,GAAUpR,WAAV,CAAsBykB,KAAtB;AAED,GA5DY;AA6Dbze,UAAQ,kBAAU;AAChB;AACA,SAAK2L,MAAL;AACD,GAhEY;AAiEbiB,WAAS,mBAAU;AACjB;AACD;AAnEY,C;;;;;;;;;;;;kBCDSkS,e;;AAHxB;;;;AACA;;;;;;AAEe,SAASA,eAAT,CAAyBnb,GAAzB,EAA8B;AAAA,MACnCxK,KADmC,GACbwK,GADa,CACnCxK,KADmC;AAAA,MAC5BiH,IAD4B,GACbuD,GADa,CAC5BvD,IAD4B;AAAA,MACtBC,IADsB,GACbsD,GADa,CACtBtD,IADsB;;AAE3ClH,QAAM4lB,cAAN;AACA,MAAMva,mBAAmB,CAAC,MAAD,EAAS,KAAT,EAAgB,KAAhB,EAAuB,MAAvB,EAA+B,KAA/B,CAAzB;AACA,MAAMC,SAASrE,KAAKsE,WAAL,EAAf;AACA,MAAI,CAACF,iBAAiBG,QAAjB,CAA0BvE,IAA1B,CAAL,EAAsC;AACpC,UAAM,IAAIK,KAAJ,CAAU,4BAAV,CAAN;AACD;;AAED,MAAMmE,WAAW,OAAjB;AACA,MAAIC,aAAa,EAAjB;AACA,MAAIC,UAAU,EAAd;;AAEA,MAAIL,WAAW,KAAf,EAAsB;AACpB,6BAAY;AACVtG,YAAMhF,MAAM6lB,aAAN,CAAoBC;AADhB,KAAZ;AAGA;AACD;;AAED,MAAIxa,WAAW,KAAX,IAAoBA,WAAW,MAAnC,EAA2C;AACzC,6BAAY;AACVtG,YAAMhF,MAAM6lB,aAAN,CAAoBC,sBADhB;AAEVrb,eAAS,CAFC;AAGVC,eAAS;AAHC,KAAZ;AAKA;AACD;;AAED,MAAIY,WAAW,MAAf,EAAuB;AACrB,8BAAW,EAAErE,MAAMqE,MAAR,EAAgBpE,UAAhB,EAAX;AACD;;AAED,MAAIoE,WAAW,KAAf,EAAsB;AACpB,8BAAW,EAAErE,MAAMqE,MAAR,EAAgBpE,UAAhB,EAAX;AACD;AACF,C;;;;;;ACvCD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,IAA6B;AACrC;AACA;AACA,QAAQ,EAA+B;;;AAGvC;AACA,eAAe,KAAK;AACpB,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA,eAAe,KAAK;AACpB,eAAe,OAAO,oCAAoC;AAC1D,gBAAgB,QAAQ;AACxB;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA,eAAe,KAAK;AACpB,eAAe,OAAO,oCAAoC;AAC1D,gBAAgB,QAAQ;AACxB;AACA;AACA,uCAAuC;AACvC;AACA;AACA,aAAa;AACb;;AAEA;AACA,eAAe,KAAK;AACpB,eAAe,OAAO,oCAAoC;AAC1D,gBAAgB,QAAQ;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA,eAAe,KAAK;AACpB,eAAe,OAAO,oCAAoC;AAC1D,gBAAgB,QAAQ;AACxB;AACA;AACA,uCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA,yBAAyB;AACzB,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oEAAoE,gBAAgB;;AAEpF;AACA;AACA,8EAA8E;AAC9E;;AAEA;;AAEA;AACA;AACA,wCAAwC,QAAQ;;AAEhD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA,2CAA2C;AAC3C,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B,YAAY;AAC3C;;AAEA;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA,sCAAsC;AACtC;;AAEA;AACA,6CAA6C;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA,2BAA2B,YAAY;AACvC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,qBAAqB;AACrB;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,iBAAiB;AACjB;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AAC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A,aAAa,SAAS;AACtB;AACA,aAAa,kBAAkB;AAC/B;AACA,aAAa,kBAAkB;AAC/B;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA,+CAA+C,SAAS;AACxD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,+BAA+B,WAAc;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA,mBAAmB,iBAAiB;AACpC;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,wCAAwC,SAAS;AACjD;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,+DAA+D;AAC/D;AACA;;AAEe,+CAAO,EAAC;;;AC/OO;AACS;;AAEvC,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,wBAAwB,GAAO;AAC/B,CAAC;AACD,0CAA0C,WAAc;AACxD","file":"node/keen-dataviz.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"d3\"), require(\"c3\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"d3\", \"c3\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"d3\"), require(\"c3\")) : factory(root[\"d3\"], root[\"c3\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(global, function(__WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__9__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n","export function each(o, cb, s) {\n  var n;\n  if (!o) {\n    return 0;\n  }\n  s = !s ? o : s;\n  if (o instanceof Array) {\n    // Indexed arrays, needed for Safari\n    for (n = 0; n < o.length; n++) {\n      if (cb.call(s, o[n], n, o) === false) {\n        return 0;\n      }\n    }\n  } else {\n    // Hashtables\n    for (n in o) {\n      if (o.hasOwnProperty(n)) {\n        if (cb.call(s, o[n], n, o) === false){\n          return 0;\n        }\n      }\n    }\n  }\n  return 1;\n}\n","function stickTooltip(event, tooltip) {\n  tooltip.style.opacity = 0;\n  tooltip.style.top = `${event.pageY}px`;\n  tooltip.style.left = `${event.pageX + 10}px`;\n}\n\nexport default function copyToClipboard(value, event) {\n  const placeholder = document.createElement('input');\n  placeholder.value = value;\n  document.body.appendChild(placeholder);\n  placeholder.select();\n  document.execCommand('copy');\n  document.body.removeChild(placeholder);\n\n  if (event) {\n    const notification = document.createElement('div');\n    notification.style.padding = '5px 10px';\n    notification.style.backgroundColor = '#ffffff';\n    notification.style.fontSize = '12px';\n    notification.style.position = 'absolute';\n    notification.style.top = `${event.pageY}px`;\n    notification.style.left = `${event.pageX + 10}px`;\n    notification.style.zIndex = '999';\n    notification.style.opacity = 1;\n    notification.style.transition = 'opacity 1s ease';\n    notification.innerText = 'copied!';\n\n    document.body.appendChild(notification);\n    document.addEventListener('mousemove', e => stickTooltip(e, notification));\n\n    setTimeout(() => {\n      notification.style.opacity = 1;\n      document.body.removeChild(notification);\n    }, 1000);\n  }\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","export function prettyNumber(input) {\n  // If it has 3 or fewer sig figs already, just return the number.\n  var input = Number(input),\n      sciNo = input.toPrecision(3),\n      prefix = '',\n      suffixes = ['', 'k', 'M', 'B', 'T'];\n\n  if (Number(sciNo) == input && String(input).length <= 4) {\n    return String(input);\n  }\n\n  if (Math.abs(input) >= 1000000000000000) {\n    return sciNo;\n  }\n\n  if (input >= 1 || input <= -1) {\n    if (input < 0){\n      //Pull off the negative side and stash that.\n      input = -input;\n      prefix = '-';\n    }\n    return prefix + recurse(input, 0);\n  }\n  else {\n    return input.toPrecision(3);\n  }\n\n  function recurse(input, iteration) {\n    var input = String(input);\n    var split = input.split('.');\n    // If there's a dot\n    if (split.length > 1) {\n      // Keep the left hand side only\n      input = split[0];\n      var rhs = split[1];\n      // If the left-hand side is too short, pad until it has 3 digits\n      if (input.length == 2 && rhs.length > 0) {\n        // Pad with right-hand side if possible\n        if (rhs.length > 0) {\n          input = input + '.' + rhs.charAt(0);\n        }\n        // Pad with zeroes if you must\n        else {\n          input += '0';\n        }\n      }\n      else if (input.length == 1 && rhs.length > 0) {\n        input = input + '.' + rhs.charAt(0);\n        // Pad with right-hand side if possible\n        if (rhs.length > 1) {\n          input += rhs.charAt(1);\n        }\n        // Pad with zeroes if you must\n        else {\n          input += '0';\n        }\n      }\n    }\n    var numNumerals = input.length;\n    // if it has a period, then numNumerals is 1 smaller than the string length:\n    if (input.split('.').length > 1) {\n      numNumerals--;\n    }\n    if (numNumerals <= 3) {\n      return String(input) + suffixes[iteration];\n    }\n    else {\n      return recurse(Number(input) / 1000, iteration + 1);\n    }\n  }\n}\n","const matchHtmlRegExp = /[\"'&<>]/;\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {string} string The string to escape for inserting into HTML\n * @return {string}\n * @public\n */\n\nexport function escapeHtml(string) {\n  var str = '' + string;\n  var match = matchHtmlRegExp.exec(str);\n\n  if (!match) {\n    return str;\n  }\n\n  var escape;\n  var html = '';\n  var index = 0;\n  var lastIndex = 0;\n\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34: // \"\n        escape = '&quot;';\n        break;\n      case 38: // &\n        escape = '&amp;';\n        break;\n      case 39: // '\n        escape = '&#39;';\n        break;\n      case 60: // <\n        escape = '&lt;';\n        break;\n      case 62: // >\n        escape = '&gt;';\n        break;\n      default:\n        continue;\n    }\n\n    if (lastIndex !== index) {\n      html += str.substring(lastIndex, index);\n    }\n\n    lastIndex = index + 1;\n    html += escape;\n  }\n\n  return lastIndex !== index\n    ? html + str.substring(lastIndex, index)\n    : html;\n}\n","export function extend(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    for (var prop in arguments[i]){\n      target[prop] = arguments[i][prop];\n    }\n  }\n  return target;\n}\n","import * as d3 from 'd3';\n\nexport function textWrap(text, width) {\n  text.each(function () {\n    let text = d3.select(this),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        x = text.attr(\"x\"),\n        y = text.attr(\"y\"),\n        dy = 0, //parseFloat(text.attr(\"dy\")),\n        tspan = text.text(null)\n                    .append(\"tspan\")\n                    .attr(\"x\", x)\n                    .attr(\"y\", y)\n                    .attr(\"dy\", dy + \"em\");\n    while (word = words.pop()) {\n        line.push(word);\n        tspan.text(line.join(\" \"));\n        if (tspan.node().getComputedTextLength() > width) {\n            line.pop();\n            tspan.text(line.join(\" \"));\n            line = [word];\n            tspan = text.append(\"tspan\")\n                        .attr(\"x\", x)\n                        .attr(\"y\", y)\n                        .attr(\"dy\", ++lineNumber * lineHeight + dy + \"em\")\n                        .text(word);\n        }\n    }\n  });\n}\n","import createNullList from '../utils/create-null-list';\nimport { each } from '../../utils/each';\n\nexport function appendColumn(str, input) {\n  const self = this;\n  const args = Array.prototype.slice.call(arguments, 2);\n  const label = (str !== undefined) ? str : null;\n\n  if (typeof input === 'function') {\n    self.matrix[0].push(label);\n    each(self.matrix, function(row, i) {\n      let cell;\n      if (i > 0) {\n        cell = input.call(self, row, i);\n        if (typeof cell === 'undefined') {\n          cell = null;\n        }\n        self.matrix[i].push(cell);\n      }\n    });\n  }\n\n  else if (!input || input instanceof Array) {\n    input = input || [];\n\n    if (input.length <= self.matrix.length - 1) {\n      input = input.concat(createNullList(self.matrix.length - 1 - input.length));\n    }\n    else {\n      // If this new column is longer than existing columns,\n      // we need to update the rest to match ...\n      each(input, function(value, i){\n        if (self.matrix.length -1 < input.length) {\n          appendRow.call(self, String(self.matrix.length));\n        }\n      });\n    }\n\n    self.matrix[0].push(label);\n    each(input, function(value, i){\n      self.matrix[i+1][self.matrix[0].length-1] = value;\n    });\n\n  }\n\n  return self;\n}\n\nexport function appendRow(str, input) {\n  const self = this;\n  const args = Array.prototype.slice.call(arguments, 2);\n  const label = (str !== undefined) ? str : null;\n  const newRow = [];\n\n  newRow.push(label);\n\n  if (typeof input === 'function') {\n    each(self.matrix[0], function(label, i){\n      let col;\n      let cell;\n      if (i > 0) {\n        col = self.selectColumn(i);\n        cell = input.call(self, col, i);\n        if (typeof cell === 'undefined') {\n          cell = null;\n        }\n        newRow.push(cell);\n      }\n    });\n    self.matrix.push(newRow);\n  }\n\n  else if (!input || input instanceof Array) {\n    input = input || [];\n\n    if (input.length <= self.matrix[0].length - 1) {\n      input = input.concat( createNullList( self.matrix[0].length - 1 - input.length ) );\n    }\n    else {\n      each(input, function(value, i){\n        if (self.matrix[0].length -1 < input.length) {\n          appendColumn.call(self, String( self.matrix[0].length));\n        }\n      });\n    }\n\n    self.matrix.push(newRow.concat(input));\n  }\n\n  return self;\n}\n","export default function (len) {\n  const list = [];\n  for (let i = 0; i < len; i++) {\n    list.push(null);\n  }\n  return list;\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;","export function testObject(input) {\n  if (input !== null && typeof input.getTime === 'function' && !isNaN(input.getTime())) {\n    return true;\n  }\n  return false;\n}\n\nexport function testString(input) {\n  const ISO_8601 = /^\\d{4}-\\d\\d-\\d\\dT\\d\\d:\\d\\d:\\d\\d(\\.\\d+)?(([+-]\\d\\d:\\d\\d)|Z)?$/i;\n  return ISO_8601.test(input);\n}\n\nexport default function (input) {\n  if (typeof input === 'object') {\n    return testObject(input);\n  } else if (typeof input === 'string') {\n    return testString(input);\n  }\n  return false;\n}\n","// Modifiers\nimport * as append from './modifiers/append';\nimport * as del from './modifiers/delete';\nimport * as filter from './modifiers/filter';\nimport * as insert from './modifiers/insert';\nimport * as select from './modifiers/select';\nimport * as sort from './modifiers/sort';\nimport * as update from './modifiers/update';\n\n// Utils\nimport analyses from './utils/analyses';\nimport { extend } from '../utils/extend';\nimport parsers from './utils/parsers';\n\nexport const Dataset = function (config = {}) {\n  if (this instanceof Dataset === false) {\n    return new Dataset(config);\n  }\n\n  this.matrix = [\n    ['Index']\n  ];\n  this.meta = {\n    type: undefined\n  };\n  this.config = config;\n}\n\nDataset.prototype.data = function (arr) {\n  if (!arguments.length) return this.matrix;\n  this.matrix = (arr instanceof Array ? arr : null);\n  return this;\n};\n\nDataset.prototype.set = function (coords, value) {\n  if (arguments.length < 2 || coords.length < 2) {\n    throw Error('Incorrect arguments provided for #set method');\n  }\n\n  var colIndex = 'number' === typeof coords[0] ? coords[0] : this.matrix[0].indexOf(coords[0]),\n      rowIndex = 'number' === typeof coords[1] ? coords[1] : select.selectColumn.call(this, 0).indexOf(coords[1]);\n\n  var colResult = select.selectColumn.call(this, coords[0]),\n      rowResult = select.selectRow.call(this, coords[1]);\n\n  // Column doesn't exist, create and reset colIndex\n  if (colResult.length < 1) {\n    append.appendColumn.call(this, String(coords[0]));\n    colIndex = this.matrix[0].length - 1;\n  }\n\n  // Row doesn't exist, create and reset rowIndex\n  if (rowResult.length < 1) {\n    append.appendRow.call(this, String(coords[1]));\n    rowIndex = this.matrix.length - 1;\n  }\n\n  // Set provided value\n  this.matrix[ rowIndex ][ colIndex ] = value;\n  return this;\n};\n\nDataset.prototype.type = function(str){\n  if (!arguments.length) return this.meta['type'];\n  this.meta['type'] = (str ? String(str) : undefined);\n  return this;\n};\n\nextend(Dataset.prototype, append);\nextend(Dataset.prototype, del);\nextend(Dataset.prototype, filter);\nextend(Dataset.prototype, insert);\nextend(Dataset.prototype, select);\nextend(Dataset.prototype, sort);\nextend(Dataset.prototype, update);\nextend(Dataset.prototype, analyses);\nDataset.parser = parsers(Dataset);\n\nexport default Dataset;\n","import { each } from '../../utils/each';\nimport { extend } from '../../utils/extend';\n\nfunction average(arr, start, end){\n  var set = arr.slice(start||0, (end ? end+1 : arr.length)),\n      sum = 0,\n      avg = null;\n\n  // Add numeric values\n  each(set, function(val, i){\n    if (typeof val === 'number' && !isNaN(parseFloat(val))) {\n      sum += parseFloat(val);\n    }\n  });\n  return sum / set.length;\n}\n\nfunction maximum(arr, start, end){\n  var set = arr.slice(start||0, (end ? end+1 : arr.length)),\n      nums = [];\n\n  // Pull numeric values\n  each(set, function(val, i){\n    if (typeof val === 'number' && !isNaN(parseFloat(val))) {\n      nums.push(parseFloat(val));\n    }\n  });\n  return Math.max.apply(Math, nums);\n}\n\nfunction minimum(arr, start, end){\n  var set = arr.slice(start||0, (end ? end+1 : arr.length)),\n      nums = [];\n\n  // Pull numeric values\n  each(set, function(val, i){\n    if (typeof val === 'number' && !isNaN(parseFloat(val))) {\n      nums.push(parseFloat(val));\n    }\n  });\n  return Math.min.apply(Math, nums);\n}\n\nfunction sum(arr, start, end){\n  // Copy set with given range\n  var set = arr.slice(start||0, (end ? end+1 : arr.length)),\n      sum = 0;\n\n  // Add numeric values\n  each(set, function(val, i){\n    if (typeof val === 'number' && !isNaN(parseFloat(val))) {\n      sum += parseFloat(val);\n    }\n  });\n  return sum;\n}\n\nconst getColumnAverage = function (arr) {\n  return average(arr, 1);\n};\nconst getRowAverage = getColumnAverage;\n\nconst getColumnSum = function (arr) {\n  return sum(arr, 1);\n};\nconst getRowSum = getColumnSum;\n\nconst getColumnMaximum = function (arr) {\n  return maximum(arr, 1);\n};\nconst getRowMaximum = getColumnMaximum;\n\nconst getColumnMinimum = function (arr) {\n  return minimum(arr, 1);\n};\nconst getRowMinimum = getColumnMinimum;\n\nconst getColumnLabel = function (arr) {\n  return arr[0];\n};\nconst getRowIndex = getColumnLabel;\n\nexport default {\n  average,\n  maximum,\n  minimum,\n  sum,\n  getColumnAverage,\n  getRowAverage,\n  getColumnSum,\n  getRowSum,\n  getColumnMaximum,\n  getRowMaximum,\n  getColumnMinimum,\n  getRowMinimum,\n  getColumnLabel,\n  getRowIndex,\n};\n","/**\n * Strip html tags from string\n *\n * @param  {string} string The string to strip\n * @return {string}\n * @public\n */\n\nexport function stripHtmlTags(inputString) {\n  if (typeof inputString !== 'string') {\n    return inputString;\n  }\n  return inputString.replace(/(<([^>]+)>)/ig, '');\n}\n","import { each } from './each';\n\nexport function extendDeep(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    each(arguments[i], function(prop, key){\n      if (( typeof target[key] !== 'undefined' && typeof prop !== 'undefined' ) &&\n          ( typeof target[key] === 'object'    && typeof prop === 'object' ) &&\n          ( target[key] !== null               && prop !== null )) {\n            extendDeep(target[key], prop);\n      }\n      else {\n        target[key] = prop;\n      }\n    });\n  }\n  return target;\n}\n","import downloadResults from './download-results';\n\nexport default function renderDownloadButton({\n  element,\n  label = 'Download',\n  type = 'json',\n  data,\n} = {}) {\n  const btnClass = 'keen-dataviz-button';\n  const isBtnRendered = [...element.parentNode.children]\n    .find(child => child.className === btnClass);\n  if (isBtnRendered) return;\n\n  const button = document.createElement('button');\n  button.innerText = label;\n  button.className = btnClass;\n  button.addEventListener('click', event => downloadResults({ event, type, data}));\n  element.parentNode.insertBefore(button, element.nextSibling);\n};","import domtoimage from 'dom-to-image';\nimport { saveAs } from 'file-saver';\n\nexport default function exportImage(obj) {\n  const { node, quality, bgcolor } = obj;\n  if (quality) {\n    if (quality < 0 || quality > 1) throw Error('Please provide image quality between 0 and 1');\n    domtoimage.toBlob(node, { quality, bgcolor })\n      .then((blob) => {\n        saveAs(blob, 'chart.jpeg');\n      });\n  }\n\n  if (!quality) {\n    domtoimage.toBlob(node)\n      .then((blob) => {\n        saveAs(blob, 'chart.png');\n      });\n  }\n}\n","function generateCsvContent(data) {\n  let csvContent = '';\n\n  data.forEach((row, i) => {\n    row.forEach((cell, j) => {\n      csvContent += String(cell).replace(/,/g, '');\n      if (row.length > j + 1) {\n        csvContent += ',';\n      }\n    });\n    if (data.length > i + 1) {\n      csvContent += '\\n';\n    }\n  });\n  return `data:text/csv;charset=utf-8,${encodeURIComponent(csvContent)}`;\n}\n\nexport default function exportData(obj) {\n  const { type, data } = obj;\n  const supportedFormats = ['json', 'csv'];\n  const format = type.toLowerCase();\n  if (!supportedFormats.includes(type)) {\n    throw new Error('This type is not supported');\n  }\n\n  const fileName = 'chart';\n  let fileFormat = supportedFormats[0];\n  let content = '';\n\n  if (format === 'json') {\n    content = `data:text/json;charset=utf-8, ${encodeURIComponent(JSON.stringify(data))}`;\n  }\n\n  if (format === 'csv') {\n    content = generateCsvContent(data);\n    fileFormat = format;\n  }\n\n  const htmlElement = document.createElement('a');\n  htmlElement.setAttribute('href', content);\n  htmlElement.setAttribute('download', `${fileName}.${fileFormat}`);\n  document.body.appendChild(htmlElement);\n  htmlElement.click();\n  document.body.removeChild(htmlElement);\n}\n","/*!\n *\n * Rangeable\n * Copyright (c) 2018 Karl Saunders (mobius1(at)gmx(dot)com)\n * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)\n * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.\n *\n * Version: 0.1.6\n *\n */\n(function(i,j){\"object\"==typeof exports?module.exports=j(\"Rangeable\"):\"function\"==typeof define&&define.amd?define([],j):i.Rangeable=j(\"Rangeable\")})(\"undefined\"==typeof global?this.window||this.global:global,function(){var i=function(s,t){var u=document.createElement(s);return t&&u.classList.add(t),u},j=function(s){return s&&\"function\"==typeof s},o=function(s,t,u){var v;return function(){if(u=u||this,!v)return s.apply(u,arguments),v=!0,setTimeout(function(){v=!1},t)}},q=function(s,t){this.plugins=[\"ruler\"],\"string\"==typeof s&&(s=document.querySelector(s)),this.input=s,this.config=Object.assign({},{type:\"single\",tooltips:\"always\",updateThrottle:30,formatTooltip:function(u){return u},classes:{input:\"rangeable-input\",container:\"rangeable-container\",vertical:\"rangeable-vertical\",progress:\"rangeable-progress\",handle:\"rangeable-handle\",track:\"rangeable-track\",multiple:\"rangeable-multiple\",disabled:\"rangeable-disabled\",tooltips:\"rangeable-tooltips\",tooltip:\"rangeable-tooltip\",visible:\"rangeable-tooltips--visible\"}},t),this.mouseAxis={x:\"clientX\",y:\"clientY\"},this.trackSize={x:\"width\",y:\"height\"},this.trackPos={x:\"left\",y:\"top\"},this.lastPos=0,this.double=\"double\"===this.config.type||Array.isArray(this.config.value),this.touch=\"ontouchstart\"in window||window.DocumentTouch&&document instanceof DocumentTouch,this.version=\"0.1.6\",this.init(),this.onInit()},r=q.prototype;return r.init=function(){if(!this.input.rangeable){var t,s={min:0,max:100,step:1,value:this.input.value};for(t in s)this.input[t]||(this.input[t]=s[t]),void 0!==this.config[t]&&(this.input[t]=this.config[t]);this.axis=this.config.vertical?\"y\":\"x\",this.input.rangeable=this,this.double?(this.input.values=this.config.value?this.config.value:[this.input.min,this.input.max],this.input.defaultValues=this.input.values.slice()):this.input.defaultValue||(this.input.defaultValue=this.input.value),this.render(),this.initialised=!0}},r.render=function(){var s=this,t=this.config,u=t.classes,v=i(\"div\",u.container),w=i(\"div\",u.track),x=i(\"div\",u.progress),y=i(\"div\",u.handle),z=i(\"div\",u.tooltip);if(this.input.tabIndex=-1,this.double){y=[i(\"div\",u.handle),i(\"div\",u.handle)],z=[];for(var A=0;3>A;A++)z[A]=i(\"div\",u.tooltip);y.forEach(function(C,D){C.index=D,x.appendChild(C),C.appendChild(z[D]),C.tabIndex=1,t.controls&&t.controls[D]&&t.controls[D].locked&&!0===t.controls[D].locked&&(C.locked=!0)}),t.vertical&&x.appendChild(y[0]),x.appendChild(z[2]),v.classList.add(u.multiple)}else x.appendChild(y),y.appendChild(z),y.tabIndex=1,t.controls&&t.controls.locked&&!0===t.controls.locked&&(y.locked=!0);if(v.appendChild(w),t.vertical&&v.classList.add(u.vertical),t.size&&(v.style[this.trackSize[this.axis]]=isNaN(t.size)?t.size:t.size+\"px\"),t.tooltips&&(v.classList.add(u.tooltips),\"string\"==typeof t.tooltips&&\"always\"===t.tooltips&&v.classList.add(u.visible)),this.nodes={container:v,track:w,progress:x,handle:y,tooltip:z},this.double){this.nodes.buffer=[];var B=i(\"div\",\"rangeable-buffers\");this.input.values.forEach(function(C,D){var E=i(\"div\",\"rangeable-buffer\");B.appendChild(E),s.nodes.buffer.push(E),w.appendChild(B),t.controls&&(s.limits=[{},{}],void 0!==t.controls[D].min&&(s.limits[D].min=t.controls[D].min),void 0!==t.controls[D].max&&(s.limits[D].max=t.controls[D].max))})}else y=i(\"div\",\"rangeable-buffer\"),w.appendChild(y),this.nodes.buffer=y,w.appendChild(y),t.controls&&(this.limits={},void 0!==t.controls.min&&(this.limits.min=t.controls.min),void 0!==t.controls.max&&(this.limits.max=t.controls.max));this.setLimits(t.controls),w.appendChild(x),this.input.parentNode.insertBefore(v,this.input),v.insertBefore(this.input,w),this.input.classList.add(u.input),this.bind(),this.update()},r.reset=function(){this.double?this.input.defaultValues.forEach(this.setValue,this):this.setValue(this.input.defaultValue),this.onEnd()},r.setValueFromPosition=function(s){var t=this.getLimits(),u=parseFloat(this.input.step),v=this.touch?s.touches[0][this.mouseAxis[this.axis]]:s[this.mouseAxis[this.axis]],w=v-this.rects.container[this.trackPos[this.axis]],x=this.rects.container[this.trackSize[this.axis]];return\"mousedown\"===s.type&&(!this.double&&this.nodes.handle.contains(s.target)||this.double&&(this.nodes.handle[0].contains(s.target)||this.nodes.handle[1].contains(s.target)))?!1:(s=(this.config.vertical?100*((x-w)/x):100*(w/x))*(t.max-t.min)/100+t.min,s=Math.ceil(s/u)*u,v>=this.lastPos&&(s-=u),parseFloat(s)!==parseFloat(this.startValue)&&void(u=!1,this.double&&(u=this.activeHandle.index),s=this.limit(s,u),this.setValue(s,u)))},r.start=function(s){return s.preventDefault(),this.startValue=this.getValue(),this.onStart(),this.nodes.container.classList.add(\"dragging\"),this.recalculate(),this.activeHandle=this.getHandle(s),!!this.activeHandle&&void(this.activeHandle.classList.add(\"active\"),this.setValueFromPosition(s),this.touch?(document.addEventListener(\"touchmove\",this.events.move,!1),document.addEventListener(\"touchend\",this.events.stop,!1),document.addEventListener(\"touchcancel\",this.events.stop,!1)):(document.addEventListener(\"mousemove\",this.events.move,!1),document.addEventListener(\"mouseup\",this.events.stop,!1)))},r.move=function(s){this.setValueFromPosition(s),this.lastPos=this.touch?s.touches[0][this.mouseAxis[this.axis]]:s[this.mouseAxis[this.axis]]},r.stop=function(){this.stopValue=this.getValue(),this.nodes.container.classList.remove(\"dragging\"),this.onEnd(),this.activeHandle.classList.remove(\"active\"),this.activeHandle=!1,this.touch?(document.removeEventListener(\"touchmove\",this.events.move),document.removeEventListener(\"touchend\",this.events.stop),document.removeEventListener(\"touchcancel\",this.events.stop)):(document.removeEventListener(\"mousemove\",this.events.move),document.removeEventListener(\"mouseup\",this.events.stop)),this.startValue!==this.stopValue&&this.input.dispatchEvent(new Event(\"change\")),this.startValue=null},r.keydown=function(s){var t=this,u=function(v){switch(s.key){case\"ArrowRight\":case\"ArrowUp\":t.stepUp(v);break;case\"ArrowLeft\":case\"ArrowDown\":t.stepDown(v);}};this.double?this.nodes.handle.forEach(function(v){v===document.activeElement&&u(v.index)}):this.nodes.handle===document.activeElement&&u()},r.stepUp=function(s){var t=parseFloat(this.input.step),u=this.getValue();this.double&&void 0!==s&&(u=u[s]),t=this.limit(parseFloat(u)+t,s),this.setValue(t,s)},r.stepDown=function(s){var t=parseFloat(this.input.step),u=this.getValue();this.double&&void 0!==s&&(u=u[s]),t=this.limit(parseFloat(u)-t,s),this.setValue(t,s)},r.limit=function(s,t){var u=this.input,v=this.getLimits();return s=parseFloat(s),this.double&&void 0!==t?(!t&&s>u.values[1]?s=u.values[1]:0<t&&s<u.values[0]&&(s=u.values[0]),this.limits)&&(t?s>this.limits[1].max?s=this.limits[1].max:s<this.limits[1].min&&(s=this.limits[1].min):s>this.limits[0].max?s=this.limits[0].max:s<this.limits[0].min&&(s=this.limits[0].min)):this.limits&&(s>this.limits.max?s=this.limits.max:s<this.limits.min&&(s=this.limits.min)),s>v.max?s=v.max:s<v.min&&(s=v.min),s=parseFloat(s),s=s.toFixed(this.accuracy)},r.recalculate=function(){var s=[];this.double?this.nodes.handle.forEach(function(t,u){s[u]=t.getBoundingClientRect()}):s=this.nodes.handle.getBoundingClientRect(),this.rects={handle:s,container:this.nodes.container.getBoundingClientRect()}},r.update=function(){var s=this;this.recalculate(),this.accuracy=0,this.input.step.includes(\".\")&&(this.accuracy=(this.input.step.split(\".\")[1]||[]).length);var t=this.getValue(),u=this.getLimits(),v=this.rects.container[this.trackSize[this.axis]],w=function(x,y,z){x.style[s.config.vertical?\"bottom\":\"left\"]=y+\"px\",x.style[s.trackSize[s.axis]]=z/u.max*v-y+\"px\"};this.double?(this.limits&&this.limits.forEach(function(x,y){w(s.nodes.buffer[y],x.min/u.max*v,x.max)}),this.input.values.forEach(function(x,y){s.setValue(s.limit(x,y),y)})):(this.limits&&w(this.nodes.buffer,this.limits.min/u.max*v,this.limits.max),this.setValue(this.limit(t)))},r.getValue=function(){return this.double?this.input.values:this.input.value},r.setValue=function(s,t){var u=this.nodes;if(this.double&&void 0===t)return!1;void 0===s&&(s=this.input.value),s=this.limit(s,t);var v=this.initialised&&(s!==this.input.value||this.nativeEvent),w=this.config.formatTooltip;if(this.double){var x=this.input.values;if(x[t]=s,this.config.tooltips){u.tooltip[t].textContent=w.call(this,s);var y=u.tooltip[0].getBoundingClientRect(),z=u.tooltip[1].getBoundingClientRect();y=!(y.right<z.left||y.left>z.right||y.bottom<z.top||y.top>z.bottom),u.container.classList.toggle(\"combined-tooltip\",y),y&&(u.tooltip[2].textContent=x[0]===x[1]?w.call(this,x[0]):w.call(this,x[0])+\" - \"+w.call(this,x[1]))}}else this.input.value=s,u.tooltip.textContent=w.call(this,s);this.setPosition(s,t),v&&(this.onChange(),this.nativeEvent||this.input.dispatchEvent(new Event(\"input\")),this.nativeEvent=!1)},r.native=function(){this.nativeEvent=!0,this.setValue()},r.getLimits=function(){return{min:parseFloat(this.input.min),max:parseFloat(this.input.max)}},r.setLimits=function(s){var t=this;if(void 0===s)return!1;this.limits||(this.limits=s);var u=function(v,w){void 0!==w.min&&(v.min=w.min),void 0!==w.max&&(v.max=w.max)};this.double?s.forEach(function(v,w){u(t.limits[w],v)}):u(this.limits,s),this.update()},r.setPosition=function(s){if(this.double){s=this.getPosition(this.input.values[0]);var t=this.getPosition(this.input.values[1]);this.nodes.progress.style[this.config.vertical?\"bottom\":\"left\"]=s+\"px\",s=t-s}else s=this.getPosition();this.nodes.progress.style[this.trackSize[this.axis]]=s+\"px\"},r.getPosition=function(s){void 0===s&&(s=this.input.value);var t=this.getLimits();return(s-t.min)/(t.max-t.min)*this.rects.container[this.trackSize[this.axis]]},r.getHandle=function(s){if(!this.double)return!this.nodes.handle.locked&&this.nodes.handle;var t=this.rects,u=Math.abs(s[this.mouseAxis[this.axis]]-t.handle[0][this.trackPos[this.axis]]);return t=Math.abs(s[this.mouseAxis[this.axis]]-t.handle[1][this.trackPos[this.axis]]),(s=s.target.closest(\".\"+this.config.classes.handle))||(s=u>t?this.nodes.handle[1]:this.nodes.handle[0]),!s.locked&&s},r.enable=function(){this.input.disabled&&(this.nodes.container.addEventListener(this.touch?\"touchstart\":\"mousedown\",this.events.start,!1),this.double?this.nodes.handle.forEach(function(s){return s.tabIndex=1}):this.nodes.handle.tabIndex=1,this.nodes.container.classList.remove(this.config.classes.disabled),this.input.disabled=!1)},r.disable=function(){this.input.disabled||(this.nodes.container.removeEventListener(this.touch?\"touchstart\":\"mousedown\",this.events.start),this.double?this.nodes.handle.forEach(function(s){return s.removeAttribute(\"tabindex\")}):this.nodes.handle.removeAttribute(\"tabindex\"),this.nodes.container.classList.add(this.config.classes.disabled),this.input.disabled=!0)},r.bind=function(){var s=this;this.events={},\"start move stop update reset native keydown\".split(\" \").forEach(function(t){s.events[t]=s[t].bind(s)}),this.events.scroll=o(this.events.update,this.config.updateThrottle),this.events.resize=o(this.events.update,this.config.updateThrottle),document.addEventListener(\"scroll\",this.events.scroll,!1),window.addEventListener(\"resize\",this.events.resize,!1),document.addEventListener(\"keydown\",this.events.keydown,!1),this.nodes.container.addEventListener(this.touch?\"touchstart\":\"mousedown\",this.events.start,!1),this.input.addEventListener(\"input\",this.events.native,!1),this.input.form&&this.input.form.addEventListener(\"reset\",this.events.reset,!1)},r.unbind=function(){document.removeEventListener(\"scroll\",this.events.scroll),window.removeEventListener(\"resize\",this.events.resize),document.removeEventListener(\"keydown\",this.events.keydown),this.nodes.container.removeEventListener(this.touch?\"touchstart\":\"mousedown\",this.events.start),this.input.removeEventListener(\"input\",this.events.native),this.input.form&&this.input.form.removeEventListener(\"reset\",this.events.reset),this.events=null},r.destroy=function(){this.input.rangeable&&(this.unbind(),this.input.classList.remove(this.config.classes.input),this.nodes.container.parentNode.replaceChild(this.input,this.nodes.container),delete this.input.rangeable,this.initialised=!1)},r.onInit=function(){j(this.config.onInit)&&this.config.onInit.call(this,this.getValue())},r.onStart=function(){j(this.config.onStart)&&this.config.onStart.call(this,this.getValue())},r.onChange=function(){j(this.config.onChange)&&this.config.onChange.call(this,this.getValue())},r.onEnd=function(){j(this.config.onEnd)&&this.config.onEnd.call(this,this.getValue())},q});","import 'promise-polyfill/src/polyfill';\nimport { Dataviz, Dataset } from './index';\n\nmodule.exports = {\n  default: Dataviz,\n  Dataviz,\n  Dataset,\n};\n","/* eslint-env browser */\nimport * as d3 from 'd3';\nimport c3 from 'c3';\n\nimport pkg from '../package.json';\nimport data from './data';\nimport { Dataset } from './dataset';\n\n// Utils\nimport { each } from './utils/each';\nimport isDateString from './utils/assert-date-string';\nimport { stripHtmlTags } from './utils/strip-html-tags';\nimport { escapeHtml } from './utils/escape-html';\nimport libraries from './libraries';\nimport { extendDeep } from './utils/extend-deep';\nimport exportImage from './utils/export-svg';\nimport exportData from './utils/export-data';\nimport renderDownloadButton from './utils/render-download-btn';\nimport renderExecutionMetadata from './utils/render-execution-metadata';\nimport copyToClipboard from './utils/copy-to-clipboard';\n\nimport palettes from './palettes/index';\n\n// Constructor\nexport const Dataviz = function (options = {}) {\n  if (this instanceof Dataviz === false) {\n    return new Dataviz(options);\n  }\n\n  this.c3 = c3; // expose for use outside\n  this.d3 = d3;\n\n  const datavizInstance = this;\n  const defaultOptions = {\n    showDeprecationWarnings: true,\n    showLoadingSpinner: false,\n\n    container: undefined, // querySelector of container, for example '#someDiv'\n    containerElement: undefined, // HTML parent element for the chart\n\n    // width: undefined, *deprecated* - use CSS\n    // height: undefined, *deprecated* - use CSS\n\n    title: undefined,\n    showTitle: true,\n\n    subtitle: undefined,\n\n    notes: undefined,\n    theme: 'keen-dataviz',\n\n    colors: [\n      '#00bbde', '#fe6672', '#eeb058', '#8a8ad6', '#ff855c', '#00cfbb',\n      '#5a9eed', '#73d483', '#c879bb', '#0099b6', '#d74d58', '#cb9141',\n      '#6b6bb6', '#d86945', '#00aa99', '#4281c9', '#57b566', '#ac5c9e',\n      '#27cceb', '#ff818b', '#f6bf71', '#9b9be1', '#ff9b79', '#26dfcd',\n      '#73aff4', '#87e096', '#d88bcb',\n    ],\n\n    colorMapping: {},\n    ui: {\n      executionMetadata: true,\n    },\n    utils: {\n      clickToCopyToClipboard: true,\n    },\n\n    indexBy: 'timeframe.start',\n    labels: [],\n    labelMapping: {},\n    labelMappingRegExp: undefined,\n    errorMapping: {},\n    showErrorMessages: true,\n    library: 'default',\n    sortGroups: undefined,\n    sortIntervals: undefined,\n\n    results: undefined, // raw data\n\n    // C3 chartOptions\n    type: undefined,\n    stacked: false,\n    dateFormat: undefined,\n    legend: {\n      show: true,\n      position: 'right',\n      alignment: 'top',\n      label: {\n        textMaxLength: 12\n      },\n      pagination: {\n        offset: 0, // start from\n        limit: 5 // items per page\n      },\n      tooltip: {\n        show: true,\n        pointer: true\n      },\n      sort: undefined\n    },\n\n    axis: {},\n    color: {},\n    size: {\n      // control it with CSS of .c3-chart\n    },\n    padding: {\n      top: 15\n    },\n    point: {\n      focus: {\n        expand: {\n          enabled: false\n        }\n      },\n      r: 2,\n      show: true,\n      sensitivity: 300\n    },\n    tooltip: {\n      horizontal: true,\n      format: {\n        // https://c3js.org/samples/tooltip_format.html\n      }\n    },\n    transition: {\n      // duration: 0\n    },\n    data: {\n      order: null,\n      selection: {\n       enabled: true,\n       draggable: true,\n       multiple: true\n     },\n     onselected: (d, element) => {\n      const selectedItems = this.view._artifacts.c3.selected();\n      const sum = selectedItems.reduce((prev, curr) => prev + curr.value, 0);\n      copyToClipboard(sum);\n     },\n   },\n   grid: {\n     y: {\n       show: true\n     }\n   },\n   partialIntervalIndicator: {\n     show: undefined,\n     className: 'partial-interval-indicator'\n   },\n   timezone: 'UTC',\n   table: {\n     schema: 'static',\n   },\n   renderOnVisible: false,\n   funnel: {\n     lines: true,\n     resultValues: true,\n     percents: {\n       show: false,\n       countingMethod: 'absolute',\n       decimals: 0\n     },\n     marginBetweenElements: false,\n     hover: true,\n     effect3d: 'both-sides',\n     minimalSize: false,\n   },\n   react: false,\n   range: false,\n   sparkline: false,\n    choropleth: {\n      map: 'world',\n      borders: {\n        show: true,\n        size: 0.5,\n        color: '#000'\n      },\n      showSlider: false\n    },\n    heatmap: {},\n  };\n\n  this.config = { ...extendDeep(defaultOptions, options) };\n\n  if (options.palette) {\n    if (!palettes[options.palette]){\n      console.log('Colors pallete not found', options.palette);\n    }\n    this.config.colors = palettes[options.palette].colors;\n  }\n\n  if (this.config.type) {\n    // backward compatibility with v2016... areachart -> area\n    this.config.type = convertChartTypes(this.config.type);\n  }\n\n  // overwriting options for range chart\n  if(this.config.type && this.config.type.includes('-range')) {\n    this.config.range = true;\n    this.config.type = this.config.type.replace('-range', '');\n    this.config.legend.show = false;\n    this.config.stacking = 'normal';\n    this.config.labels = ['Max', 'Min'];\n    this.config.colors = [\n      this.config.colors[0],\n      this.config.colors[0],\n    ];\n  }\n\n  // overwriting stacked when stacking added\n  if (this.config.stacking) {\n    this.config.stacked = true;\n  }\n\n  // overwriting options for sparkline chart\n  if (this.config.sparkline) {\n    this.config.legend.show = false;\n    this.config.axis = {\n      x: {\n        show: false,\n      },\n      y: {\n        show: false,\n      },\n    };\n    this.config.grid = {\n      x: {\n        show: false,\n      },\n      y: {\n        show: false,\n      },\n    };\n  }\n\n  // get DOM node by query\n  if (this.config.container) {\n    this.el(this.config.container);\n  }\n\n  if (options.legend !== undefined && !options.legend) {\n    this.config.legend = {\n      ...options,\n      show: false\n    };\n  }\n\n  if (options.color && options.color.pattern) {\n    // to match c3 options\n    this.config.colors = options.color.pattern;\n  }\n\n  if (this.config.legend\n      && this.config.legend.tooltip\n      && this.config.legend.tooltip.show === false\n      && this.config.tooltip.show === undefined) {\n    this.config.tooltip = { show: false };\n  }\n\n  this.dataset = new Dataset(this.config);\n  this.view = {\n    _prepared: false,\n    _rendered: false,\n    _artifacts: { /* state bin */ }\n  };\n\n  Dataviz.visuals.push(this);\n\n  if (this.config.showLoadingSpinner) {\n    this.prepare();\n  }\n\n  if (!!this.config.results) {\n    this.render(this.config.results);\n  }\n  this.config.firstVisibilityState = document.visibilityState;\n\n  if (!this.config.utils.clickToCopyToClipboard) {\n    this.config.data.onselected = () => {};\n  }\n\n  if (options.data && options.data.onselected) {\n    this.config.data.onselected = (d, element) => {\n      const callback = options.data.onselected.bind(null, d, element);\n      callback();\n\n      if (this.config.utils.clickToCopyToClipboard) {\n        const selectedItems = this.view._artifacts.c3.selected();\n        const sum = selectedItems.reduce((prev, curr) => prev + curr.value, 0);\n        copyToClipboard(sum);\n      }\n    };\n  }\n\n};\n\n\nDataviz.libraries = { default: {} };\nif (typeof window !== 'undefined') {\n  Dataviz.libraries.default = libraries(Dataviz);\n}\nDataviz.visuals = [];\n\nDataviz.register = function (name, actions) {\n  Dataviz.libraries[name] = Dataviz.libraries[name] || {};\n  each(actions, function(method, key){\n    Dataviz.libraries[name][key] = method;\n  });\n};\n\nDataviz.find = function(target){\n  if (!arguments.length) return Dataviz.visuals;\n  const el = target.nodeName ? target : document.querySelector(target);\n  let match = null;\n  each(Dataviz.visuals, function(visual){\n    if (el == visual.config.container){\n      match = visual;\n      return false;\n    }\n  });\n  return match;\n};\n\n\n  // Prototype\n  // ------------\n\nDataviz.prototype.attributes = function(obj){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.attributes() is deprecated. Use: new KeenDataviz({ _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config;\n  const view = this.config;\n  each(obj, function(prop, key){\n    // Handle deprecated property names\n    if (key === 'chartType') {\n      key = 'type';\n    }\n    view[key] = prop;\n  });\n  return this;\n};\n\nDataviz.prototype.call = function(fn){\n    fn.call(this);\n    return this;\n};\n\nDataviz.prototype.chartOptions = function(obj){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.chartOptions() is deprecated. Use: new KeenDataviz({ _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config;\n  this.config = extendDeep(this.config, obj);\n  return this;\n};\n\nDataviz.prototype.colors = function(arr){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.colors() is deprecated. Use: new KeenDataviz({ colors: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.colors;\n  this.config.colors = (arr instanceof Array ? arr : []);\n  return this;\n};\n\nDataviz.prototype.colorMapping = function(obj){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.colorMapping() is deprecated. Use: new KeenDataviz({ colorMapping: _your_value_here_ })');\n  }\n  const datavizInstance = this;\n  if (!arguments.length) return this.config.colorMapping;\n  if (obj === null) {\n    this.config.colorMapping = {};\n  }\n  else if (typeof obj === 'object') {\n    each(obj, function(value, key){\n      datavizInstance.config.colorMapping[key] = (value ? value : null);\n    });\n  }\n  return this;\n};\n\nDataviz.prototype.data = data;\n\nDataviz.prototype.dateFormat = function(val){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.dateFormat() is deprecated. Use: new KeenDataviz({ dateFormat: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.dateFormat;\n  if (typeof val === 'string' || typeof val === 'function') {\n    this.config.dateFormat = val;\n  }\n  else {\n    this.config.dateFormat = undefined;\n  }\n  return this;\n};\n\nDataviz.prototype.destroy = function(){\n  const library = this.library();\n  const type = this.config.type;\n  const element = this.el();\n\n    // Call destroy method if present\n  if (Dataviz.libraries[library]\n      && Dataviz.libraries[library][type]){\n        Dataviz.libraries[library][type].destroy.call(this);\n  }\n\n    // Clear rendered artifacts, state bin\n  if (element) {\n    element.innerHTML = '';\n  }\n  this.view._prepared = false;\n  this.view._rendered = false;\n  this.view._artifacts = {};\n  return this;\n};\n\nDataviz.prototype.el = function(target){\n  const datavizInstance = this;\n  if (!arguments.length) return this.config.containerElement;\n  domReady(function(){\n    if (target && target !== null) {\n      if (target.nodeName) {\n        datavizInstance.config.containerElement = target;\n      }\n      else if (document.querySelector) {\n        datavizInstance.config.containerElement = document.querySelector(target);\n      }\n    }\n    else {\n      datavizInstance.config.containerElement = undefined;\n    }\n  });\n  return this;\n};\n\nDataviz.prototype.height = function(num){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.height() is deprecated - use CSS classes');\n  }\n  return this;\n};\n\n// IMPORTANT: Must be run before data parsing\nDataviz.prototype.indexBy = function(str){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.indexBy() is deprecated. Use: new KeenDataviz({ indexBy: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.indexBy;\n  this.config.indexBy = (str ? String(str) : 'timeframe.start');\n  return this;\n};\n\nDataviz.prototype.labels = function(arr){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.labels() is deprecated. Use: new KeenDataviz({ labels: _your_value_here_ })');\n  }\n\n  if (!arguments.length) return this.config.labels;\n  this.config.labels = (arr instanceof Array ? arr : []);\n\n  setLabels(this);\n\n  return this;\n};\n\nfunction setLabels(datavizInstance){\n  // Write labels\n  if (datavizInstance.data()[0].length === 2 && !isDateString(datavizInstance.data()[1][0])) {\n    datavizInstance.dataset.updateColumn(0, function(value, index){\n      if (datavizInstance.config.labels[index-1]) {\n        return stripHtmlTags(String(datavizInstance.config.labels[index-1]));\n      }\n      return stripHtmlTags(value);\n    }.bind(datavizInstance));\n  }\n  else {\n    datavizInstance.dataset.updateRow(0, function(value, index){\n      if (index > 0 && datavizInstance.config.labels[index-1]) {\n        return stripHtmlTags(String(datavizInstance.config.labels[index-1]));\n      }\n      return stripHtmlTags(value);\n    }.bind(datavizInstance));\n  }\n}\n\nDataviz.prototype.labelMapping = function(obj){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.labelMapping() is deprecated. Use: new KeenDataviz({ labelMapping: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.labelMapping;\n  if (obj === null) {\n    this.config.labelMapping = {};\n  }\n  else if (typeof obj === 'object') {\n    each(obj, function(value, key){\n      this.config.labelMapping[key] = (value ? value : null);\n    }.bind(this));\n  }\n\n  mapLabels(this);\n\n  return this;\n};\n\nfunction mapLabelsExec({ datavizInstance, value }){\n  if (datavizInstance.config.labelMappingRegExp){\n    let valueAfterMatching = value;\n    datavizInstance.config.labelMappingRegExp.forEach(regExpAndLabel => {\n      if (regExpAndLabel.length > 1) {\n        let regExpObj = regExpAndLabel[0];\n        if (regExpObj.test(value)){\n          valueAfterMatching = regExpAndLabel[1];\n        }\n      }\n    });\n    return stripHtmlTags(valueAfterMatching);\n  }\n  if (datavizInstance.config.labelMapping[value]) {\n    return stripHtmlTags(String(datavizInstance.config.labelMapping[value]));\n  }\n  return stripHtmlTags(value);\n}\n\nfunction mapLabels(datavizInstance){\n  // Write labels\n  if (!datavizInstance.config.labelMappingDimension) {\n    // if not defined use deprecated auto-detecting\n    if (datavizInstance.data()[0].length === 2 && !isDateString(datavizInstance.data()[1][0])) {\n      datavizInstance.config.labelMappingDimension = 'row';\n    } else {\n      datavizInstance.config.labelMappingDimension = 'column';\n    }\n  }\n\n  if (datavizInstance.config.labelMappingDimension === 'row'\n    || datavizInstance.config.labelMappingDimension === 'both') {\n    datavizInstance.dataset.updateColumn(0, function(value){\n      return mapLabelsExec({ datavizInstance, value });\n    }.bind(datavizInstance));\n  }\n\n  if (datavizInstance.config.labelMappingDimension === 'column'\n    || datavizInstance.config.labelMappingDimension === 'both') {\n    datavizInstance.dataset.updateRow(0, function(value){\n      return mapLabelsExec({ datavizInstance, value });\n    }.bind(datavizInstance));\n  }\n}\n\nDataviz.prototype.library = function(str){\n    if (!arguments.length) return this.config['library'];\n    this.config['library'] = (str ? String(str) : null);\n    return this;\n};\n\nDataviz.prototype.message = function(){\n    if (this.view._rendered) {\n      this.destroy();\n    }\n    if (this.el()) {\n      this.el().innerHTML = '';\n      const message = Dataviz.libraries.default.message;\n      if (message.render) {\n        message.render.apply(this, arguments);\n      }\n    }\n    return this;\n};\n\nDataviz.prototype.notes = function(str){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.notes() is deprecated. Use: new KeenDataviz({ notes: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.notes;\n  this.config.notes = (str ? String(str) : null);\n  return this;\n};\n\nDataviz.prototype.prepare = function(){\n    const datavizInstance = this;\n\n    if (!this.el()) {\n      throw `${this.config.container} not found. A DOM parent element is required to mount the chart.`;\n      return;\n    }\n\n    domReady(function(){\n      if (datavizInstance.view._rendered) {\n        datavizInstance.destroy();\n      }\n      if (datavizInstance.el()) {\n        datavizInstance.el().innerHTML = '';\n        const loader = Dataviz.libraries.default.spinner;\n        if (loader.render) {\n          loader.render.call(datavizInstance);\n        }\n        datavizInstance.view._prepared = true;\n      }\n    });\n\n    return this;\n};\n\nDataviz.prototype.render = function(results = undefined){\n  const datavizInstance = this;\n\n  if (!!results) {\n    const firstResult = results[0] || results;\n    if (\n      firstResult.query\n      && firstResult.query.interval\n      && firstResult.query.timeframe\n      && typeof firstResult.query.timeframe === 'string'\n      && firstResult.query.timeframe.includes('this_')\n      && this.config.partialIntervalIndicator\n      && this.config.partialIntervalIndicator.show === undefined\n    )\n    {\n      this.config.partialIntervalIndicator.show = true;\n    }\n\n    if (Array.isArray(results)) {\n      const timeframes = results.map(resultItem => resultItem.query.timeframe);\n      timeframes.forEach(resultTimeframe => {\n        let foundDifferent = timeframes.find(timeframeItem =>\n          JSON.stringify(timeframeItem) !== JSON.stringify(resultTimeframe)\n        );\n        if (foundDifferent){\n          const msg = 'Timeframes of the queries should be the same';\n          console.error(msg);\n          throw msg;\n        }\n      });\n      // first result is important to prepare X on the chart\n      return datavizInstance\n        .data(results[0])\n        .call(() => {\n          const input = results[0];\n          this.dataset.deleteColumn(1);\n          for (let result of results) {\n            let label = `${input.query.event_collection} ${input.query.analysis_type}`;\n            let ds2 = Dataset.parser('interval')(result);\n            datavizInstance.dataset.appendColumn(label, ds2.selectColumn(1).slice(1));\n          }\n        })\n        .render();\n    }\n\n    return datavizInstance.data(results).render();\n  }\n  if (\n    (!!this.config.labelMapping && Object.keys(this.config.labelMapping).length > 0)\n    ||\n    (!!this.config.labelMappingRegExp && this.config.labelMappingRegExp.length > 0)\n  ){\n    mapLabels(datavizInstance);\n  }\n  if (!!this.config.labels && Object.keys(this.config.labels).length > 0){\n    setLabels(datavizInstance);\n  }\n  if (!!this.config.sortGroups) {\n    sortGroups(datavizInstance);\n  }\n  if (!!this.config.sortIntervals) {\n    sortIntervals(datavizInstance);\n  }\n\n  const loader = Dataviz.libraries.default.spinner;\n  const library = this.config.library;\n  const type = this.config.type;\n  const containerElement = this.el();\n\n  if (!containerElement || containerElement === undefined) {\n    const msg = `${this.config.container} not found. A DOM parent element is required to mount the chart.`;\n    console.error(msg);\n    throw msg;\n    return;\n  }\n\n  let returnValue = datavizInstance;\n\n  if (datavizInstance.config.renderAsPromise) {\n    returnValue = new Promise((resolve, reject) => {\n      const customCallback = this.config.onrendered;\n      datavizInstance.config.onrendered = () => {\n        if (customCallback) {\n          customCallback();\n        }\n        resolve(datavizInstance);\n      }\n    });\n  }\n\n  domReady(function(){\n    const shouldRenderExecutionMetadata = datavizInstance.execution_metadata\n      && datavizInstance.config.ui\n      && datavizInstance.config.ui.executionMetadata;\n    const shouldRenderDownloadBtn = datavizInstance.config.ui\n      && datavizInstance.config.ui.buttons\n      && datavizInstance.config.ui.buttons.download\n      && datavizInstance.config.ui.buttons.download.type;\n    if (datavizInstance.view._prepared && loader.destroy) {\n      loader.destroy.apply(datavizInstance, arguments);\n    }\n    containerElement.innerHTML = '';\n\n    if (Dataviz.libraries[library] === 'undefined'){\n      // Error: Unregistered library\n      const msg = `Incorrect library`;\n      datavizInstance.message(msg);\n      throw msg;\n      return;\n    }\n    else {\n      if (typeof Dataviz.libraries[library][type] === 'undefined') {\n        const msg = `Incorrect chart type`;\n        const mappedMsg = this.config.errorMapping[msg] || msg;\n        datavizInstance.message(mappedMsg);\n        throw msg;\n        return;\n      }\n      else {\n        buildDomWrapper(containerElement,\n          datavizInstance.config\n        );\n        if (shouldRenderDownloadBtn) {\n          renderDownloadButton({\n            element: containerElement,\n            data: datavizInstance.dataset.matrix,\n            type: datavizInstance.config.ui.buttons.download.type,\n            label: datavizInstance.config.ui.buttons.download.label,\n           })\n        }\n        if (shouldRenderExecutionMetadata) {\n          renderExecutionMetadata({\n            element: containerElement,\n            data: datavizInstance.execution_metadata,\n          })\n        }\n        const { renderOnVisible } = datavizInstance.config;\n        if(renderOnVisible){\n          if(typeof IntersectionObserver !== 'undefined'){\n            const chartVisibleCallback = (events, observer) => {\n              events.forEach(el => {\n                if(el.isIntersecting){\n                  if(!datavizInstance.view._rendered){\n                    Dataviz.libraries[library][type].render.call(datavizInstance);\n                    datavizInstance.view._rendered = true;\n                  }\n                }\n              })\n            }\n            const observer = new IntersectionObserver(chartVisibleCallback);\n            observer.observe(containerElement);\n            return;\n          }\n        }\n        if(datavizInstance.config.firstVisibilityState === 'hidden'){\n          if(typeof document !== 'undefined') {\n            let hidden, visibilityChange;\n            if (typeof document.hidden !== \"undefined\") {\n              hidden = \"hidden\";\n              visibilityChange = \"visibilitychange\";\n            } else if (typeof document.msHidden !== \"undefined\") {\n              hidden = \"msHidden\";\n              visibilityChange = \"msvisibilitychange\";\n            } else if (typeof document.webkitHidden !== \"undefined\") {\n              hidden = \"webkitHidden\";\n              visibilityChange = \"webkitvisibilitychange\";\n            }\n            const handleVisibilityChange = () => {\n              if(!document[hidden] && datavizInstance.view._artifacts.c3) {\n                datavizInstance.view._artifacts.c3.load(datavizInstance.dataset.matrix);\n              }\n            }\n            if(typeof document.addEventListener !== \"undefined\" ||\n               hidden !== undefined){\n              document.addEventListener(visibilityChange, handleVisibilityChange, {\n                once: true\n              });\n            }\n          }\n        }\n        Dataviz.libraries[library][type].render.call(datavizInstance);\n        datavizInstance.view._rendered = true;\n      }\n    }\n  });\n\n  return returnValue;\n};\n\nDataviz.prototype.sortGroups = function(str){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.sortGroups() is deprecated. Use: new KeenDataviz({ sortGroups: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.sortGroups;\n  this.config.sortGroups = (str ? String(str) : null);\n\n  sortGroups(this, str);\n\n  return this;\n};\n\nfunction sortGroups(datavizInstance){\n  // Sort groups\n  if (datavizInstance.config.sortGroups && datavizInstance.data().length > 1) {\n    if (isDateString(datavizInstance.data()[1][0])) {\n      datavizInstance.dataset.sortColumns(datavizInstance.config.sortGroups, datavizInstance.dataset.getColumnSum);\n    }\n    else {\n      datavizInstance.dataset.sortRows(datavizInstance.config.sortGroups, datavizInstance.dataset.getRowSum);\n    }\n  }\n}\n\nDataviz.prototype.sortIntervals = function(str){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.sortIntervals() is deprecated. Use: new KeenDataviz({ sortIntervals: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.sortIntervals;\n  this.config.sortIntervals = (str ? String(str) : null);\n\n  sortIntervals(this);\n\n  return this;\n};\n\nfunction sortIntervals(datavizInstance){\n  if (datavizInstance.config.sortIntervals) {\n    datavizInstance.dataset.sortRows(datavizInstance.config.sortIntervals);\n  }\n}\n\nDataviz.prototype.stacked = function(bool){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.stacked() is deprecated. Use: new KeenDataviz({ stacked: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.stacked;\n  this.config.stacked = bool ? true : false;\n  return this;\n};\n\nDataviz.prototype.theme = function(str){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.theme() is deprecated. Use: new KeenDataviz({ theme: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.theme;\n  this.config.theme = (str ? String(str) : null);\n  return this;\n};\n\nDataviz.prototype.title = function(str){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.title() is deprecated. Use: new KeenDataviz({ title: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.title;\n  this.config.title = (str ? String(str) : null);\n  return this;\n};\n\nDataviz.prototype.type = function(str){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.type() is deprecated. Use: new KeenDataviz({ type: _your_value_here_ })');\n  }\n  if (!arguments.length) return this.config.type;\n  this.config.type = (str ? convertChartTypes(str) : null);\n  return this;\n};\n\nDataviz.prototype.update = function(){\n  const library = this.config.library;\n  const type = this.config.type;\n  const element = this.el();\n  if (library && type && element && Dataviz.libraries[library][type].update) {\n    Dataviz.libraries[library][type].update.apply(this, arguments);\n  }\n  return this;\n};\n\nDataviz.prototype.width = function(num){\n  if (this.config.showDeprecationWarnings) {\n    console.log('.width() is deprecated - use CSS classes');\n  }\n  return this;\n};\n\nDataviz.prototype.exportImage = function({ quality = 0, bgcolor = '#fff' } = {}) {\n  exportImage({\n    node: this.config.containerElement,\n    quality,\n    bgcolor,\n  });\n};\n\nDataviz.prototype.exportData = function(type='json') {\n  exportData({\n    data: this.dataset.matrix,\n    type,\n  });\n};\n\n// Deprecations\nDataviz.prototype.chartType = Dataviz.prototype.type;\nDataviz.prototype.error = Dataviz.prototype.message;\nDataviz.prototype.parseRawData = Dataviz.prototype.data;\nDataviz.prototype.parseRequest = function(){\n  // this.emit('error', 'This method is no longer supported. Use .data() instead: https://github.com/keen/keen-dataviz.js#data');\n  return this;\n};\nDataviz.prototype.initialize = function(){\n  // this.emit('error', 'This method is no longer supported, and can be omitted as it has no impact');\n  return this;\n};\n\nDataviz.version = pkg.version;\n\n// Private\n\nfunction buildDomWrapper(el, options) {\n  let html = '';\n  let chart100percentWide = '';\n  let rangeChart = '';\n  if (options.legend.position === 'top' || options.legend.position === 'bottom') {\n    chart100percentWide = 'c3-chart-100-percent';\n  }\n  if (options.range) {\n    rangeChart = 'keen-dataviz-range';\n  }\n  let container = `<div class=\"c3-chart ${chart100percentWide} ${rangeChart}\"></div>`;\n  const verticalAlignment = ['top', 'middle', 'bottom'];\n  const horizontalAlignment = ['left', 'center', 'right'];\n  let align = 'horizontal';\n  let legendItemsAlign = 'center';\n  if (horizontalAlignment.includes(options.legend.alignment)) {\n    legendItemsAlign = options.legend.alignment;\n  }\n  if (options.legend.position === 'left' || options.legend.position === 'right') {\n    align = 'vertical';\n    if (verticalAlignment.includes(options.legend.alignment)) {\n      legendItemsAlign = options.legend.alignment;\n    }\n  }\n  if (options.legend && options.legend.show) {\n    if (options.legend.position === 'top' || options.legend.position === 'left') {\n      container = `<div class=\"keen-c3-legend keen-c3-legend-${align} keen-c3-legend-${options.legend.position} keen-c3-legend-align-${legendItemsAlign}\"></div>${container}`;\n    } else {\n      container = `${container}<div class=\"keen-c3-legend keen-c3-legend-${align} keen-c3-legend-${options.legend.position} keen-c3-legend-align-${legendItemsAlign}\"></div>`;\n    }\n  }\n  if(!options.react){\n    html += `<div class=\"${options.theme}\">`;\n  }\n  if (options.title && options.showTitle) {\n    html += `<div class=\"keen-dataviz-title ${options.theme}-title\">${options.title}</div>`;\n  }\n  if (options.subtitle) {\n    html += `<div class=\"keen-dataviz-subtitle ${options.theme}-subtitle\">${options.subtitle}</div>`;\n  }\n  html += `<div class=\"keen-dataviz-rendering keen-dataviz-rendering-${align} ${options.theme}-rendering ${options.theme}-rendering-${align}\">${container}</div>`;\n  if (options.notes) {\n    html += `<div class=\"keen-dataviz-notes ${options.theme}-notes\">${options.notes}</div>`;\n  }\n  if(!options.react){\n    html += '</div>';\n  }\n\n  el.innerHTML = html;\n}\n\nfunction convertChartTypes(str) {\n  const map = {\n    areachart: 'area',\n    barchart: 'horizontal-bar',\n    columnchart: 'bar',\n    linechart: 'line',\n    piechart: 'pie',\n  };\n  return map[str] || str;\n}\n\nfunction testDom(fn) {\n  if (/in/.test(document.readyState)) {\n    setTimeout(() => {\n      testDom(fn);\n    }, 9);\n  } else {\n    fn();\n  }\n}\n\nfunction domReady(fn) {\n  if (typeof document !== 'undefined' || typeof window === 'undefined') {\n    fn();\n    return;\n  }\n  // Firefox 3.5 shim\n  if (document.readyState == null && document.addEventListener) {\n    document.addEventListener('DOMContentLoaded', function DOMContentLoaded() {\n      document.removeEventListener('DOMContentLoaded', DOMContentLoaded, false);\n      document.readyState = 'complete';\n    }, false);\n    document.readyState = 'loading';\n  }\n  testDom(fn);\n}\n\nexport { Dataset } from './dataset';\n\nexport default Dataviz;\n","import { each } from '../../utils/each';\n\nexport function deleteColumn(q) {\n  const self = this;\n  const index = (typeof q === 'number') ? q : this.matrix[0].indexOf(q);\n\n  if (index > -1) {\n    each(self.matrix, function(row, i){\n      self.matrix[i].splice(index, 1);\n    });\n  }\n  return self;\n}\n\nexport function deleteRow(q) {\n  var index = (typeof q === 'number') ? q : this.selectColumn(0).indexOf(q);\n\n  if (index > -1) {\n    this.matrix.splice(index, 1);\n  }\n  return this;\n}\n","import { each } from '../../utils/each';\n\nexport function filterColumns(fn) {\n  const self = this;\n  const clone = [];\n\n  each(self.matrix, function(row, i) {\n    clone.push([]);\n  });\n\n  each(self.matrix[0], function(col, i){\n    var selectedColumn = self.selectColumn(i);\n    if (i == 0 || fn.call(self, selectedColumn, i)) {\n      each(selectedColumn, function(cell, ri){\n        clone[ri].push(cell);\n      });\n    }\n  });\n\n  self.data(clone);\n  return self;\n}\n\nexport function filterRows(fn) {\n  const self = this;\n  const clone = [];\n\n  each(self.matrix, function(row, i){\n    if (i == 0 || fn.call(self, row, i)) {\n      clone.push(row);\n    }\n  });\n\n  self.data(clone);\n  return self;\n}\n","import { each } from '../../utils/each';\nimport createNullList from '../utils/create-null-list';\nimport { appendRow, appendColumn } from './append';\n\nexport function insertColumn(index, str, input) {\n  const self = this;\n  const label = (str !== undefined) ? str : null;\n\n  if (typeof input === 'function') {\n\n    self.matrix[0].splice(index, 0, label);\n    each(self.matrix, function(row, i) {\n      var cell;\n      if (i > 0) {\n        cell = input.call(self, row, i);\n        if (typeof cell === 'undefined') {\n          cell = null;\n        }\n        self.matrix[i].splice(index, 0, cell);\n      }\n    });\n\n  }\n\n  else if (!input || input instanceof Array) {\n    input = input || [];\n\n    if (input.length <= self.matrix.length - 1) {\n      input = input.concat( createNullList(self.matrix.length - 1 - input.length) );\n    }\n    else {\n      // If this new column is longer than existing columns,\n      // we need to update the rest to match ...\n      each(input, function(value, i){\n        if (self.matrix.length -1 < input.length) {\n          appendRow.call(self, String( self.matrix.length ));\n        }\n      });\n    }\n\n    self.matrix[0].splice(index, 0, label);\n    each(input, function(value, i){\n      self.matrix[i+1].splice(index, 0, value);\n    });\n\n  }\n  return self;\n}\n\nexport function insertRow(index, str, input) {\n  const self = this;\n  const newRow = [];\n  const label = (str !== undefined) ? str : null;\n  newRow.push(label);\n\n  if (typeof input === 'function') {\n    each(self.matrix[0], function(label, i) {\n      let col;\n      let cell;\n      if (i > 0) {\n        col = self.selectColumn(i);\n        cell = input.call(self, col, i);\n        if (typeof cell === 'undefined') {\n          cell = null;\n        }\n        newRow.push(cell);\n      }\n    });\n    self.matrix.splice(index, 0, newRow);\n  }\n\n  else if (!input || input instanceof Array) {\n    input = input || [];\n\n    if (input.length <= self.matrix[0].length - 1) {\n      input = input.concat( createNullList( self.matrix[0].length - 1 - input.length ) );\n    }\n    else {\n      each(input, function(value, i){\n        if (self.matrix[0].length -1 < input.length) {\n          appendColumn.call(self, String( self.matrix[0].length ));\n        }\n      });\n    }\n\n    self.matrix.splice(index, 0, newRow.concat(input) );\n  }\n\n  return self;\n}\n","import { each } from '../../utils/each';\n\nexport function selectColumn(q) {\n  const result = [];\n  const index = (typeof q === 'number') ? q : this.matrix[0].indexOf(q);\n\n  if (index > -1 && typeof this.matrix[0][index] !== 'undefined') {\n    each(this.matrix, function(row, i) {\n      result.push(row[index]);\n    });\n  }\n  return result;\n}\n\nexport function selectRow(q) {\n  let result = [];\n  const index = (typeof q === 'number') ? q : this.selectColumn(0).indexOf(q);\n\n  if (index > -1 && typeof this.matrix[index] !== 'undefined') {\n    result = this.matrix[index];\n  }\n  return result;\n}\n","import { each } from '../../utils/each';\nimport analysesUtilMethods from '../utils/analyses';\n\nexport function sortColumns(str, comp) {\n  var self = this,\n      head = this.matrix[0].slice(1), // minus index\n      cols = [],\n      clone = [],\n      fn = comp || analysesUtilMethods.getColumnLabel;\n\n  // Isolate each column (except the index)\n  each(head, function(cell, i) {\n    cols.push(self.selectColumn(i+1).slice(0));\n  });\n  cols.sort(function(a,b){\n    // If fn(a) > fn(b)\n    var op = fn.call(self, a) > fn.call(self, b);\n    if (op) {\n      return (str === 'asc' ? 1 : -1);\n    } else if (!op) {\n      return (str === 'asc' ? -1 : 1);\n    } else {\n      return 0;\n    }\n  });\n  each(cols, function(col, i) {\n    self\n      .deleteColumn(i+1)\n      .insertColumn(i+1, col[0], col.slice(1));\n  });\n  return self;\n}\n\nexport function sortRows(str, comp) {\n  var self = this,\n      head = this.matrix.slice(0,1),\n      body = this.matrix.slice(1),\n      fn = comp || analysesUtilMethods.getRowIndex;\n  body.sort(function(a, b){\n    // If fn(a) > fn(b)\n    var op = fn.call(self, a) > fn.call(self, b);\n    if (op) {\n      return (str === 'asc' ? 1 : -1);\n    } else if (!op) {\n      return (str === 'asc' ? -1 : 1);\n    } else {\n      return 0;\n    }\n  });\n  self.data(head.concat(body));\n  return self;\n}\n","import { each } from '../../utils/each';\nimport createNullList from '../utils/create-null-list';\nimport { appendRow, appendColumn } from './append';\n\nexport function updateColumn(q, input) {\n  var self = this,\n      index = (typeof q === 'number') ? q : this.matrix[0].indexOf(q);\n\n  if (index > -1) {\n\n    if (typeof input === 'function') {\n\n      each(self.data(), function(row, i){\n        var cell;\n        if (i > 0) {\n          cell = input.call(self, row[index], i, row);\n          if (typeof cell !== 'undefined') {\n            self.matrix[i][index] = cell;\n          }\n        }\n      });\n\n    } else if (!input || input instanceof Array) {\n      input = input || [];\n\n      if (input.length <= self.data().length - 1) {\n        input = input.concat( createNullList(self.data().length - 1 - input.length) );\n      }\n      else {\n        // If this new column is longer than existing columns,\n        // we need to update the rest to match ...\n        each(input, function(value, i){\n          if (self.matrix.length -1 < input.length) {\n            appendRow.call(self, String( self.matrix.length ));\n          }\n        });\n      }\n\n      each(input, function(value, i){\n        self.matrix[i+1][index] = value;\n      });\n\n    }\n\n  }\n  return self;\n}\n\nexport function updateRow(q, input){\n  var self = this,\n      index = (typeof q === 'number') ? q : this.selectColumn(0).indexOf(q);\n\n  if (index > -1) {\n\n    if (typeof input === 'function') {\n\n      each(self.data()[index], function(value, i){\n        var col = self.selectColumn(i),\n        cell = input.call(self, value, i, col);\n        if (typeof cell !== 'undefined') {\n          self.matrix[index][i] = cell;\n        }\n      });\n\n    } else if (!input || input instanceof Array) {\n      input = input || [];\n\n      if (input.length <= self.matrix[0].length - 1) {\n        input = input.concat( createNullList( self.matrix[0].length - 1 - input.length ) );\n      }\n      else {\n        each(input, function(value, i){\n          if (self.matrix[0].length -1 < input.length) {\n            appendColumn.call(self, String( self.matrix[0].length ));\n          }\n        });\n      }\n\n      each(input, function(value, i){\n        self.matrix[index][i+1] = value;\n      });\n    }\n\n  }\n  return self;\n}\n","let Dataset; /* injected */\n\nimport { each } from '../../utils/each';\nimport { flatten } from '../utils/flatten';\nimport { valueAtDeepKey } from '../utils/object';\n\nexport default function initialize(lib){\n  Dataset = lib;\n  return function(name){\n    var options = Array.prototype.slice.call(arguments, 1);\n\n    if (!parsers[name]) {\n      throw 'Requested parser does not exist';\n    }\n    else {\n      return parsers[name].apply(this, options);\n    }\n  };\n}\n\nfunction parseMetric(){\n  return function(res){\n    return new Dataset()\n      .set(['Value', 'Result'], res.result)\n      .type('metric');\n  }\n}\n\n//var myParser = Dataset.parser('interval', 'timeframe.end');\nfunction parseInterval(){\n  var options = Array.prototype.slice.call(arguments);\n  return function(res){\n    var dataset = new Dataset()\n      .type('interval');\n    each(res.result, function(record, i){\n      var index = options[0] && options[0] === 'timeframe.end' ? record.timeframe.end : record.timeframe.start;\n      dataset.set(['Result', index], record.value);\n    });\n    return dataset;\n  }\n}\n\nfunction parseGroupedMetric(){\n  return function(res){\n    var dataset = new Dataset()\n      .type('grouped-metric');\n    each(res.result, function(record, i){\n      var label;\n      each(record, function(value, key){\n        if (key !== 'result') {\n          label = key;\n        }\n      });\n      dataset.set(['Result', String(record[label])], record.result);\n    });\n    return dataset;\n  }\n}\n\n//var myParser = Dataset.parser('grouped-interval', 'timeframe.end');\nfunction parseGroupedInterval(){\n  var options = Array.prototype.slice.call(arguments);\n  return function(res){\n    var dataset = new Dataset()\n      .type('grouped-interval');\n    each(res.result, function(record, i){\n      var index = options[0] && options[0] === 'timeframe.end' ? record.timeframe.end : record.timeframe.start;\n      if (record.value.length) {\n        each(record.value, function(group, j){\n          var label;\n          each(group, function(value, key){\n            if (key !== 'result') {\n              label = key;\n            }\n          });\n          dataset.set([ String(group[label]), index ], group.result);\n        });\n      }\n      else {\n        dataset.appendRow(index);\n      }\n    });\n    return dataset;\n  }\n}\n\n//var myParser = Dataset.parser('double-grouped-metric', ['first', 'second']);\nfunction parseDoubleGroupedMetric(){\n  var options = Array.prototype.slice.call(arguments);\n  if (!options[0]) throw 'Requested parser requires a sequential list (array) of properties to target as a second argument';\n  return function(res){\n    var dataset = new Dataset()\n      .type('double-grouped-metric');\n    each(res.result, function(record, i){\n      var rowLabel = record[options[0][0]] + ' ' + record[options[0][1]];\n      dataset.set([ 'Result', rowLabel ], record.result);\n    });\n    return dataset;\n  }\n}\n\n//var myParser = Dataset.parser('double-grouped-interval', ['first', 'second'], 'timeframe.end');\nfunction parseDoubleGroupedInterval(){\n  var options = Array.prototype.slice.call(arguments);\n  if (!options[0]) throw 'Requested parser requires a sequential list (array) of properties to target as a second argument';\n  return function(res){\n    var dataset = new Dataset()\n      .type('double-grouped-interval');\n    each(res.result, function(record, i){\n      var index = options[1] && options[1] === 'timeframe.end' ? record.timeframe.end : record.timeframe.start;\n      each(record['value'], function(value, j){\n        var label = value[options[0][0]] + ' ' + value[options[0][1]];\n        dataset.set([ label, index ], value.result);\n      });\n    });\n    return dataset;\n  }\n}\n\nfunction parseFunnel(){\n  return function(res){\n    var result, steps, dataset;\n    if (typeof res.steps !== 'undefined'\n        && typeof res.result !== 'undefined'\n          && res.result instanceof Array) {\n            // Ad-hoc funnel response\n            result = res.result;\n            steps = res.steps;\n    }\n    else if (typeof res.result.steps !== 'undefined'\n        && typeof res.result.result !== 'undefined'\n          && res.result.result instanceof Array) {\n            // Saved funnel response\n            result = res.result.result;\n            steps = res.result.steps;\n    }\n    dataset = new Dataset().type('funnel');\n    dataset.appendColumn('Step Value');\n    each(result, function(value, i){\n      if (typeof steps !== 'undefined' && steps[i]) {\n        dataset.appendRow(String(steps[i].event_collection), [value]);\n      }\n    });\n    return dataset;\n  }\n}\n\nfunction parseList(){\n  return function(res){\n    var dataset = new Dataset()\n      .type('list');\n    each(res.result, function(value, i){\n      dataset.set( [ 'Result', String(i+1) ], value );\n    });\n    return dataset;\n  }\n}\n\nfunction parseExtraction(){\n  let config = this.config;\n  return function(res){\n    const datasetExtraction = new Dataset()\n      .type('extraction');\n\n    // get keys of the Object, static schema\n    let names = Object.keys(flatten(res.result[0]));\n\n    const tableConfig = config && config.table;\n    if (tableConfig && tableConfig.schema === 'dynamic') {\n      const results = res.result;\n      const keys = {};\n      results.forEach(resultItem => {\n        const resultKeys = Object.keys(flatten(resultItem));\n        if (resultKeys && resultKeys.length) {\n          resultKeys.forEach(keyName => {\n            if (!keys[keyName]) {\n              keys[keyName] = true;\n            }\n          });\n        }\n      });\n      names = Object.keys(keys);\n    }\n    \n    let nameI = 0;\n    names.forEach(value => {\n      datasetExtraction.set([ value, '0' ], value);\n      nameI++;\n    });\n    \n    if (Dataset) {\n      if (config\n        && config.table\n        && config.table.columns) {\n        names = config.table.columns;\n      }\n    }\n\n    for (let i=0; i<res.result.length; i++){\n      let record = [i+1];\n      for (let iNames=0; iNames<names.length; iNames++){\n        record.push(valueAtDeepKey(res.result[i], names[iNames]));\n      }\n      datasetExtraction.matrix[String(i+1)] = record;\n    }\n\n    datasetExtraction.deleteColumn(0);\n\n    return datasetExtraction;\n  }\n}\n\nfunction parseHeatmapAxis() {\n  return function(res) {\n    const heatmapDataset = new Dataset()\n      .type('heatmap');\n    \n    each(res.result, function(value, i){\n      const objKeys = Object.keys(value);\n      const x = value[objKeys[0]];\n      const y = value[objKeys[1]];\n      heatmapDataset.appendRow([ String(x), String(y), value.result]);\n    });\n    return heatmapDataset;\n  }\n}\n\n// Parser definitions\nconst parsers = {\n  metric: parseMetric,\n  interval: parseInterval,\n  'grouped-metric': parseGroupedMetric,\n  'grouped-interval': parseGroupedInterval,\n  'double-grouped-metric': parseDoubleGroupedMetric,\n  'double-grouped-interval': parseDoubleGroupedInterval,\n  funnel: parseFunnel,\n  list: parseList,\n  extraction: parseExtraction,\n  'heatmap-axis': parseHeatmapAxis,\n};\n","// Pure awesomeness by Will Rayner (penguinboy)\n// https://gist.github.com/penguinboy/762197\n\nexport function flatten(ob){\n  var toReturn = {};\n  for (var i in ob) {\n    if (!ob.hasOwnProperty(i)) continue;\n    if ((typeof ob[i]) == 'object' && ob[i] !== null) {\n      var flatObject = flatten(ob[i]);\n      for (var x in flatObject) {\n        if (!flatObject.hasOwnProperty(x)) continue;\n        toReturn[i + '.' + x] = flatObject[x];\n      }\n    } else {\n      toReturn[i] = ob[i];\n    }\n  }\n  return toReturn;\n};\n","export function valueAtDeepKey(obj, is, value) {\n  if (typeof is == 'string')\n    return valueAtDeepKey(obj, is.split('.'), value);\n  else if (is.length==1 && value!==undefined && obj !== null &&\n    typeof obj[is[0]] !== 'undefined')\n    return obj[is[0]] = value;\n  else if (is.length==0)\n    return obj;\n  else if (typeof is === 'undefined' || typeof obj === 'undefined'\n    || is === null || obj === null\n    || typeof obj[is[0]] === 'undefined')\n    return null;\n  else\n    return valueAtDeepKey(obj[is[0]], is.slice(1), value);\n}\n","import Dataset from './dataset';\nimport { extend } from './utils/extend';\nimport { stripHtmlTags } from './utils/strip-html-tags';\n\nexport default function (data) {\n  if (!arguments.length) return this.dataset.data();\n  if (data instanceof Dataset) {\n    this.dataset = data;\n    return this;\n  }\n    return parseResponse.call(this, data);\n};\n\nfunction parseResponse(response) {\n  var dataset,\n      indexBy,\n      meta,\n      parser,\n      parserArgs = [],\n      query,\n      selectedParser,\n      title,\n      type;\n\n  indexBy = this.config.indexBy;\n  meta = response.metadata || {};\n  query = (typeof response.query !== 'undefined') ? response.query : {};\n\n  // Ensure all required params are present\n  query = extend({\n    analysis_type: null,\n    event_collection: null,\n    filters: [],\n    group_by: null,\n    interval: null,\n    timeframe: null,\n    timezone: null\n  }, query);\n\n  if (query.analysis_type === 'funnel') {\n    parser = 'funnel';\n  }\n  else if (query.analysis_type === 'extraction'){\n    parser = 'extraction';\n  }\n  else if (query.analysis_type === 'select_unique') {\n    if (!query.group_by && !query.interval) {\n      parser = 'list';\n    }\n    // else { Not supported }\n  }\n  else if (query.analysis_type) {\n    if (!query.group_by && !query.interval) {\n      parser = 'metric';\n    }\n    else if (query.group_by && !query.interval) {\n      if (query.group_by instanceof Array && query.group_by.length > 1) {\n        parser = 'double-grouped-metric';\n        parserArgs.push(query.group_by);\n      }\n      else {\n        parser = 'grouped-metric';\n      }\n    }\n    else if (query.interval && !query.group_by) {\n      parser = 'interval';\n      parserArgs.push(indexBy);\n    }\n    else if (query.group_by && query.interval) {\n      if (query.group_by instanceof Array && query.group_by.length > 1) {\n        parser = 'double-grouped-interval';\n        parserArgs.push(query.group_by);\n        parserArgs.push(indexBy);\n      }\n      else {\n        parser = 'grouped-interval';\n        parserArgs.push(indexBy);\n      }\n    }\n  }\n\n  if (!parser) {\n\n    // Metric\n    // -------------------------------\n    if (typeof response.result === 'number'){\n      parser = 'metric';\n    }\n\n    // Everything else\n    // -------------------------------\n    if (response.result instanceof Array && response.result.length > 0){\n\n      // Interval w/ single value\n      // -------------------------------\n      if (response.result[0].timeframe && (typeof response.result[0].value == 'number' || response.result[0].value == null)) {\n        parser = 'interval';\n        parserArgs.push(indexBy)\n      }\n\n      // Static GroupBy\n      // -------------------------------\n      if (typeof response.result[0].result == 'number'){\n        parser = 'grouped-metric';\n      }\n\n      // x, y, value for heatmap\n      if (this.config.type === 'heatmap' && Object.keys(response.result[0] === 3 && typeof response.result[0].result === 'number')) {\n        parser = 'heatmap-axis';\n      }\n\n      // Grouped Interval\n      // -------------------------------\n      if (response.result[0].value instanceof Array){\n        parser = 'grouped-interval';\n        parserArgs.push(indexBy)\n      }\n\n      // Funnel\n      // -------------------------------\n      if (typeof response.result[0] === 'number'\n        && typeof response.steps !== 'undefined'){\n          parser = 'funnel';\n          // Move steps into query object\n          query.steps = response.steps;\n      }\n\n      // Select Unique\n      // -------------------------------\n      if ((typeof response.result[0] === 'string' || typeof response.result[0] == 'number') && typeof response.steps === 'undefined'){\n        parser = 'list';\n      }\n\n      // Extraction\n      // -------------------------------\n      if (!parser) {\n        parser = 'extraction';\n      }\n    }\n\n    if (!parser) {\n      parser = 'extraction';\n    }\n  }\n\n  // Set title from saved query body, or create a default title\n  if (this.config.title === undefined) {\n    if (meta.display_name) {\n      title = meta.display_name;\n    }\n    else {\n      title = getDefaultTitle(query);\n    }\n    this.config.title = title;\n  }\n\n  // Set type from saved query body, or use a default type\n  if (!this.config.type) {\n    if (meta.visualization && meta.visualization.chart_type) {\n      type = meta.visualization.chart_type;\n    }\n    else {\n      type = getDefaultType(parser);\n    }\n    this.config.type = type;\n  }\n\n  // Define the appropriate parser\n  selectedParser = Dataset.parser.apply(this, [parser].concat(parserArgs));\n\n  // Parse the response with augmented query body\n  dataset = selectedParser(extend(response, { 'query': query }));\n\n  // Set true dates for 'interval' data\n  if (parser.indexOf('interval') > -1) {\n    dataset.updateColumn(0, function(value, i){\n      return new Date(value);\n    });\n  }\n\n  dataset.updateRow(0, function(value, i){\n    return stripHtmlTags(value);\n  });\n\n  this.dataset = dataset;\n\n  if (response.execution_metadata) {\n    this.execution_metadata = response.execution_metadata;\n  }\n\n  return this;\n}\n\nfunction getDefaultTitle(query) {\n  var analysis = query.analysis_type ? query.analysis_type.replace('_', ' ') : '',\n      title;\n\n  title = analysis.replace( /\\b./g, function(a){\n    return a.toUpperCase();\n  });\n\n  if (query.event_collection) {\n    title += ' - ' + query.event_collection;\n  }\n  return title;\n}\n\nfunction getDefaultType(parser) {\n  let type;\n  switch (parser) {\n    case 'metric':\n      type = 'metric';\n      break;\n    case 'interval':\n      type = 'area';\n      break;\n    case 'grouped-metric':\n    case 'double-grouped-metric':\n      type = 'bar';\n      break;\n    case 'grouped-interval':\n    case 'double-grouped-interval':\n      type = 'line';\n      break;\n    case 'funnel':\n      type = 'horizontal-bar';\n      break;\n    case 'list':\n    case 'extraction':\n    default:\n      type = 'table';\n  }\n  return type;\n}\n","import c3 from 'c3';\n\nimport { each } from '../utils/each';\nimport { extend } from '../utils/extend';\nimport { extendDeep } from '../utils/extend-deep';\nimport isDateString from '../utils/assert-date-string';\nimport c3DefaultDateFormat from './c3/extensions/default-date-format';\nimport c3PaginatingLegend from './c3/extensions/paginating-legend';\nimport c3TooltipContents from './c3/extensions/tooltip-contents';\n\nimport calculateRange from '../dataset/utils/calculate-range';\nimport { calculateSumForPercents, calculatePercents } from '../dataset/utils/calculate-percents';\n\nimport message from './default/message';\nimport metric from './default/metric';\nimport table from './default/table';\nimport spinner from './default/spinner';\nimport Funnel from './default/funnel';\nimport Funnel3d from './default/funnel-3d';\nimport HorizontalFunnel from './default/horizontal-funnel';\nimport HorizontalFunnel3d from './default/horizontal-funnel-3d';\nimport MetricCombo from './default/metric-combo';\nimport Heatmap from './default/heatmap';\nimport Choropleth from './default/choropleth';\n\nexport default function(lib) {\n  let timer;\n  bindResizeListener(function(){\n    if (timer) {\n      clearTimeout(timer);\n    }\n    const delay = (lib.visuals.length > 12) ? 1000 : 250;\n    timer = setTimeout(function(){\n      each(lib.visuals, function(chart){\n        const c3Chart = chart.view._artifacts.c3;\n        if (c3Chart) {\n          const parentWidth = c3Chart.element.parentNode.parentNode.offsetWidth;\n          let width = parentWidth;\n          if (chart.config.legend && chart.config.legend.show && (chart.config.legend.position === 'left' || chart.config.legend.position === 'right')) {\n            const nextSiblingWidth = c3Chart.element.nextSibling ? c3Chart.element.nextSibling.offsetWidth : 0;\n            const prevSiblingWidth = c3Chart.element.previousSibling ? c3Chart.element.previousSibling.offsetWidth : 0;\n            width = parentWidth - prevSiblingWidth - nextSiblingWidth;\n          }\n\n          c3Chart.resize({\n            width,\n          });\n\n        }\n      });\n    }, delay);\n  });\n\n  return defineC3();\n};\n\nfunction defineC3(){\n  const types = {\n    message,\n    metric,\n    table,\n    spinner,\n    'funnel': new Funnel,\n    'funnel-3d': new Funnel3d,\n    'horizontal-funnel': new HorizontalFunnel,\n    'horizontal-funnel-3d': new HorizontalFunnel3d,\n    'metric-combo': new MetricCombo,\n    'heatmap': new Heatmap,\n    'choropleth': new Choropleth\n  };\n\n  const c3Types = [\n    // Standard types\n    'area',\n    'area-spline',\n    'area-step',\n    'bar',\n    'donut',\n    'gauge',\n    'line',\n    'pie',\n    'step',\n    'spline',\n\n    // Horizontal variant types\n    'horizontal-area',\n    'horizontal-area-spline',\n    'horizontal-area-step',\n    'horizontal-bar',\n    'horizontal-line',\n    'horizontal-step',\n    'horizontal-spline',\n  ];\n\n  const getPaddings = (element, paddingName) => {\n    return parseInt(window.getComputedStyle(element)[`padding${paddingName}`].replace('px', ''));\n  }\n\n  function getDefaultOptions(){\n    const ENFORCED_OPTIONS = {\n      bindto: this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'),\n      color: {\n        pattern: this.config.colors\n      },\n      data: {\n        colors: { ...this.config.colorMapping },\n        columns: [],\n        type: this.config.type.replace('horizontal-', '')\n      },\n    };\n\n    const renderingElement = this.el();\n\n    let height = renderingElement.offsetHeight;\n\n    height -= (getPaddings(renderingElement, 'Top') + getPaddings(renderingElement, 'Bottom'));\n\n    if (this.config.showTitle) {\n      const titleElement = this.el().querySelector('.keen-dataviz-title');\n      if (titleElement) {\n        height -= titleElement.offsetHeight;\n      } else {\n        height -= parseInt(\n          window\n            .getComputedStyle(this.el(), null)\n            ['font-size'].replace('px','')\n          );\n      }\n    }\n\n    if (this.config.subtitle) {\n      const subtitleElement = this.el().querySelector('.keen-dataviz-subtitle');\n      if (subtitleElement) {\n        height -= subtitleElement.offsetHeight;\n      } else {\n        height -= parseInt(\n          window\n            .getComputedStyle(this.el(), null)\n            ['font-size'].replace('px','')\n          );\n      }\n    }\n\n    if (this.config.notes) {\n      const notesElement = this.el().querySelector('.keen-dataviz-notes');\n      if (notesElement) {\n        height -= notesElement.offsetHeight;\n      } else {\n        height -= parseInt(\n          window\n            .getComputedStyle(this.el(), null)\n            ['font-size'].replace('px','')\n          );\n      }\n    }\n\n    let width = this.el().querySelector('.c3-chart').offsetWidth\n      - (getPaddings(renderingElement, 'Left') + getPaddings(renderingElement, 'Right'));\n    if (width < 0) {\n      width = 0;\n    }\n\n    const DEFAULT_OPTIONS = {\n      size: {\n        width,\n        height:\n          height > 0 ?\n            height\n            : undefined,\n      }\n    };\n\n    const extendedConfig = extendDeep({}, DEFAULT_OPTIONS, this.config, ENFORCED_OPTIONS);\n\n    return extendedConfig;\n  }\n\n  each(c3Types, function(type, index) {\n    types[type] = {\n      render: function(){\n        const options = getDefaultOptions.call(this);\n\n        // 100% for charts\n        const sumArray = calculateSumForPercents(this.dataset.matrix);\n        let oldMatrix = [];\n        if (options.stacking === 'percent' && (type === 'bar' || type === 'horizontal-bar' || type === 'area' || type === 'area-step' || type === 'area-spline')) {\n          oldMatrix = this.dataset.matrix;\n          this.dataset.matrix = [this.dataset.matrix[0], ...calculatePercents(this.dataset.matrix, sumArray)];\n          if(!options.sparkline){\n            options.axis = {\n              y: {\n                padding: {\n                  top: 0,\n                },\n                tick: {\n                  format: d => `${d}%`,\n                },\n              },\n            };\n          }\n        }\n\n        // range charts\n        if (options.range) {\n          this.dataset.matrix = [this.dataset.matrix[0], ...calculateRange(this.dataset.matrix)];\n        }\n\n        if (!!this.config.clearOnRender && options.data.columns.length && this.dataset && this.dataset.meta) {\n          const datasetMeta = this.dataset.meta || {};\n          const { type = '' } = datasetMeta;\n          let spliceFrom = 0;\n          const intervalTypes = ['interval'];\n          if (intervalTypes.includes(type)) {\n            spliceFrom = 1;\n          }\n          options.data.columns.splice(spliceFrom);\n        }\n\n        if (this.data()[0].length === 1 || this.data().length === 1) {\n          const msg = 'No data to display';\n          const mappedMsg = this.config.errorMapping[msg] || msg;\n          if (this.config.showErrorMessages) {\n            this.message(mappedMsg);\n          }\n          return;\n        }\n\n        let removeLegend = false;\n\n        if (type === 'gauge') {\n          // Accommodate a neat bug:\n          options.legend.show = false;\n          options.data.columns = [[\n            this.config.title || this.data()[1][0],\n            this.data()[1][1]\n          ]];\n          removeLegend = true;\n        }\n        else if (type === 'pie' || type === 'donut') {\n          options.data.columns = this.data().slice(1);\n        }\n        else {\n\n          // Apply formatting for horizontal variant types\n          if (type.indexOf('horizontal-') > -1) {\n            options.axis.rotated = type.indexOf('horizontal-') > -1;\n          }\n\n          if (isDateString(this.data()[1][0])) {\n            // TIMESERIES\n            options.axis.x = options.axis.x || {};\n            options.axis.x.type = 'timeseries';\n            options.axis.x.tick = options.axis.x.tick || {\n              format: this.config.dateFormat || c3DefaultDateFormat(this.data()[1][0], this.data()[2] ? this.data()[2][0] : this.data()[1][0]),\n              culling: { max: 5 }\n            };\n\n            options.data.columns[0] = [];\n            each(this.dataset.selectColumn(0), function(cell, i){\n              if (i > 0) {\n                cell = new Date(cell);\n              }\n              options.data.columns[0][i] = cell;\n            });\n            options.data.columns[0][0] = 'x';\n            options.data.x = 'x';\n            if (this.config.stacked && this.data()[0].length > 2) {\n              options.data.groups = [ this.dataset.selectRow(0).slice(1) ];\n            }\n          }\n          else {\n            // CATEGORIES\n            options.axis.x = options.axis.x || {};\n            options.axis.x.type = 'category';\n            options.axis.x.categories = this.dataset.selectColumn(0).slice(1);\n            if (this.config.stacked && this.data()[0].length > 2) {\n              options.data.groups = [ this.dataset.selectRow(0).slice(1) ];\n            }\n          }\n\n          if (this.data()[0].length === 2) {\n            options.legend.show = false;\n            removeLegend = true;\n          }\n\n          each(this.data()[0], function(cell, i){\n            if (i > 0) {\n              options.data.columns.push(this.dataset.selectColumn(i));\n            }\n          }.bind(this));\n        }\n\n        if (removeLegend){\n          const legendElement = this.el().querySelector('.keen-c3-legend');\n          if (legendElement) {\n            legendElement.remove();\n            options.size.width = this.el().querySelector('.c3-chart').offsetWidth;\n          }\n          options.legend.show = false;\n        }\n\n        const chartTypesWithPartialIntervalIndicator = ['area', 'area-spline', 'area-step', 'line', 'spline', 'step'];\n\n        if (options.partialIntervalIndicator\n          && options.partialIntervalIndicator.show\n          && chartTypesWithPartialIntervalIndicator.indexOf(options.type) > -1\n        ) {\n          const results = options.data.columns && options.data.columns[0];\n          if (results && results.length > 1) {\n            const partialResultsRegion = {\n              axis: 'x',\n              start: new Date(results[results.length - 2]),\n              class: options.partialIntervalIndicator.className\n            };\n            options.regions = [...(options.regions || []), partialResultsRegion];\n          }\n        }\n        \n        if (\n          !(options.tooltip && options.tooltip.show === false)\n          &&\n          (options.legend.show === true ||\n          (options.legend\n            && options.legend.tooltip\n            && options.legend.tooltip.show)\n          )) {\n            \n          // Apply custom tooltip\n          options.tooltip = {\n            contents: c3TooltipContents,\n            format: {\n              title: this.config.tooltip.format.title,\n              value: (value, ratio, id, index) => {\n                let valueFormatted = c3CustomTooltipFiltering.call(this, value, ratio, id, index);\n                if (this.config.tooltip && this.config.tooltip.format && this.config.tooltip.format.value)\n                {\n                  valueFormatted = this.config.tooltip.format.value.call(this, valueFormatted, ratio, id, index);\n                  // Restore value from percents calculation for stacking 100% charts\n                  if (options.stacking === 'percent' && (type === 'bar' || type === 'horizontal-bar' || type === 'area' \n                  || type === 'area-step' || type === 'area-spline')) {\n                    valueFormatted = parseFloat(((valueFormatted / 100) * sumArray[index]).toFixed(2));\n                  }\n                  // Restore value from range calculation for range charts\n                  if (options.range) {\n                    if(id === 'Max'){\n                      valueFormatted += this.dataset.matrix[index+1][2];\n                    }\n                  }\n                  return valueFormatted;\n                }\n                // Restore value from percents calculation for stacking 100% charts\n                if (options.stacking === 'percent' && (type === 'bar' || type === 'horizontal-bar' || type === 'area' \n                || type === 'area-step' || type === 'area-spline')) {\n                  valueFormatted = ((valueFormatted / 100) * sumArray[index]).toFixed(2);\n                  return parseFloat(valueFormatted);\n                }\n                // Restore value from range calculation for range charts\n                if (options.range) {\n                  if(id === 'Max'){\n                    valueFormatted += this.dataset.matrix[index+1][2];\n                  }\n                }\n                return valueFormatted;\n              }\n            }\n          };\n        }\n\n        if (options.legend.show === true) {\n            const c3options = { ...options };\n                // Apply custom color handling\n            c3options.data.color = c3CustomDataMapping.bind(this);\n\n            c3options.legend.hide = true; // hide default c3 legend\n\n            // Render artifacts\n            this.view._artifacts['c3'] = c3.generate(c3options);\n\n            c3PaginatingLegend.call(this, {...options, onLegendRendered: () => {\n              const legendElement = this.el().querySelector('.keen-c3-legend');\n              if (legendElement) {\n                if (\n                    options.legend.position === 'top' ||\n                    options.legend.position === 'bottom'\n                ) {\n                  c3options.size.height -= legendElement.offsetHeight;\n                  this.view._artifacts['c3'].resize({ height: c3options.size.height });\n                } else {\n                  if (c3options.size.width === 0) {\n                    c3options.size.width = this.el().offsetWidth\n                      - getPaddings(this.el(), 'Left')\n                      - getPaddings(this.el(), 'Right');\n                  }\n                  c3options.size.width -= legendElement.offsetWidth;\n                  this.view._artifacts['c3'].resize({ width: c3options.size.width });\n                }\n              }\n            },\n            onPaginated: () => {\n              this.view._artifacts['c3'].flush();\n            }\n          });\n        }\n        else {\n          this.view._artifacts['c3'] = c3.generate(options);\n        }\n\n      },\n      update: function(){\n        // no special update handling\n        this.render();\n      },\n      destroy: function(){\n        if (this.view._artifacts['c3']) {\n          this.view._artifacts['c3'].destroy();\n          this.view._artifacts['c3'] = null;\n        }\n      }\n    };\n  });\n\n  return types;\n}\n\nfunction c3CustomDataMapping(color, d) {\n  const type = this.config.type;\n  if (this.view._artifacts.pagination\n    && type !== 'gauge'\n      /*&& this.type() !== 'pie'\n        && this.type() !== 'donut'*/) {\n          const scope = this.view._artifacts.pagination.labels;\n          if ((d.id && scope.indexOf(d.id) > -1)\n            || (d && !d.id && scope.indexOf(d) > -1)) {\n              return color;\n          }\n          else {\n            if (type === 'donut' || type === 'pie') {\n              return 'rgba(0,0,0,.1)';\n            }\n            else {\n              return 'rgba(0,0,0,.07)';\n            }\n          }\n  }\n  else {\n    return color;\n  }\n}\n\nfunction c3CustomTooltipFiltering(value, ratio, id, index) {\n  const type = this.config.type;\n\n  if (this.view._artifacts.pagination\n    && type !== 'gauge'\n      /*&& this.type() !== 'pie'\n        && this.type() !== 'donut'*/) {\n          const scope = this.view._artifacts.pagination.labels;\n          if (scope.indexOf(id) > -1) {\n            return value;\n          }\n  }\n  else {\n    return value;\n  }\n}\n\nfunction bindResizeListener(fn){\n  if (typeof window === 'undefined') return;\n  window.onresize = window.resize = function(){};\n  if (window.addEventListener) {\n    window.addEventListener('resize', fn, true);\n  }\n  else if (window.attachEvent) {\n    window.attachEvent('onresize', fn);\n  }\n}\n","export default function (startDate, endDate) {\n  const timeDiff = Math.abs(new Date(startDate).getTime() - new Date(endDate).getTime());\n  const months = [\n    'Jan',\n    'Feb',\n    'Mar',\n    'Apr',\n    'May',\n    'June',\n    'July',\n    'Aug',\n    'Sept',\n    'Oct',\n    'Nov',\n    'Dec'\n  ];\n\n  // Yearly (31536000000) + Monthly\n  if (timeDiff >= 2419200000) {\n    return function(ms){\n      const date = new Date(ms);\n      return months[date.getMonth()] + ' ' + date.getFullYear();\n    };\n  }\n  // Daily\n  else if (timeDiff >= 86400000) {\n    return function(ms){\n      const date = new Date(ms);\n      return months[date.getMonth()] + ' ' + date.getDate();\n    };\n  }\n  // Hourly\n  else if (timeDiff >= 3600000) {\n    return '%I:%M %p';\n  }\n  // Minutely\n  else {\n    return '%I:%M:%S %p';\n  }\n}\n","import * as d3 from 'd3';\n\nimport isDateString from '../../../utils/assert-date-string';\n\nexport default function (options) {\n  const cols = options.data.columns;\n  const datavizInstance = this;\n  const chart = this.view._artifacts.c3;\n  let columns = [];\n  const domNode = this.el().querySelector('.' + datavizInstance.config.theme + '-rendering');\n  const legendConfig = datavizInstance.config.legend;\n\n  const pagination = this.view._artifacts.pagination = {\n    ...{\n      hidden: [],\n      labels: [],\n      offset: 0,\n      limit: Math.round((domNode.offsetHeight - 78) / 20),\n      total: 0\n    },\n    ...legendConfig.pagination\n  };\n\n  if (options.legend.sort) {\n    columns = options.legend.sort(cols);\n\n    // update column order in the data, so tooltip will be the same order\n    const columnsSorted = [];\n    const dataColumnsSorted = [];\n    if (cols[0][0] === 'x') {\n      dataColumnsSorted.push(cols[0]);\n    }\n    columns.forEach(column => {\n      let columnData = options.data.columns.find(item => item[0] === column);\n      dataColumnsSorted.push(columnData);\n    });\n    options.data.columns = dataColumnsSorted;\n  } else {\n    for (let i = 0; i < cols.length; i++) {\n      if (cols[i][0] !== 'x' && !isDateString(cols[i][1])) {\n        columns.push(cols[i][0]);\n      }\n    }\n  }\n\n  const legendElement = this.el().querySelector('.keen-c3-legend');\n\n  let align = 'vertical';\n  if (legendConfig.position === 'top' || legendConfig.position === 'bottom') {\n    align = 'horizontal';\n  }\n\n  const paginateHorizontalLeftElement = document.createElement('div');\n  paginateHorizontalLeftElement.setAttribute('class', 'keen-c3-legend-pagination-icons keen-c3-legend-horizontal-pagination-left');\n  if (align === 'horizontal') {\n    legendElement.append(paginateHorizontalLeftElement);\n  }\n\n  const legendItemsElement = document.createElement('div');\n  legendItemsElement.setAttribute('class', `keen-c3-legend-items keen-c3-legend-${align}-items`);\n  legendElement.append(legendItemsElement);\n\n  const paginateVerticalElement = document.createElement('div');\n  paginateVerticalElement.setAttribute('class', 'keen-c3-legend-pagination keen-c3-legend-pagination-icons');\n  if (align === 'vertical') {\n    legendElement.append(paginateVerticalElement);\n  }\n\n  const paginateHorizontalRightElement = document.createElement('div');\n  paginateHorizontalRightElement.setAttribute('class', 'keen-c3-legend-pagination-icons keen-c3-legend-horizontal-pagination-right');\n  if (align === 'horizontal') {\n    legendElement.append(paginateHorizontalRightElement);\n  }\n\n  paginateData();\n\n  function paginateData(){\n    pagination.labels = columns.slice(pagination.offset, pagination.offset + pagination.limit);\n    pagination.total = columns.length;\n    renderLegendComponent.call(datavizInstance, pagination.labels);\n    if (pagination.total > pagination.limit) {\n      renderPaginationComponent.call(datavizInstance);\n    }\n    if (options.onPaginated){\n      options.onPaginated();\n    }\n  }\n\n  function renderLegendComponent(){\n    legendItemsElement.innerHTML = '';\n\n    pagination.labels.forEach(label => {\n      const labelShortened = legendConfig.label.textMaxLength ? label.slice(0, legendConfig.label.textMaxLength - 1) : label;\n      const legendItem = document.createElement(\"div\");\n      legendItem.innerHTML = `<span class='legend-item-text'>${labelShortened}</span>`;\n      legendItem.chartPartId = label;\n      legendItem.setAttribute('class', 'legend-item');\n      legendItemsElement.append(legendItem);\n\n      const legendItemColorSample = document.createElement(\"span\");\n      legendItemColorSample.setAttribute('class', 'legend-item-color-sample');\n      legendItemColorSample.style.backgroundColor = chart.color(legendItem.chartPartId);\n      legendItem.prepend(legendItemColorSample);\n\n      const tooltipElement = document.createElement(\"div\");\n      legendItem.addEventListener('mouseover', (event) => {\n        chart.focus(legendItem.chartPartId);\n        if (legendConfig.tooltip.show && legendItem.chartPartId.length > legendConfig.label.textMaxLength) {\n          tooltipElement.setAttribute('class', `keen-c3-legend-label-overlay keen-c3-legend-position-${legendConfig.position}`);\n          tooltipElement.innerHTML =\n            `${\n              options.legend.tooltip.pointer ? `<div class='overlay-pointer'></div>` : ``\n            }${legendItem.chartPartId}`;\n          legendItem.append(tooltipElement);\n        }\n      });\n      legendItem.addEventListener('mouseout', (event) => {\n        chart.revert();\n        tooltipElement.remove();\n      });\n      legendItem.addEventListener('click', (event) => {\n        let opacity = 1;\n        const isHidden = pagination.hidden.indexOf(legendItem.chartPartId);\n        if (isHidden < 0) {\n          pagination.hidden.push(legendItem.chartPartId);\n          opacity = .35;\n        }\n        else {\n          pagination.hidden.splice(isHidden, 1);\n          opacity = 1;\n        }\n        legendItem.style.opacity = opacity;\n        chart.toggle(legendItem.chartPartId);\n      });\n  });\n\n    if (options.onLegendRendered){\n      options.onLegendRendered();\n      options.onLegendRendered = null;\n    }\n\n  }\n\n  function renderPaginationComponent(){\n    paginateVerticalElement.innerHTML = '';\n    paginateHorizontalLeftElement.innerHTML = '';\n    paginateHorizontalRightElement.innerHTML = '';\n\n    const arrowUp = document.createElement('i');\n    const arrowDown = document.createElement('i');\n\n    const paginate = (direction) => {\n      if (direction === 'forward') {\n        const diff = pagination.offset + pagination.limit;\n        if (diff < pagination.total) {\n          pagination.offset = diff;\n          return;\n        }\n        pagination.offset = 0;\n        return;\n      }\n\n      const diff = pagination.offset - pagination.limit;\n      if (diff >= 0) {\n        pagination.offset = diff;\n        return;\n      }\n\n      pagination.offset = Math.floor(pagination.total/pagination.limit) * pagination.limit;\n    };\n\n    arrowDown.addEventListener('click', () => {\n      paginate('forward');\n      paginateData();\n      clearSelectedText();\n    });\n\n    arrowUp.addEventListener('click', () => {\n      paginate('backward');\n      paginateData();\n      clearSelectedText();\n    });\n\n    if (legendConfig.position === 'left' || legendConfig.position === 'right') {\n      arrowUp.setAttribute('class', 'up');\n      arrowDown.setAttribute('class', 'down');\n      paginateVerticalElement.append(arrowDown);\n      paginateVerticalElement.append(arrowUp);\n    } else {\n      // bottom top\n      arrowUp.setAttribute('class', 'left');\n      arrowDown.setAttribute('class', 'right');\n      paginateHorizontalLeftElement.append(arrowUp);\n      paginateHorizontalRightElement.append(arrowDown);\n    }\n\n  }\n\n  function clearSelectedText() {\n    let selection;\n    if (document.selection && document.selection.empty) {\n      selection = document.selection;\n      selection.empty();\n    }\n    else if (window.getSelection) {\n      selection = window.getSelection();\n      selection.removeAllRanges();\n    }\n  }\n}\n","import { escapeHtml } from '../../../utils/escape-html';\n\nexport default function (d, defaultTitleFormat, defaultValueFormat, color) {\n  let text;\n  let title;\n  // Set config options or defaults\n  const nameFormat = this.config.tooltip_format_name || function (name) { return name; };\n  const titleFormat = this.config.tooltip_format_title || defaultTitleFormat;\n  const valueFormat = this.config.tooltip_format_value || defaultValueFormat;\n\n  // Reverse list to match legend\n  for (let i = 0; i < d.length; i++) {\n    if (! (d[i] && (d[i].value || d[i].value === 0))) { continue; }\n    if (!text) {\n      title = titleFormat ? titleFormat(d[i].x) : d[i].x;\n      text = \"<table class='\" + this.CLASS.tooltip + \"'>\" + (title || title === 0 ? \"<tr><th colspan='2'>\" + escapeHtml(title) + \"</th></tr>\" : \"\");\n    }\n    let name = nameFormat(d[i].name);\n    let value = valueFormat(d[i].value, d[i].ratio, d[i].id, d[i].index);\n    let bgcolor = this.levelColor ? this.levelColor(d[i].value) : color(d[i].id);\n    if (value && !isNaN(value)) {\n      text += \"<tr class='\" + this.CLASS.tooltipName + \"-\" + d[i].id + \"'>\";\n      if (name.indexOf('__tooltip_ignore_name_field__') === -1) {\n        text +=   \"<td class='name'><span style='background-color:\" + bgcolor + \"'></span>\" + escapeHtml(name) + \"</td>\";\n      }\n      text +=   \"<td class='value'>\" + escapeHtml(value) + \"</td>\";\n      text += \"</tr>\";\n    }\n  }\n  return text + \"</table>\";\n}\n","export default function calculateRange(matrix) {\n  const newValues = matrix.slice(1).map(d => d.map((e, i) => {\n    if (typeof e === 'number') {\n      if (i === 1) {\n        return e - d[i + 1];\n      }\n    }\n    return e;\n  }));\n  return newValues;\n}","export function calculateSumForPercents(matrix) {\n  const sumArray = [];\n  matrix.slice(1).forEach((d, i) => {\n    d.forEach((e) => {\n      if (typeof e === 'number') {\n        if (!sumArray[i]) {\n          sumArray[i] = e;\n          return sumArray[i];\n        }\n        sumArray[i] += e;\n      }\n      return sumArray[i];\n    });\n  });\n  return sumArray;\n}\n\nexport function calculatePercents(matrix, sumArray) {\n  const newValues = matrix.slice(1).map((d, i) => d.map((e) => {\n    if (typeof e === 'number') {\n      return (e / sumArray[i]) * 100;\n    }\n    return e;\n  }));\n  return newValues;\n}\n","import { escapeHtml } from '../../utils/escape-html';\nimport renderDownloadButton from '../../utils/render-download-btn';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nexport default {\n  render: function(text){\n    const outer = document.createElement('div');\n    const inner = document.createElement('div');\n    const msg = document.createElement('span');\n\n    const titleContainer = document.createElement('div');\n    const subtitleContainer = document.createElement('div');\n    const notesContainer = document.createElement('div');\n\n    outer.className = this.config.theme + ' keen-dataviz-box';\n    inner.className = this.config.theme + '-message';\n\n    // Create title and notes for message\n    titleContainer.className = this.config.theme + '-title';\n    titleContainer.innerHTML = escapeHtml(this.config.title || '');\n    subtitleContainer.className = this.config.theme + '-subtitle';\n    subtitleContainer.innerHTML = escapeHtml(this.config.subtitle || '');\n    notesContainer.className = this.config.theme + '-notes';\n    notesContainer.innerHTML = escapeHtml(this.config.notes || '');\n\n    msg.innerHTML = escapeHtml(text) || '';\n    inner.appendChild(msg);\n\n    if (this.config.title && this.config.showTitle) {\n      outer.appendChild(titleContainer);\n    }\n\n    if (this.config.subtitle) {\n      outer.appendChild(subtitleContainer);\n    }\n\n    outer.appendChild(inner);\n\n    if (this.config.notes) {\n      outer.appendChild(notesContainer);\n    }\n\n    if (this.config.ui\n      && this.config.ui.buttons\n      && this.config.ui.buttons.download\n      && this.config.ui.buttons.download.type) {\n        renderDownloadButton({\n          element: this.el(),\n          data: escapeHtml(text) || '',\n          type: this.config.ui.buttons.download.type,\n          label: this.config.ui.buttons.download.label,\n         })\n      }\n\n      if (this.config.utils\n        && this.config.utils.clickToCopyToClipboard) {\n          titleContainer.addEventListener('click', e => copyToClipboard(e.target.innerText, e));\n          notesContainer.addEventListener('click', e => copyToClipboard(e.target.innerText, e));\n          msg.addEventListener('click', e => copyToClipboard(e.target.innerText, e));\n        }\n\n    this.el().innerHTML = '';\n    this.el().appendChild(outer);\n\n  },\n  update: function(){\n    // no special update handling\n    this.render();\n  },\n  destroy: function(){\n    // no special clean-up\n  }\n};\n","import exportImage from './export-svg';\nimport exportData from './export-data';\n\nexport default function downloadResults(obj) {\n  const { event, type, data } = obj;\n  event.preventDefault();\n  const supportedFormats = ['json', 'csv', 'jpg', 'jpeg', 'png'];\n  const format = type.toLowerCase();\n  if (!supportedFormats.includes(type)) {\n    throw new Error('This type is not supported');\n  }\n\n  const fileName = 'chart';\n  let fileFormat = '';\n  let content = '';\n\n  if (format === 'png') {\n    exportImage({\n      node: event.currentTarget.previousElementSibling,\n    });\n    return;\n  }\n\n  if (format === 'jpg' || format === 'jpeg') {\n    exportImage({\n      node: event.currentTarget.previousElementSibling,\n      quality: 1,\n      bgcolor: '#fff',\n    });\n    return;\n  }\n\n  if (format === 'json') {\n    exportData({ type: format, data });\n  }\n\n  if (format === 'csv') {\n    exportData({ type: format, data });\n  }\n}\n","(function (global) {\n    'use strict';\n\n    var util = newUtil();\n    var inliner = newInliner();\n    var fontFaces = newFontFaces();\n    var images = newImages();\n\n    // Default impl options\n    var defaultOptions = {\n        // Default is to fail on error, no placeholder\n        imagePlaceholder: undefined,\n        // Default cache bust is false, it will use the cache\n        cacheBust: false\n    };\n\n    var domtoimage = {\n        toSvg: toSvg,\n        toPng: toPng,\n        toJpeg: toJpeg,\n        toBlob: toBlob,\n        toPixelData: toPixelData,\n        impl: {\n            fontFaces: fontFaces,\n            images: images,\n            util: util,\n            inliner: inliner,\n            options: {}\n        }\n    };\n\n    if (typeof module !== 'undefined')\n        module.exports = domtoimage;\n    else\n        global.domtoimage = domtoimage;\n\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options\n     * @param {Function} options.filter - Should return true if passed node should be included in the output\n     *          (excluding node means excluding it's children as well). Not called on the root node.\n     * @param {String} options.bgcolor - color for the background, any valid CSS color value.\n     * @param {Number} options.width - width to be applied to node before rendering.\n     * @param {Number} options.height - height to be applied to node before rendering.\n     * @param {Object} options.style - an object whose properties to be copied to node's style before rendering.\n     * @param {Number} options.quality - a Number between 0 and 1 indicating image quality (applicable to JPEG only),\n                defaults to 1.0.\n     * @param {String} options.imagePlaceholder - dataURL to use as a placeholder for failed images, default behaviour is to fail fast on images we can't fetch\n     * @param {Boolean} options.cacheBust - set to true to cache bust by appending the time to the request url\n     * @return {Promise} - A promise that is fulfilled with a SVG image data URL\n     * */\n    function toSvg(node, options) {\n        options = options || {};\n        copyOptions(options);\n        return Promise.resolve(node)\n            .then(function (node) {\n                return cloneNode(node, options.filter, true);\n            })\n            .then(embedFonts)\n            .then(inlineImages)\n            .then(applyOptions)\n            .then(function (clone) {\n                return makeSvgDataUri(clone,\n                    options.width || util.width(node),\n                    options.height || util.height(node)\n                );\n            });\n\n        function applyOptions(clone) {\n            if (options.bgcolor) clone.style.backgroundColor = options.bgcolor;\n\n            if (options.width) clone.style.width = options.width + 'px';\n            if (options.height) clone.style.height = options.height + 'px';\n\n            if (options.style)\n                Object.keys(options.style).forEach(function (property) {\n                    clone.style[property] = options.style[property];\n                });\n\n            return clone;\n        }\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a Uint8Array containing RGBA pixel data.\n     * */\n    function toPixelData(node, options) {\n        return draw(node, options || {})\n            .then(function (canvas) {\n                return canvas.getContext('2d').getImageData(\n                    0,\n                    0,\n                    util.width(node),\n                    util.height(node)\n                ).data;\n            });\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a PNG image data URL\n     * */\n    function toPng(node, options) {\n        return draw(node, options || {})\n            .then(function (canvas) {\n                return canvas.toDataURL();\n            });\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a JPEG image data URL\n     * */\n    function toJpeg(node, options) {\n        options = options || {};\n        return draw(node, options)\n            .then(function (canvas) {\n                return canvas.toDataURL('image/jpeg', options.quality || 1.0);\n            });\n    }\n\n    /**\n     * @param {Node} node - The DOM Node object to render\n     * @param {Object} options - Rendering options, @see {@link toSvg}\n     * @return {Promise} - A promise that is fulfilled with a PNG image blob\n     * */\n    function toBlob(node, options) {\n        return draw(node, options || {})\n            .then(util.canvasToBlob);\n    }\n\n    function copyOptions(options) {\n        // Copy options to impl options for use in impl\n        if(typeof(options.imagePlaceholder) === 'undefined') {\n            domtoimage.impl.options.imagePlaceholder = defaultOptions.imagePlaceholder;\n        } else {\n            domtoimage.impl.options.imagePlaceholder = options.imagePlaceholder;\n        }\n\n        if(typeof(options.cacheBust) === 'undefined') {\n            domtoimage.impl.options.cacheBust = defaultOptions.cacheBust;\n        } else {\n            domtoimage.impl.options.cacheBust = options.cacheBust;\n        }\n    }\n\n    function draw(domNode, options) {\n        return toSvg(domNode, options)\n            .then(util.makeImage)\n            .then(util.delay(100))\n            .then(function (image) {\n                var canvas = newCanvas(domNode);\n                canvas.getContext('2d').drawImage(image, 0, 0);\n                return canvas;\n            });\n\n        function newCanvas(domNode) {\n            var canvas = document.createElement('canvas');\n            canvas.width = options.width || util.width(domNode);\n            canvas.height = options.height || util.height(domNode);\n\n            if (options.bgcolor) {\n                var ctx = canvas.getContext('2d');\n                ctx.fillStyle = options.bgcolor;\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n            }\n\n            return canvas;\n        }\n    }\n\n    function cloneNode(node, filter, root) {\n        if (!root && filter && !filter(node)) return Promise.resolve();\n\n        return Promise.resolve(node)\n            .then(makeNodeCopy)\n            .then(function (clone) {\n                return cloneChildren(node, clone, filter);\n            })\n            .then(function (clone) {\n                return processClone(node, clone);\n            });\n\n        function makeNodeCopy(node) {\n            if (node instanceof HTMLCanvasElement) return util.makeImage(node.toDataURL());\n            return node.cloneNode(false);\n        }\n\n        function cloneChildren(original, clone, filter) {\n            var children = original.childNodes;\n            if (children.length === 0) return Promise.resolve(clone);\n\n            return cloneChildrenInOrder(clone, util.asArray(children), filter)\n                .then(function () {\n                    return clone;\n                });\n\n            function cloneChildrenInOrder(parent, children, filter) {\n                var done = Promise.resolve();\n                children.forEach(function (child) {\n                    done = done\n                        .then(function () {\n                            return cloneNode(child, filter);\n                        })\n                        .then(function (childClone) {\n                            if (childClone) parent.appendChild(childClone);\n                        });\n                });\n                return done;\n            }\n        }\n\n        function processClone(original, clone) {\n            if (!(clone instanceof Element)) return clone;\n\n            return Promise.resolve()\n                .then(cloneStyle)\n                .then(clonePseudoElements)\n                .then(copyUserInput)\n                .then(fixSvg)\n                .then(function () {\n                    return clone;\n                });\n\n            function cloneStyle() {\n                copyStyle(window.getComputedStyle(original), clone.style);\n\n                function copyStyle(source, target) {\n                    if (source.cssText) target.cssText = source.cssText;\n                    else copyProperties(source, target);\n\n                    function copyProperties(source, target) {\n                        util.asArray(source).forEach(function (name) {\n                            target.setProperty(\n                                name,\n                                source.getPropertyValue(name),\n                                source.getPropertyPriority(name)\n                            );\n                        });\n                    }\n                }\n            }\n\n            function clonePseudoElements() {\n                [':before', ':after'].forEach(function (element) {\n                    clonePseudoElement(element);\n                });\n\n                function clonePseudoElement(element) {\n                    var style = window.getComputedStyle(original, element);\n                    var content = style.getPropertyValue('content');\n\n                    if (content === '' || content === 'none') return;\n\n                    var className = util.uid();\n                    clone.className = clone.className + ' ' + className;\n                    var styleElement = document.createElement('style');\n                    styleElement.appendChild(formatPseudoElementStyle(className, element, style));\n                    clone.appendChild(styleElement);\n\n                    function formatPseudoElementStyle(className, element, style) {\n                        var selector = '.' + className + ':' + element;\n                        var cssText = style.cssText ? formatCssText(style) : formatCssProperties(style);\n                        return document.createTextNode(selector + '{' + cssText + '}');\n\n                        function formatCssText(style) {\n                            var content = style.getPropertyValue('content');\n                            return style.cssText + ' content: ' + content + ';';\n                        }\n\n                        function formatCssProperties(style) {\n\n                            return util.asArray(style)\n                                .map(formatProperty)\n                                .join('; ') + ';';\n\n                            function formatProperty(name) {\n                                return name + ': ' +\n                                    style.getPropertyValue(name) +\n                                    (style.getPropertyPriority(name) ? ' !important' : '');\n                            }\n                        }\n                    }\n                }\n            }\n\n            function copyUserInput() {\n                if (original instanceof HTMLTextAreaElement) clone.innerHTML = original.value;\n                if (original instanceof HTMLInputElement) clone.setAttribute(\"value\", original.value);\n            }\n\n            function fixSvg() {\n                if (!(clone instanceof SVGElement)) return;\n                clone.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n\n                if (!(clone instanceof SVGRectElement)) return;\n                ['width', 'height'].forEach(function (attribute) {\n                    var value = clone.getAttribute(attribute);\n                    if (!value) return;\n\n                    clone.style.setProperty(attribute, value);\n                });\n            }\n        }\n    }\n\n    function embedFonts(node) {\n        return fontFaces.resolveAll()\n            .then(function (cssText) {\n                var styleNode = document.createElement('style');\n                node.appendChild(styleNode);\n                styleNode.appendChild(document.createTextNode(cssText));\n                return node;\n            });\n    }\n\n    function inlineImages(node) {\n        return images.inlineAll(node)\n            .then(function () {\n                return node;\n            });\n    }\n\n    function makeSvgDataUri(node, width, height) {\n        return Promise.resolve(node)\n            .then(function (node) {\n                node.setAttribute('xmlns', 'http://www.w3.org/1999/xhtml');\n                return new XMLSerializer().serializeToString(node);\n            })\n            .then(util.escapeXhtml)\n            .then(function (xhtml) {\n                return '<foreignObject x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">' + xhtml + '</foreignObject>';\n            })\n            .then(function (foreignObject) {\n                return '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"' + width + '\" height=\"' + height + '\">' +\n                    foreignObject + '</svg>';\n            })\n            .then(function (svg) {\n                return 'data:image/svg+xml;charset=utf-8,' + svg;\n            });\n    }\n\n    function newUtil() {\n        return {\n            escape: escape,\n            parseExtension: parseExtension,\n            mimeType: mimeType,\n            dataAsUrl: dataAsUrl,\n            isDataUrl: isDataUrl,\n            canvasToBlob: canvasToBlob,\n            resolveUrl: resolveUrl,\n            getAndEncode: getAndEncode,\n            uid: uid(),\n            delay: delay,\n            asArray: asArray,\n            escapeXhtml: escapeXhtml,\n            makeImage: makeImage,\n            width: width,\n            height: height\n        };\n\n        function mimes() {\n            /*\n             * Only WOFF and EOT mime types for fonts are 'real'\n             * see http://www.iana.org/assignments/media-types/media-types.xhtml\n             */\n            var WOFF = 'application/font-woff';\n            var JPEG = 'image/jpeg';\n\n            return {\n                'woff': WOFF,\n                'woff2': WOFF,\n                'ttf': 'application/font-truetype',\n                'eot': 'application/vnd.ms-fontobject',\n                'png': 'image/png',\n                'jpg': JPEG,\n                'jpeg': JPEG,\n                'gif': 'image/gif',\n                'tiff': 'image/tiff',\n                'svg': 'image/svg+xml'\n            };\n        }\n\n        function parseExtension(url) {\n            var match = /\\.([^\\.\\/]*?)$/g.exec(url);\n            if (match) return match[1];\n            else return '';\n        }\n\n        function mimeType(url) {\n            var extension = parseExtension(url).toLowerCase();\n            return mimes()[extension] || '';\n        }\n\n        function isDataUrl(url) {\n            return url.search(/^(data:)/) !== -1;\n        }\n\n        function toBlob(canvas) {\n            return new Promise(function (resolve) {\n                var binaryString = window.atob(canvas.toDataURL().split(',')[1]);\n                var length = binaryString.length;\n                var binaryArray = new Uint8Array(length);\n\n                for (var i = 0; i < length; i++)\n                    binaryArray[i] = binaryString.charCodeAt(i);\n\n                resolve(new Blob([binaryArray], {\n                    type: 'image/png'\n                }));\n            });\n        }\n\n        function canvasToBlob(canvas) {\n            if (canvas.toBlob)\n                return new Promise(function (resolve) {\n                    canvas.toBlob(resolve);\n                });\n\n            return toBlob(canvas);\n        }\n\n        function resolveUrl(url, baseUrl) {\n            var doc = document.implementation.createHTMLDocument();\n            var base = doc.createElement('base');\n            doc.head.appendChild(base);\n            var a = doc.createElement('a');\n            doc.body.appendChild(a);\n            base.href = baseUrl;\n            a.href = url;\n            return a.href;\n        }\n\n        function uid() {\n            var index = 0;\n\n            return function () {\n                return 'u' + fourRandomChars() + index++;\n\n                function fourRandomChars() {\n                    /* see http://stackoverflow.com/a/6248722/2519373 */\n                    return ('0000' + (Math.random() * Math.pow(36, 4) << 0).toString(36)).slice(-4);\n                }\n            };\n        }\n\n        function makeImage(uri) {\n            return new Promise(function (resolve, reject) {\n                var image = new Image();\n                image.onload = function () {\n                    resolve(image);\n                };\n                image.onerror = reject;\n                image.src = uri;\n            });\n        }\n\n        function getAndEncode(url) {\n            var TIMEOUT = 30000;\n            if(domtoimage.impl.options.cacheBust) {\n                // Cache bypass so we dont have CORS issues with cached images\n                // Source: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n                url += ((/\\?/).test(url) ? \"&\" : \"?\") + (new Date()).getTime();\n            }\n\n            return new Promise(function (resolve) {\n                var request = new XMLHttpRequest();\n\n                request.onreadystatechange = done;\n                request.ontimeout = timeout;\n                request.responseType = 'blob';\n                request.timeout = TIMEOUT;\n                request.open('GET', url, true);\n                request.send();\n\n                var placeholder;\n                if(domtoimage.impl.options.imagePlaceholder) {\n                    var split = domtoimage.impl.options.imagePlaceholder.split(/,/);\n                    if(split && split[1]) {\n                        placeholder = split[1];\n                    }\n                }\n\n                function done() {\n                    if (request.readyState !== 4) return;\n\n                    if (request.status !== 200) {\n                        if(placeholder) {\n                            resolve(placeholder);\n                        } else {\n                            fail('cannot fetch resource: ' + url + ', status: ' + request.status);\n                        }\n\n                        return;\n                    }\n\n                    var encoder = new FileReader();\n                    encoder.onloadend = function () {\n                        var content = encoder.result.split(/,/)[1];\n                        resolve(content);\n                    };\n                    encoder.readAsDataURL(request.response);\n                }\n\n                function timeout() {\n                    if(placeholder) {\n                        resolve(placeholder);\n                    } else {\n                        fail('timeout of ' + TIMEOUT + 'ms occured while fetching resource: ' + url);\n                    }\n                }\n\n                function fail(message) {\n                    console.error(message);\n                    resolve('');\n                }\n            });\n        }\n\n        function dataAsUrl(content, type) {\n            return 'data:' + type + ';base64,' + content;\n        }\n\n        function escape(string) {\n            return string.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n        }\n\n        function delay(ms) {\n            return function (arg) {\n                return new Promise(function (resolve) {\n                    setTimeout(function () {\n                        resolve(arg);\n                    }, ms);\n                });\n            };\n        }\n\n        function asArray(arrayLike) {\n            var array = [];\n            var length = arrayLike.length;\n            for (var i = 0; i < length; i++) array.push(arrayLike[i]);\n            return array;\n        }\n\n        function escapeXhtml(string) {\n            return string.replace(/#/g, '%23').replace(/\\n/g, '%0A');\n        }\n\n        function width(node) {\n            var leftBorder = px(node, 'border-left-width');\n            var rightBorder = px(node, 'border-right-width');\n            return node.scrollWidth + leftBorder + rightBorder;\n        }\n\n        function height(node) {\n            var topBorder = px(node, 'border-top-width');\n            var bottomBorder = px(node, 'border-bottom-width');\n            return node.scrollHeight + topBorder + bottomBorder;\n        }\n\n        function px(node, styleProperty) {\n            var value = window.getComputedStyle(node).getPropertyValue(styleProperty);\n            return parseFloat(value.replace('px', ''));\n        }\n    }\n\n    function newInliner() {\n        var URL_REGEX = /url\\(['\"]?([^'\"]+?)['\"]?\\)/g;\n\n        return {\n            inlineAll: inlineAll,\n            shouldProcess: shouldProcess,\n            impl: {\n                readUrls: readUrls,\n                inline: inline\n            }\n        };\n\n        function shouldProcess(string) {\n            return string.search(URL_REGEX) !== -1;\n        }\n\n        function readUrls(string) {\n            var result = [];\n            var match;\n            while ((match = URL_REGEX.exec(string)) !== null) {\n                result.push(match[1]);\n            }\n            return result.filter(function (url) {\n                return !util.isDataUrl(url);\n            });\n        }\n\n        function inline(string, url, baseUrl, get) {\n            return Promise.resolve(url)\n                .then(function (url) {\n                    return baseUrl ? util.resolveUrl(url, baseUrl) : url;\n                })\n                .then(get || util.getAndEncode)\n                .then(function (data) {\n                    return util.dataAsUrl(data, util.mimeType(url));\n                })\n                .then(function (dataUrl) {\n                    return string.replace(urlAsRegex(url), '$1' + dataUrl + '$3');\n                });\n\n            function urlAsRegex(url) {\n                return new RegExp('(url\\\\([\\'\"]?)(' + util.escape(url) + ')([\\'\"]?\\\\))', 'g');\n            }\n        }\n\n        function inlineAll(string, baseUrl, get) {\n            if (nothingToInline()) return Promise.resolve(string);\n\n            return Promise.resolve(string)\n                .then(readUrls)\n                .then(function (urls) {\n                    var done = Promise.resolve(string);\n                    urls.forEach(function (url) {\n                        done = done.then(function (string) {\n                            return inline(string, url, baseUrl, get);\n                        });\n                    });\n                    return done;\n                });\n\n            function nothingToInline() {\n                return !shouldProcess(string);\n            }\n        }\n    }\n\n    function newFontFaces() {\n        return {\n            resolveAll: resolveAll,\n            impl: {\n                readAll: readAll\n            }\n        };\n\n        function resolveAll() {\n            return readAll(document)\n                .then(function (webFonts) {\n                    return Promise.all(\n                        webFonts.map(function (webFont) {\n                            return webFont.resolve();\n                        })\n                    );\n                })\n                .then(function (cssStrings) {\n                    return cssStrings.join('\\n');\n                });\n        }\n\n        function readAll() {\n            return Promise.resolve(util.asArray(document.styleSheets))\n                .then(getCssRules)\n                .then(selectWebFontRules)\n                .then(function (rules) {\n                    return rules.map(newWebFont);\n                });\n\n            function selectWebFontRules(cssRules) {\n                return cssRules\n                    .filter(function (rule) {\n                        return rule.type === CSSRule.FONT_FACE_RULE;\n                    })\n                    .filter(function (rule) {\n                        return inliner.shouldProcess(rule.style.getPropertyValue('src'));\n                    });\n            }\n\n            function getCssRules(styleSheets) {\n                var cssRules = [];\n                styleSheets.forEach(function (sheet) {\n                    try {\n                        util.asArray(sheet.cssRules || []).forEach(cssRules.push.bind(cssRules));\n                    } catch (e) {\n                        console.log('Error while reading CSS rules from ' + sheet.href, e.toString());\n                    }\n                });\n                return cssRules;\n            }\n\n            function newWebFont(webFontRule) {\n                return {\n                    resolve: function resolve() {\n                        var baseUrl = (webFontRule.parentStyleSheet || {}).href;\n                        return inliner.inlineAll(webFontRule.cssText, baseUrl);\n                    },\n                    src: function () {\n                        return webFontRule.style.getPropertyValue('src');\n                    }\n                };\n            }\n        }\n    }\n\n    function newImages() {\n        return {\n            inlineAll: inlineAll,\n            impl: {\n                newImage: newImage\n            }\n        };\n\n        function newImage(element) {\n            return {\n                inline: inline\n            };\n\n            function inline(get) {\n                if (util.isDataUrl(element.src)) return Promise.resolve();\n\n                return Promise.resolve(element.src)\n                    .then(get || util.getAndEncode)\n                    .then(function (data) {\n                        return util.dataAsUrl(data, util.mimeType(element.src));\n                    })\n                    .then(function (dataUrl) {\n                        return new Promise(function (resolve, reject) {\n                            element.onload = resolve;\n                            element.onerror = reject;\n                            element.src = dataUrl;\n                        });\n                    });\n            }\n        }\n\n        function inlineAll(node) {\n            if (!(node instanceof Element)) return Promise.resolve(node);\n\n            return inlineBackground(node)\n                .then(function () {\n                    if (node instanceof HTMLImageElement)\n                        return newImage(node).inline();\n                    else\n                        return Promise.all(\n                            util.asArray(node.childNodes).map(function (child) {\n                                return inlineAll(child);\n                            })\n                        );\n                });\n\n            function inlineBackground(node) {\n                var background = node.style.getPropertyValue('background');\n\n                if (!background) return Promise.resolve(node);\n\n                return inliner.inlineAll(background)\n                    .then(function (inlined) {\n                        node.style.setProperty(\n                            'background',\n                            inlined,\n                            node.style.getPropertyPriority('background')\n                        );\n                    })\n                    .then(function () {\n                        return node;\n                    });\n            }\n        }\n    }\n})(this);\n","(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(b,c,d){var e=new XMLHttpRequest;e.open(\"GET\",b),e.responseType=\"blob\",e.onload=function(){a(e.response,c,d)},e.onerror=function(){console.error(\"could not download file\")},e.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(a,b,d,e){if(e=e||open(\"\",\"_blank\"),e&&(e.document.title=e.document.body.innerText=\"downloading...\"),\"string\"==typeof a)return c(a,b,d);var g=\"application/octet-stream\"===a.type,h=/constructor/i.test(f.HTMLElement)||f.safari,i=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((i||g&&h)&&\"object\"==typeof FileReader){var j=new FileReader;j.onloadend=function(){var a=j.result;a=i?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),e?e.location.href=a:location=a,e=null},j.readAsDataURL(a)}else{var k=f.URL||f.webkitURL,l=k.createObjectURL(a);e?e.location=l:location.href=l,e=null,setTimeout(function(){k.revokeObjectURL(l)},4E4)}});f.saveAs=a.saveAs=a,\"undefined\"!=typeof module&&(module.exports=a)});\n\n//# sourceMappingURL=FileSaver.min.js.map","import { prettyNumber } from '../../utils/pretty-number';\nimport { escapeHtml } from '../../utils/escape-html';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nfunction formatExtractionData(res, prop) {\n  const { query, result } = res;\n  const formattedResult = [];\n  if (query.analysis_type !== 'extraction') throw new Error('Analysis type is not an extraction!');\n  if (Array.isArray(result)) {\n    result.forEach((item) => {\n      const obj = {\n        query,\n        result: item[prop],\n      };\n      formattedResult.push(obj);\n    });\n  }\n  return formattedResult;\n}\n\nexport default {\n  render: function(){\n    let color = this.config.colors[0];\n    const theme = this.config.theme;\n    const title = this.config.title;\n    const subtitle = this.config.subtitle;\n    const opts = this.config;\n    let value = '-';\n    let prevValue= '';\n    let html = '';\n    let prefix = '';\n    let suffix = '';\n    let formattedNum;\n    let flexDifferenceStyle = '';\n    let resultDifference = '';\n    let differenceStyle = '';\n    let smallerValue = '';\n    const { results, previousResults, isExtraction, comparedProp } = this.config;\n    if(results && previousResults){\n      flexDifferenceStyle = previousResults ? ' metric-comparison' : '';\n      smallerValue = previousResults && title ? '-smaller' : '';\n      resultDifference = results.result - previousResults.result;\n      differenceStyle = (resultDifference > 0) ? '-green' : '-red';\n      resultDifference = Math.abs(resultDifference);\n      color = '';\n    }\n\n    if (this.data() && this.data()[1] && this.data()[1][1] && typeof this.data()[1][1] === 'number') {\n      value = this.data()[1][1];\n    }\n\n    if (isExtraction && comparedProp) {\n      const formattedResult = formatExtractionData(results, comparedProp);\n      \n      value = formattedResult[0].result;\n      prevValue = formattedResult[1].result;\n\n      flexDifferenceStyle = prevValue ? ' metric-comparison' : '';\n      smallerValue = prevValue && title ? '-smaller' : '';\n      resultDifference = value - prevValue;\n      differenceStyle = (resultDifference > 0) ? '-green' : '-red';\n      resultDifference = Math.abs(resultDifference);\n      color = '';\n    }\n\n    formattedNum = value;\n    if ( (typeof opts['prettyNumber'] === 'undefined' || opts['prettyNumber'] === true)\n      && !isNaN(parseInt(value)) ) {\n        formattedNum = prettyNumber(value);\n        if(results && previousResults){\n          resultDifference = prettyNumber(resultDifference);\n        }\n    }\n\n    if (opts['prefix']) {\n      prefix = '<span class=\"' + theme + '-metric-prefix\">' + opts['prefix'] + '</span>';\n    }\n    if (opts['suffix']) {\n      suffix = '<span class=\"' + theme + '-metric-suffix\">' + opts['suffix'] + '</span>';\n    }\n    html += '<div class=\"' + theme + '\">';\n    html +=   '<div class=\"' + theme + '-metric keen-dataviz-box' + flexDifferenceStyle + '\" title=\"' + escapeHtml(value) + '\" style=\"background-color:' + color + '\">';\n    if (results && previousResults) {\n      html +=   '<div class=\"' + theme + '-metric' + differenceStyle + '\"><div class=\"arrow' + differenceStyle + '\"> </div>' + escapeHtml(resultDifference) + '</div>';\n    }\n    if (isExtraction && comparedProp) {\n      if (value && prevValue) {\n        html +=   '<div class=\"' + theme + '-metric' + differenceStyle + '\"><div class=\"arrow' + differenceStyle + '\"> </div>' + escapeHtml(resultDifference) + '</div>';\n        html += '<small>' + prevValue + '</small>';\n      } else {\n        html += '<p>No data to display</p>';\n      }\n    }\n    html +=     '<div class=\"' + theme + '-metric-value' + smallerValue + '\">' + prefix + escapeHtml(formattedNum) + suffix + '</div>';\n    if (title) {\n      html +=   '<div class=\"' + theme + '-metric-title\">' + escapeHtml(title) + '</div>';\n    }\n    if (subtitle) {\n      html +=   '<div class=\"' + theme + '-metric-subtitle\">' + escapeHtml(subtitle) + '</div>';\n    }\n    html +=   '</div>';\n    html += '</div>';\n\n    this.el().innerHTML = html;\n\n    if (this.config.onrendered) {\n      this.config.onrendered();\n    }\n\n    if (this.config.utils && this.config.utils.clickToCopyToClipboard) {\n      const resultClassName = `.${theme}-metric-value${smallerValue}`;\n      document.querySelector(resultClassName).addEventListener('click', e => copyToClipboard(e.target.innerText, e));\n\n      if (results && previousResults) {\n        const previousResultsClassName = `.${theme}-metric${differenceStyle}`;\n        document.querySelector(previousResultsClassName).addEventListener('click', e => copyToClipboard(e.target.innerText, e));\n      }\n    }\n  },\n  update: function(){\n    // no special update handling\n    this.render();\n  },\n  destroy: function(){\n    // no special clean-up\n  }\n};\n","import { escapeHtml } from '../../utils/escape-html';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nlet currentPage;\nfunction _generateTableRows(datavizInstance, dataset) {\n  let html = '';\n  const defaultConfig = {\n    page: 1,\n    limit: 0,\n    arrows: true\n  };\n  let customConfig = {};\n  if (datavizInstance.config.table && datavizInstance.config.table.pagination) {\n    customConfig = datavizInstance.config.table.pagination;\n  }\n  const config = {\n    ...defaultConfig,\n    ...customConfig\n  };\n\n  if (!currentPage){\n    currentPage = config.page;\n  }\n\n  let datasetPaginated;\n  let pages = 0;\n  if (config.limit === 0) {\n    datasetPaginated = dataset.slice(1); // remove header\n  } else {\n    const start = config.limit * (currentPage - 1) + 1;\n    const end = start + config.limit;\n    datasetPaginated = dataset.slice(start, end);\n    pages = Math.ceil((dataset.length - 1) / config.limit);\n  }\n\n  let columnsArray = datavizInstance.config.table.columns ?\n                   datavizInstance.config.table.columns :\n                   datavizInstance.dataset.matrix[0];\n\n  const colNamesToMap = {};\n  const {\n    mapValues,\n    mapDates,\n  } = datavizInstance.config.table;\n  for (let key in mapValues){\n    colNamesToMap[columnsArray.indexOf(key)] = key;\n  }\n\n  for (let row of datasetPaginated) {\n    html +=   '<tr class=\"table-data-row\">';\n    for (let [index, rowColValue] of row.entries()) {\n      if (mapDates && rowColValue instanceof Date) {\n        rowColValue = mapDates(rowColValue);\n      }\n\n      let rowColValueEscaped = escapeHtml(rowColValue);\n      if(colNamesToMap[index]){\n        html += `<td>${mapValues[colNamesToMap[index]](rowColValueEscaped)}</td>`;\n        continue;\n      }\n      html += `<td>${rowColValueEscaped}</td>`\n    }\n    html +=   '</tr>';\n  }\n\n  if (pages > 1){\n    html += `<tr class=\"table-pagination\"><td colspan=\"999\">`;\n    let pageNumber = 1;\n    const prevPage = (currentPage === 1) ? 1 : (currentPage - 1);\n    const nextPage = (currentPage === pages) ? pages : (currentPage + 1);\n    if (config.arrows){\n      html += `<a class=\"arrow btn\" data-page=\"${prevPage}\">&laquo;</a>`;\n    }\n    while (pageNumber <= pages){\n      html += `<a class=\"btn ${\n        pageNumber === currentPage ? 'active' : ''\n      }\" data-page=\"${pageNumber}\">${pageNumber}</a>`;\n      pageNumber++;\n    }\n    if (config.arrows){\n      html += `<a class=\"arrow btn\" data-page=\"${nextPage}\">&raquo;</a>`;\n    }\n    html += '</td></tr>';\n  }\n\n  return html;\n}\n\nfunction _generateTableHeader(datavizInstance, dataset) {\n  let html = '';\n  let fieldNumber = -1;\n  const tableConfig = datavizInstance.config.table;\n  const columnNames =\n    (tableConfig && tableConfig.columns)\n    || dataset[0];\n  for (let colName of columnNames) {\n    let colNameEscaped = escapeHtml(colName);\n    fieldNumber +=1;\n    html +=  `<th fieldNumber=\"${fieldNumber}\">${colNameEscaped}</th>`;\n  }\n  return html;\n}\n\n\n  const render = function() {\n    const dataset = this.dataset.matrix;\n\n    const el = this.el();\n    const theme = this.config.theme;\n    const datavizInstance = this;\n\n    let html = '';\n\n    const isEmpty = dataset.length === 1 && dataset[0].length === 0;\n    if (isEmpty) {\n      const msg = 'No data to display';\n      const mappedMsg = this.config.errorMapping[msg] || msg;\n      if (this.config.showErrorMessages) {\n        this.message(mappedMsg);\n      }\n      return;\n    }\n\n    // Open wrapper\n    html += `<div class=\"${theme}-table\">`;\n\n    // Static, scrollable table\n    html +=   `<table class=\"${theme}-table-dataset\">`;\n    html +=     '<thead>';\n    html +=       '<tr>';\n    html +=       _generateTableHeader(datavizInstance, dataset);\n    html +=       '</tr>';\n    html +=     '</thead>';\n    // Table data\n    html +=     '<tbody>';\n    html +=     _generateTableRows(datavizInstance, dataset);\n    html +=     '</tbody>';\n    html +=   '</table>';\n/* */\n    // Close wrapper\n    html += '</div>';\n\n    // Inject HTML string\n    el.querySelector(`.${theme}-rendering`).innerHTML = html;\n\n    el\n      .querySelectorAll(`.${theme}-rendering th`)\n      .forEach((item) => {\n        item.addEventListener('click', (event) => {\n          let sortOrder = event.target.getAttribute('order') || 'asc';\n          let fieldNumber =  event.target.getAttribute('fieldNumber');\n          let checker = function (a, b) {\n            let sortOrderNumber = (sortOrder === 'asc') ? 1 : -1;\n\n            if (typeof a[fieldNumber] === 'string') {\n              let nameA = a[fieldNumber].toUpperCase(); // ignore upper and lowercase\n              let nameB = b[fieldNumber].toUpperCase(); // ignore upper and lowercase\n              if (nameA < nameB) {\n                return -1 * sortOrderNumber;\n              }\n              if (nameA > nameB) {\n                return 1* sortOrderNumber;\n              }\n\n              // names must be equal\n              return 0;\n            }\n            return (a[fieldNumber] - b[fieldNumber]) * sortOrderNumber;\n          };\n\n          if (sortOrder === 'asc') {\n            sortOrder = 'desc';\n          } else {\n            sortOrder = 'asc'\n          }\n          event.target.setAttribute('order', sortOrder);\n\n          const first = this.dataset.matrix.shift();\n          this.dataset.matrix.sort(checker);\n          this.dataset.matrix.unshift(first);\n\n          el.querySelector(`.${theme}-rendering tbody`).innerHTML =\n             _generateTableRows(datavizInstance, dataset);\n          attachBtnEventListeners();\n        });\n      });\n\n\n    const attachBtnEventListeners = () => {\n      el.querySelectorAll('.btn').forEach(btn => {\n        btn.addEventListener('click', (event) => {\n          currentPage = parseInt(event.target.getAttribute('data-page'));\n          el.querySelector(`.${theme}-rendering tbody`).innerHTML =\n             _generateTableRows(datavizInstance, dataset);\n             attachBtnEventListeners();\n          }, true);\n      });\n    };\n\n    attachBtnEventListeners(datavizInstance, el, theme);\n\n    if (this.config.onrendered) {\n      this.config.onrendered();\n    }\n\n    if (this.config.utils && this.config.utils.clickToCopyToClipboard) {\n      const tableClass = `.${theme}-table-dataset`;\n      document.querySelector(tableClass)\n        .addEventListener('click', (e) => {\n          const { nodeName, innerText } = e.target;\n          if (nodeName === 'TD') {\n            copyToClipboard(innerText, e);\n          }\n        });\n    }\n  };\n\n\n\nconst update = function(){\n    // no special update handling\n    this.render();\n  };\n\nconst destroy=  function(){};\n\nexport default { render, update, destroy };\n","export default {\n  render: function(){\n    let html = '';\n    const artifacts = this.view._artifacts.spinner = {};\n\n    // Build DOM element\n    html += '<div class=\"' + this.config.theme + '\">';\n    html +=   '<div class=\"keen-spinner-container keen-dataviz-box\">';\n    html +=     '<div class=\"keen-spinner-indicator\"></div>';\n    html +=   '</div>';\n    html += '</div>';\n    this.el().innerHTML = html;\n  },\n  update: function(){\n    // no special update handling\n    this.render();\n  },\n  destroy: function(){\n    if (this.view._artifacts.spinner) {\n      if (this.view._artifacts.spinner.interval) {\n        clearInterval(this.view._artifacts.spinner.interval);\n      }\n      this.view._artifacts.spinner.radius = 0;\n      try {\n        delete this.view._artifacts.spinner;\n      }\n      catch (e) {\n        this.view._artifacts.spinner = undefined;\n      }\n    }\n    this.el().innerHTML = '';\n  }\n};\n","import * as d3 from 'd3';\nimport { textWrap } from '../../utils/svg-text-wrap';\nimport { prettyNumber } from '../../utils/pretty-number';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nexport default class Funnel {\n  render() {\n    const { matrix } = this.dataset;\n    const {\n      colors,\n      container,\n      labelMapping,\n      colorMapping,\n      utils,\n    } = this.config;\n    const opts = this.config;\n    const {\n      percents: {\n        show,\n        countingMethod,\n        decimals,\n      },\n      lines,\n      marginBetweenSteps,\n      resultValues,\n      hover,\n      minimalSize,\n    } = this.config.funnel;\n    const margin = { top: 20, right: 30, bottom: 30, left: 200 };\n    let yMarginElement = 0;\n    if(marginBetweenSteps){\n      yMarginElement = 5;\n    }\n    const funnelContainer = d3.select(container);\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    const chart = chartContainer.append('svg');\n    const svgWidth = funnelContainer.style('width').slice(0, -2)\n          - margin.right - margin.left;\n    const svgHeight = funnelContainer.style('height').slice(0, -2)\n          - margin.top - margin.bottom - 30;\n    const elemHeight = svgHeight/(matrix.length - 1);\n    let prevElemWidth = svgWidth;\n    let percent = (100).toFixed(decimals);\n\n    // prepare normal funnel polygons\n    let minimalSizeStep = 0;\n    if(minimalSize){\n      minimalSizeStep = (svgWidth - minimalSize) / (matrix.length-2);\n    }\n    const polygons = matrix.slice(1).map((d, i) => {\n        const newPoints = [\n          {\n            x: ((svgWidth - prevElemWidth)/2),\n            y: elemHeight * i + yMarginElement\n          },\n          {\n            x: ((svgWidth - prevElemWidth)/2 + prevElemWidth),\n            y: elemHeight * i + yMarginElement\n          },\n        ]\n        if(i !== 0){\n          if (countingMethod === \"relative\") {\n            minimalSize\n              ? (prevElemWidth = prevElemWidth - minimalSizeStep)\n              : (prevElemWidth =\n                  (prevElemWidth * d[1]) / matrix[i][1]);\n            percent = ((d[1] / matrix[i][1]) * 100).toFixed(decimals);\n          }\n          if (countingMethod === \"absolute\") {\n            minimalSize\n              ? (prevElemWidth = prevElemWidth - minimalSizeStep)\n              : (prevElemWidth = (svgWidth * d[1]) / matrix[1][1]);\n            percent = ((d[1] / matrix[1][1]) * 100).toFixed(decimals);\n          }\n        }\n        let label = d[0];\n        if(Object.keys(labelMapping).length){\n          for (let key in labelMapping) {\n            if(labelMapping[key] === d[0]) {\n              label = key;\n            }\n          }\n        }\n        let result = d[1];\n        if ( (typeof opts['prettyNumber'] === 'undefined' || opts['prettyNumber'] === true)\n          && !isNaN(parseInt(d[1])) ) {\n            result = prettyNumber(d[1]);\n        }\n        return {\n          name: d[0],\n          label,\n          percent: percent + '%',\n          result,\n          points: [\n            ...newPoints,\n            {\n              x: ((svgWidth - prevElemWidth)/2 + prevElemWidth),\n              y: elemHeight * (i + 1)\n            },\n            {\n              x: ((svgWidth - prevElemWidth)/2),\n              y: elemHeight * (i + 1)\n            }\n          ]\n        }\n    });\n\n  \n    //chart rendering with polygons\n    chart\n      .attr('preserveAspectRatio', 'xMidYMid slice')\n      .attr('viewBox', `0 0 ${svgWidth + margin.left + margin.right} ${svgHeight + margin.top + margin.bottom - 30}`)\n      .attr('height', '100%')\n      .attr('width', '100%')\n      .append('g')\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n      .selectAll('polygon')\n      .data(polygons)\n      .enter()\n      .append('polygon')\n        .attr('points', (d) => {\n            return d.points.map((p) => {\n              return [p.x,p.y].join(',');\n            })\n            .join(' ');\n        })\n        .style('fill', (d, i) => {\n          if(colorMapping[d.label]){\n            return colorMapping[d.label];\n          }\n          return colors[i];\n        })\n        .attr('class', (d) => { return d.label; })\n        .attr('cursor', 'pointer');\n\n    if(lines){\n      //rendering lines\n      chart\n        .selectAll('line')\n        .data(polygons)\n        .enter()\n        .append('line')\n        .attr('x1', 10)\n        .attr('y1', (d) => {\n          return d.points[0].y + margin.top - (yMarginElement/2);\n        })\n        .attr('x2', (d) => { return d.points[1].x + margin.left; })\n        .attr('y2', (d) => {\n          return d.points[0].y + margin.top - (yMarginElement/2);\n        })\n        .attr('class', 'chart-lines');\n\n      //rendering last line\n      chart\n        .append('line')\n        .attr('x1', 10)\n        .attr('y1', polygons[polygons.length-1].points[2].y\n                    + margin.top + (yMarginElement/2))\n        .attr('x2', polygons[polygons.length-1].points[2].x + margin.left)\n        .attr('y2', polygons[polygons.length-1].points[2].y\n                    + margin.top + (yMarginElement/2))\n        .attr('class', 'chart-lines');\n    }\n\n    //rendering labels when lines are visible\n    if(lines){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'start')\n        .attr('x', 20)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + yMarginElement + 5\n        })\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, margin.left)\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering labels when lines are not visible\n    if(!lines) {\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'end')\n        .attr('x', (d) => {\n          return d.points[0].x + ((d.points[3].x - d.points[0].x)/2)\n                  + (margin.left * 0.9);\n        })\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + yMarginElement + 5\n        })\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, margin.left)\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering percents for each step\n    if(show && !resultValues){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + yMarginElement + 8\n        })\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results for each step\n    if(resultValues && !show){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + yMarginElement + 8\n        })\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results and percenage together\n    if(show && resultValues){\n      //rendering percents\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          if(yMarginElement === 0){\n            return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                    + margin.top + 16\n          }\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + yMarginElement + 12\n        })\n        .attr('class', (d) => { return 'text-second ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n\n      //rendering results\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          if(yMarginElement === 0){\n            return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                    + margin.top;\n          }\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + yMarginElement - 5;\n        })\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n    //hover handling\n    if(hover){\n      const polygonsHover = chart.selectAll('polygon');\n      polygonsHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      const labelHover = chart.selectAll('text');\n      labelHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      function handleMouseOver(d) {\n        polygonsHover\n          .style('opacity', 0.5);\n        labelHover\n          .style('opacity', 0.5);\n        const thisLabel = /[^ ]*$/.exec(d3.select(this).attr('class'))[0];\n        chart\n          .selectAll(`.${thisLabel}`)\n          .style('opacity', 1);\n      }\n      function handleMouseOut(d) {\n        polygonsHover\n          .style('opacity', 1);\n        labelHover\n          .style('opacity', 1);\n      }\n    }\n\n    // click to copy\n    if (utils && utils.clickToCopyToClipboard) {\n      const label = chart.selectAll('text');\n\n      label.on('click', handleClickToCopy);\n\n      function handleClickToCopy(data) {\n        const { percent, result } = data;\n        if (resultValues) {\n          copyToClipboard(result, d3.event);\n        } else if (show) {\n          copyToClipboard(percent, d3.event);\n        }\n      }\n    }\n  }\n  update() {\n    this.destroy();\n    this.render();\n  }\n  destroy() {\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    chartContainer.remove();\n  }\n}\n","import * as d3 from 'd3';\nimport { textWrap } from '../../utils/svg-text-wrap';\nimport { prettyNumber } from '../../utils/pretty-number';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nexport default class Funnel3d {\n  render() {\n    const { matrix } = this.dataset;\n    const {\n      colors,\n      container,\n      labelMapping,\n      colorMapping,\n      utils,\n    } = this.config;\n    const opts = this.config;\n    const {\n      percents: {\n        show,\n        countingMethod,\n        decimals,\n      },\n      lines,\n      resultValues,\n      effect3d,\n      hover,\n      minimalSize,\n    } = this.config.funnel;\n    const margin = { top: 20, right: 30, bottom: 60, left: 200 };\n    const funnelContainer = d3.select(container);\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    const chart = chartContainer.append('svg');\n    const svgWidth = funnelContainer.style('width').slice(0, -2)\n          - margin.right - margin.left;\n    const svgHeight = funnelContainer.style('height').slice(0, -2)\n          - margin.top - margin.bottom - 30;\n    const elemHeight = svgHeight/(matrix.length - 1);\n    const yMarginElement = elemHeight * 0.3;\n    const shadowCut = (yMarginElement * 2.5);\n    let prevElemWidth = svgWidth;\n    let percent = (100).toFixed(decimals);\n\n    // prepare normal funnel polygons\n    let minimalSizeStep = 0;\n    if(minimalSize){\n      minimalSizeStep = (svgWidth - minimalSize) / (matrix.length-2);\n    }\n    const polygons = matrix.slice(1).map((d, i) => {\n        const newPoints = [\n          {\n            x: ((svgWidth - prevElemWidth)/2),\n            y: elemHeight * i + yMarginElement\n          },\n          {\n            x: ((svgWidth - prevElemWidth)/2 + prevElemWidth),\n            y: elemHeight * i + yMarginElement\n          },\n        ]\n        if(i !== 0){\n          if(countingMethod === 'relative'){\n            minimalSize\n              ? (prevElemWidth = prevElemWidth - minimalSizeStep)\n              : prevElemWidth = prevElemWidth * d[1]/matrix[i][1];\n            percent = ((d[1]/matrix[i][1])*100).toFixed(decimals);\n          }\n          if(countingMethod === 'absolute'){\n            minimalSize\n              ? (prevElemWidth = prevElemWidth - minimalSizeStep)\n              : prevElemWidth = svgWidth * d[1]/matrix[1][1];\n            percent = ((d[1]/matrix[1][1])*100).toFixed(decimals);\n          }\n        }\n        let label = d[0];\n        if(Object.keys(labelMapping).length){\n          for (let key in labelMapping) {\n            if(labelMapping[key] === d[0]) {\n              label = key;\n            }\n          }\n        }\n        let result = d[1];\n        if ( (typeof opts['prettyNumber'] === 'undefined' || opts['prettyNumber'] === true)\n          && !isNaN(parseInt(d[1])) ) {\n            result = prettyNumber(d[1]);\n        }\n        return {\n          name: d[0],\n          label,\n          percent: percent + '%',\n          result,\n          points: [\n            ...newPoints,\n            {\n              x: ((svgWidth - prevElemWidth)/2 + prevElemWidth),\n              y: elemHeight * (i + 1)\n            },\n            {\n              x: ((svgWidth - prevElemWidth)/2),\n              y: elemHeight * (i + 1)\n            }\n          ]\n        }\n    });\n\n    //funnel shadows preparing\n    const polygonsShadows = polygons.map((d, i) => {\n        return {\n          label: d.label,\n          points: [\n            {\n              x: d.points[3].x,\n              y: d.points[3].y\n            },\n            {\n              x: d.points[2].x,\n              y: d.points[2].y\n            },\n            {\n              x: effect3d === 'left'\n              ? d.points[2].x\n              : d.points[2].x - shadowCut < svgWidth/2\n                ? svgWidth/2 + 5\n                : d.points[2].x - shadowCut,\n              y: effect3d === 'left'\n              ? d.points[2].y\n              : d.points[2].y + (yMarginElement/1.5)\n            },\n            {\n              x: effect3d === 'right'\n              ? d.points[3].x\n              : d.points[3].x + shadowCut > svgWidth/2\n                ? svgWidth/2 - 5\n                : d.points[3].x + shadowCut,\n              y: effect3d === 'right'\n              ? d.points[3].y\n              : d.points[3].y + (yMarginElement/1.5)\n            },\n          ]\n        }\n    })\n\n    //connecting funnels with shadows for rendering\n    const polygons3d = polygons.concat(polygonsShadows);\n\n    //chart rendering with polygons\n    chart\n      .attr('preserveAspectRatio', 'xMidYMid meet')\n      .attr('viewBox', `0 0 ${svgWidth + margin.left + margin.right} ${svgHeight + margin.top + margin.bottom - 30}`)\n      .attr('height', '100%')\n      .attr('width', '100%')\n      .append('g')\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n      .selectAll('polygon')\n      .data(polygons3d)\n      .enter()\n      .append('polygon')\n        .attr('points', (d) => {\n            return d.points.map((p) => {\n              return [p.x,p.y].join(',');\n            })\n            .join(' ');\n        })\n        .style('fill', (d, i) => {\n          if(i > (polygons.length - 1)){\n            if(colorMapping[d.label]){\n              return d3.rgb(colorMapping[d.label]).darker(1.5);\n            }\n            return d3.rgb(colors[i - (polygons.length)]).darker(1.5);\n          }\n          if(colorMapping[d.label]){\n            return colorMapping[d.label];\n          }\n          return colors[i];\n        })\n        .attr('class', (d) => { return d.label; })\n        .attr('cursor', 'pointer');\n\n    if(lines){\n      //rendering lines\n      chart\n        .selectAll('line')\n        .data(polygons)\n        .enter()\n        .append('line')\n        .attr('x1', 10)\n        .attr('y1', (d) => {\n           return d.points[0].y + margin.top - (yMarginElement/5);\n         })\n        .attr('x2', (d, i) => {\n          if(i === 0){\n            return d.points[1].x + margin.left;\n          }\n          return d.points[1].x + margin.left - shadowCut;\n        })\n        .attr('y2', (d) => {\n          return d.points[0].y + margin.top - (yMarginElement/5);\n        })\n        .attr('class', 'chart-lines');\n\n      //rendering last line\n      chart\n        .append('line')\n        .attr('x1', 10)\n        .attr('y1', polygons[polygons.length-1].points[2].y + margin.top\n                    + yMarginElement - (yMarginElement/5))\n        .attr('x2', polygons[polygons.length-1].points[2].x\n                    + margin.left - shadowCut )\n        .attr('y2', polygons[polygons.length-1].points[2].y + margin.top\n                    + yMarginElement - (yMarginElement/5))\n        .attr('class', 'chart-lines');\n    }\n\n    //rendering labels when lines are visible\n    if(lines){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'start')\n        .attr('x', 20)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + 5 + (yMarginElement/4)\n        })\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, margin.left)\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering labels when lines are not visible\n    if(!lines){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'end')\n        .attr('x', (d) => {\n          return d.points[0].x + ((d.points[3].x - d.points[0].x)/2) + 130;\n        })\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + 5;\n        })\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, margin.left)\n        .attr('cursor', 'pointer');\n    }\n\n      //rendering percents for each step\n    if(show && !resultValues){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + 8\n        })\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results for each step\n    if(resultValues && !show){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + 8\n        })\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results and percenage together\n    if(show && resultValues){\n      //rendering percents\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + 18\n        })\n        .attr('class', (d) => { return 'text-second ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n\n      //rendering results\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', svgWidth/2 + margin.left)\n        .attr('y', (d) => {\n          return ((d.points[2].y - d.points[1].y)/2) + d.points[1].y\n                  + margin.top + 3\n        })\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n    //hover handling\n    if(hover){\n      const polygonsHover = chart.selectAll('polygon');\n      polygonsHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      const labelHover = chart.selectAll('text');\n      labelHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      function handleMouseOver(d) {\n        polygonsHover\n          .style('opacity', 0.5);\n        labelHover\n          .style('opacity', 0.5);\n        const thisLabel = /[^ ]*$/.exec(d3.select(this).attr('class'))[0];\n        chart\n          .selectAll(`.${thisLabel}`)\n          .style('opacity', 1);\n      }\n      function handleMouseOut(d) {\n        polygonsHover\n          .style('opacity', 1);\n        labelHover\n          .style('opacity', 1);\n      }\n    }\n\n        // click to copy\n    if (utils && utils.clickToCopyToClipboard) {\n      const label = chart.selectAll('text');\n\n      label.on('click', handleClickToCopy);\n\n      function handleClickToCopy(data) {\n        const { percent, result } = data;\n        if (resultValues) {\n          copyToClipboard(result, d3.event);\n        } else if (show) {\n          copyToClipboard(percent, d3.event);\n        }\n      }\n    }\n  }\n  update() {\n    this.destroy();\n    this.render();\n  }\n  destroy() {\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    chartContainer.remove();\n  }\n}\n","import * as d3 from 'd3';\nimport { textWrap } from '../../utils/svg-text-wrap';\nimport { prettyNumber } from '../../utils/pretty-number';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nexport default class HorizontalFunnel {\n  render() {\n    const { matrix } = this.dataset;\n    const {\n      colors,\n      container,\n      labelMapping,\n      colorMapping,\n      utils,\n    } = this.config;\n    const opts = this.config;\n    const {\n      percents: {\n        show,\n        countingMethod,\n        decimals,\n      },\n      lines,\n      marginBetweenSteps,\n      resultValues,\n      hover,\n      minimalSize,\n    } = this.config.funnel;\n    const margin = { top: 20, right: 30, bottom: 100, left: 10 };\n    let xMarginElement = 0;\n    if(marginBetweenSteps){\n      xMarginElement = 5;\n    }\n    const funnelContainer = d3.select(container);\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    const chart = chartContainer.append('svg');\n    const svgWidth = funnelContainer.style('width').slice(0, -2)\n          - margin.right - margin.left;\n    const svgHeight = funnelContainer.style('height').slice(0, -2)\n          - margin.top - margin.bottom - 30;\n    const elemWidth= svgWidth/(matrix.length - 1);\n    let prevElemHeight = svgHeight;\n    let percent = (100).toFixed(decimals);\n\n    // prepare normal funnel polygons\n    let minimalSizeStep = 0;\n    if(minimalSize){\n      minimalSizeStep = (svgHeight - minimalSize) / (matrix.length-2);\n    }\n    const polygons = matrix.slice(1).map((d, i) => {\n        const newPoints = [\n          {\n            x: elemWidth * i + xMarginElement,\n            y: ((svgHeight - prevElemHeight)/2)\n          },\n          {\n            x: elemWidth * i + xMarginElement,\n            y: ((svgHeight - prevElemHeight)/2 + prevElemHeight)\n          },\n        ]\n        if(i !== 0){\n          if(countingMethod === 'relative'){\n            minimalSize\n              ? (prevElemHeight = prevElemHeight - minimalSizeStep)\n              : prevElemHeight = prevElemHeight * d[1]/matrix[i][1];\n            percent = ((d[1]/matrix[i][1])*100).toFixed(decimals);\n          }\n          if(countingMethod === 'absolute'){\n            minimalSize\n              ? (prevElemHeight = prevElemHeight - minimalSizeStep)\n              : prevElemHeight = svgHeight * d[1]/matrix[1][1];\n            percent = ((d[1]/matrix[1][1])*100).toFixed(decimals);\n          }\n        }\n        let label = d[0];\n        if(Object.keys(labelMapping).length){\n          for (let key in labelMapping) {\n            if(labelMapping[key] === d[0]) {\n              label = key;\n            }\n          }\n        }\n        let result = d[1];\n        if ( (typeof opts['prettyNumber'] === 'undefined'\n          || opts['prettyNumber'] === true)\n          && !isNaN(parseInt(d[1])) ) {\n            result = prettyNumber(d[1]);\n        }\n        return {\n          name: d[0],\n          label,\n          percent: percent + '%',\n          result,\n          points: [\n            ...newPoints,\n            {\n              x: elemWidth * (i + 1),\n              y: ((svgHeight - prevElemHeight)/2 + prevElemHeight)\n            },\n            {\n              x: elemWidth * (i + 1),\n              y: ((svgHeight - prevElemHeight)/2)\n            }\n          ]\n        }\n    });\n\n    //chart rendering with polygons\n    chart\n      .attr('preserveAspectRatio', 'xMidYMid meet')\n      .attr('viewBox', `0 0 ${svgWidth + margin.left + margin.right} ${svgHeight + margin.top + margin.bottom - 30}`)\n      .attr('height', '100%')\n      .attr('width', '100%')\n      .append('g')\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n      .selectAll('polygon')\n      .data(polygons)\n      .enter()\n      .append('polygon')\n        .attr('points', (d) => {\n            return d.points.map((p) => {\n              return [p.x,p.y].join(',');\n            })\n            .join(' ');\n        })\n        .style('fill', (d, i) => {\n          if(colorMapping[d.label]){\n            return colorMapping[d.label];\n          }\n          return colors[i];\n        })\n        .attr('class', (d) => { return d.label; })\n        .attr('cursor', 'pointer');\n\n    if(lines){\n      //rendering lines\n      chart\n        .selectAll('line')\n        .data(polygons)\n        .enter()\n        .append('line')\n        .attr('x1', (d) => {\n          return d.points[0].x + margin.left - (xMarginElement/2);\n        })\n        .attr('y1', svgHeight + margin.bottom)\n        .attr('x2', (d) => {\n          return d.points[0].x + margin.left - (xMarginElement/2);\n        })\n        .attr('y2', (d) => { return d.points[0].y + margin.top; })\n        .attr('class', 'chart-lines');\n\n      //rendering last line\n      chart\n        .append('line')\n        .attr('x1', svgWidth + margin.left - (xMarginElement/2))\n        .attr('y1', svgHeight + margin.bottom)\n        .attr('x2', polygons[polygons.length-1].points[3].x\n                    + margin.left + (xMarginElement/2))\n        .attr('y2', polygons[polygons.length-1].points[3].y + margin.top)\n        .attr('class', 'chart-lines');\n    }\n\n    //rendering labels when lines are visible\n    if(lines){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2) + margin.left\n        })\n        .attr('y', svgHeight + (margin.bottom * 0.5) + margin.top)\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, elemWidth)\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering labels when lines are not visible\n    if(!lines) {\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2) + margin.left\n        })\n        .attr('y', (d) => {\n          if(d.points[2].y + ((d.points[3].y - d.points[0].y)/2)\n          + (elemWidth/4) > svgHeight + margin.bottom - 40 + margin.top){\n            return svgHeight + margin.bottom - 40 + margin.top;\n          }\n          return d.points[2].y + ((d.points[3].y - d.points[0].y)/2)\n                  + (elemWidth/4) + margin.top;\n        })\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, elemWidth)\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering percents for each step\n    if(show && !resultValues){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2) + margin.left\n        })\n        .attr('y', svgHeight/2 + margin.top + 10)\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results for each step\n    if(resultValues && !show){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2) + margin.left\n        })\n        .attr('y', svgHeight/2 + margin.top + 10)\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results and percenage together\n    if(show && resultValues){\n      //rendering percents\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2) + margin.left\n        })\n        .attr('y', svgHeight/2 + margin.top + 16)\n        .attr('class', (d) => { return 'text-second ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n\n      //rendering results\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2) + margin.left\n        })\n        .attr('y', svgHeight/2+ margin.top - 3)\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n    //hover handling\n    if(hover){\n      const polygonsHover = chart.selectAll('polygon');\n      polygonsHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      const labelHover = chart.selectAll('text');\n      labelHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      function handleMouseOver(d) {\n        polygonsHover\n          .style('opacity', 0.5);\n        labelHover\n          .style('opacity', 0.5);\n        const thisLabel = /[^ ]*$/.exec(d3.select(this).attr('class'))[0];\n        chart\n          .selectAll(`.${thisLabel}`)\n          .style('opacity', 1);\n      }\n      function handleMouseOut(d) {\n        polygonsHover\n          .style('opacity', 1);\n        labelHover\n          .style('opacity', 1);\n      }\n    }\n\n    // click to copy\n    if (utils && utils.clickToCopyToClipboard) {\n      const label = chart.selectAll('text');\n\n      label.on('click', handleClickToCopy);\n\n      function handleClickToCopy(data) {\n        const { percent, result } = data;\n        if (resultValues) {\n          copyToClipboard(result, d3.event);\n        } else if (show) {\n          copyToClipboard(percent, d3.event);\n        }\n      }\n    }\n  }\n  update() {\n    this.destroy();\n    this.render();\n  }\n  destroy() {\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    chartContainer.remove();\n  }\n}\n","import * as d3 from 'd3';\nimport { textWrap } from '../../utils/svg-text-wrap';\nimport { prettyNumber } from '../../utils/pretty-number';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nexport default class HorizontalFunnel3d {\n  render() {\n    const { matrix } = this.dataset;\n    const {\n      colors,\n      container,\n      labelMapping,\n      colorMapping,\n      utils,\n    } = this.config;\n    const opts = this.config;\n    const {\n      percents: {\n        show,\n        countingMethod,\n        decimals,\n      },\n      lines,\n      resultValues,\n      effect3d,\n      hover,\n      minimalSize,\n    } = this.config.funnel;\n    const margin = { top: 20, right: 30, bottom: 100, left: 10 };\n    const funnelContainer = d3.select(container);\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    const chart = chartContainer.append('svg');\n    const svgWidth = funnelContainer.style('width').slice(0, -2)\n          - margin.right - margin.left;\n    const svgHeight = funnelContainer.style('height').slice(0, -2)\n          - margin.top - margin.bottom - 30;\n    const elemWidth= svgWidth/(matrix.length - 1);\n    const xMarginElement = elemWidth * 0.3;\n    const shadowCut = (xMarginElement/1.5);\n    let prevElemHeight = svgHeight;\n    let percent = (100).toFixed(decimals);\n\n    // prepare normal funnel polygons\n    let minimalSizeStep = 0;\n    if(minimalSize){\n      minimalSizeStep = (svgHeight - minimalSize) / (matrix.length-2);\n    }\n    const polygons = matrix.slice(1).map((d, i) => {\n        const newPoints = [\n          {\n            x: elemWidth * i + xMarginElement,\n            y: ((svgHeight - prevElemHeight)/2)\n          },\n          {\n            x: elemWidth * i + xMarginElement,\n            y: ((svgHeight - prevElemHeight)/2 + prevElemHeight)\n          },\n        ]\n        if(i !== 0){\n          if(countingMethod === 'relative'){\n            minimalSize\n              ? (prevElemHeight = prevElemHeight - minimalSizeStep)\n              : prevElemHeight = prevElemHeight * d[1]/matrix[i][1];\n            percent = ((d[1]/matrix[i][1])*100).toFixed(decimals);\n          }\n          if(countingMethod === 'absolute'){\n            minimalSize\n              ? (prevElemHeight = prevElemHeight - minimalSizeStep)\n              : prevElemHeight = svgHeight * d[1]/matrix[1][1];\n            percent = ((d[1]/matrix[1][1])*100).toFixed(decimals);\n          }\n        }\n        let label = d[0];\n        if(Object.keys(labelMapping).length){\n          for (let key in labelMapping) {\n            if(labelMapping[key] === d[0]) {\n              label = key;\n            }\n          }\n        }\n        let result = d[1];\n        if ( (typeof opts['prettyNumber'] === 'undefined' || opts['prettyNumber'] === true)\n          && !isNaN(parseInt(d[1])) ) {\n            result = prettyNumber(d[1]);\n        }\n        return {\n          name: d[0],\n          label,\n          percent: percent + '%',\n          result,\n          points: [\n            ...newPoints,\n            {\n              x: elemWidth * (i + 1),\n              y: ((svgHeight - prevElemHeight)/2 + prevElemHeight)\n            },\n            {\n              x: elemWidth * (i + 1),\n              y: ((svgHeight - prevElemHeight)/2)\n            }\n          ]\n        }\n    });\n\n    //funnel shadows preparing\n    const polygonsShadows = polygons.map((d, i) => {\n        return {\n          label: d.label,\n          points: [\n            {\n              x: d.points[0].x,\n              y: d.points[0].y\n            },\n            {\n              x: d.points[1].x,\n              y: d.points[1].y\n            },\n            {\n              x: effect3d === 'top'\n              ? d.points[1].x\n              : d.points[1].x - shadowCut,\n              y: effect3d === 'top'\n              ? d.points[1].y\n              : d.points[1].y - xMarginElement < svgHeight/2\n                ? svgHeight/2 + 5\n                : d.points[1].y - xMarginElement\n            },\n            {\n              x: effect3d === 'bottom'\n              ? d.points[0].x\n              : d.points[0].x - shadowCut,\n              y: effect3d === 'bottom'\n              ? d.points[0].y\n              : d.points[0].y + xMarginElement > svgHeight/2\n                ? svgHeight/2 - 5\n                : d.points[0].y + xMarginElement\n            },\n          ]\n        }\n    })\n\n    //connecting funnels with shadows for rendering\n    const polygons3d = polygons.concat(polygonsShadows);\n\n    //chart rendering with polygons\n    chart\n      .attr('preserveAspectRatio', 'xMidYMid meet')\n      .attr('viewBox', `0 0 ${svgWidth + margin.left + margin.right} ${svgHeight + margin.top + margin.bottom - 30}`)\n      .attr('height', '100%')\n      .attr('width', '100%')\n      .append('g')\n      .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')\n      .selectAll('polygon')\n      .data(polygons3d)\n      .enter()\n      .append('polygon')\n        .attr('points', (d) => {\n            return d.points.map((p) => {\n              return [p.x,p.y].join(',');\n            })\n            .join(' ');\n        })\n        .style('fill', (d, i) => {\n          if(i > (polygons.length - 1)){\n            if(colorMapping[d.label]){\n              return d3.rgb(colorMapping[d.label]).darker(1.5);\n            }\n            return d3.rgb(colors[i - (polygons.length)]).darker(1.5);\n          }\n          if(colorMapping[d.label]){\n            return colorMapping[d.label];\n          }\n          return colors[i];\n        })\n        .attr('class', (d) => { return d.label; })\n        .attr('cursor', 'pointer');\n\n    if(lines){\n      //rendering lines\n      chart\n        .selectAll('line')\n        .data(polygons)\n        .enter()\n        .append('line')\n        .attr('x1', (d) => {\n          return d.points[0].x + margin.left - (xMarginElement * 0.8);\n        })\n        .attr('y1', svgHeight + margin.bottom)\n        .attr('x2', (d) => {\n          return d.points[0].x + margin.left - (xMarginElement * 0.8);\n        })\n        .attr('y2', (d) => { return d.points[0].y + margin.top; })\n        .attr('class', 'chart-lines');\n\n      //rendering last line\n      chart\n        .append('line')\n        .attr('x1', svgWidth + margin.left + (xMarginElement/4))\n        .attr('y1', svgHeight + margin.bottom)\n        .attr('x2', polygons[polygons.length-1].points[3].x\n                    + margin.left + (xMarginElement/4))\n        .attr('y2', polygons[polygons.length-1].points[3].y + margin.top)\n        .attr('class', 'chart-lines');\n    }\n\n    //rendering labels when lines are visible\n    if(lines){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[0].x + margin.left + (elemWidth * 0.25)\n        })\n        .attr('y', svgHeight + (margin.bottom * 0.4) + margin.top)\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, elemWidth)\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering labels when lines are not visible\n    if(!lines) {\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[0].x + margin.left + (elemWidth * 0.25)\n        })\n        .attr('y', (d) => {\n          if(d.points[2].y + (elemWidth/4) >\n          svgHeight + margin.bottom - 40){\n            return svgHeight + margin.bottom - 40 + margin.top;\n          }\n          if(d.points[2].y + (elemWidth/4) < d.points[1].y){\n            return d.points[1].y + 20 + margin.top;\n          }\n          return d.points[2].y + (elemWidth/4) + 10 + margin.top;\n        })\n        .attr('class', (d) => { return 'text-label ' + d.label; })\n        .text((d) => { return d.name; })\n        .call(textWrap, elemWidth)\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering percents for each step\n    if(show && !resultValues){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2.8) + margin.left\n        })\n        .attr('y', svgHeight/2 + margin.top + 10)\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results for each step\n    if(resultValues && !show){\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2.8) + margin.left\n        })\n        .attr('y', svgHeight/2 + margin.top + 10)\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n\n    //rendering results and percenage together\n    if(show && resultValues){\n      //rendering percents\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2.8) + margin.left\n        })\n        .attr('y', svgHeight/2 + margin.top + 16)\n        .attr('class', (d) => { return 'text-second ' + d.label; })\n        .text((d) => { return d.percent; })\n        .attr('cursor', 'pointer');\n\n      //rendering results\n      chart\n        .selectAll('text.label')\n        .data(polygons)\n        .enter()\n        .append('text')\n        .style('text-anchor', 'middle')\n        .attr('x', (d) => {\n          return d.points[1].x + (elemWidth/2.8) + margin.left\n        })\n        .attr('y', svgHeight/2+ margin.top - 3)\n        .attr('class', (d) => { return 'text-main ' + d.label; })\n        .text((d) => { return d.result; })\n        .attr('cursor', 'pointer');\n    }\n\n    //hover handling\n    if(hover){\n      const polygonsHover = chart.selectAll('polygon');\n      polygonsHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      const labelHover = chart.selectAll('text');\n      labelHover\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mouseout\", handleMouseOut);\n\n      function handleMouseOver(d) {\n        polygonsHover\n          .style('opacity', 0.5);\n        labelHover\n          .style('opacity', 0.5);\n        const thisLabel = /[^ ]*$/.exec(d3.select(this).attr('class'))[0];\n        chart\n          .selectAll(`.${thisLabel}`)\n          .style('opacity', 1);\n      }\n      function handleMouseOut(d) {\n        polygonsHover\n          .style('opacity', 1);\n        labelHover\n          .style('opacity', 1);\n      }\n    }\n\n    // click to copy\n    if (utils && utils.clickToCopyToClipboard) {\n      const label = chart.selectAll('text');\n\n      label.on('click', handleClickToCopy);\n\n      function handleClickToCopy(data) {\n        const { percent, result } = data;\n        if (resultValues) {\n          copyToClipboard(result, d3.event);\n        } else if (show) {\n          copyToClipboard(percent, d3.event);\n        }\n      }\n    }\n  }\n  update() {\n    this.destroy();\n    this.render();\n  }\n  destroy() {\n    const chartContainer = d3.select(this.el().querySelector('.' + this.config.theme + '-rendering .c3-chart'));\n    chartContainer.remove();\n  }\n}\n","/* eslint-env browser */\nimport c3 from 'c3';\nimport { each } from '../../utils/each';\nimport { prettyNumber } from '../../utils/pretty-number';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nexport default class MetricCombo {\n  render() {\n    const {\n      container,\n      metricResults,\n      title,\n      showTitle,\n      subtitle,\n      tooltip,\n      utils,\n    } = this.config;\n\n    const colors = ['#c3c4cc'];\n    const columns = [];\n    columns[0] = [];\n    each(this.dataset.selectColumn(0), (c, i) => {\n      let cell;\n      if (i > 0) {\n        cell = new Date(c);\n      }\n      columns[0][i] = cell;\n    });\n    columns[0][0] = 'x';\n\n    each(this.data()[0], (c, i) => {\n      if (i > 0) {\n        columns.push(this.dataset.selectColumn(i));\n      }\n    });\n\n    const prevResult = (metricResults && metricResults.previous && metricResults.previous.result)\n      || 0;\n    const currResult = (metricResults && metricResults.current && metricResults.current.result)\n      || 0;\n    const count = currResult - prevResult;\n    const percentDifference = prevResult === 0 ? '-' : prettyNumber(Math.round((count / prevResult) * 100));\n    let labelClass = 'keen-dataviz-metric-green';\n    let iconClass = 'arrow-green';\n\n    if (percentDifference < 0) {\n      labelClass = 'keen-dataviz-metric-red';\n      iconClass = 'arrow-red';\n    }\n\n    const containerTitle = (showTitle && title) ? `<div class=\"keen-dataviz-title\">${title}</div>` : '';\n    const containerSubtitle = subtitle ? `<div class=\"keen-dataviz-subtitle\">${subtitle}</div>` : '';\n    const containerElement = document.querySelector(container);\n    containerElement.innerHTML = `\n      <div class=\"keen-dataviz\">\n        <div class=\"keen-dataviz-metric-combo\">\n          <div class=\"metric-combo-data\">\n            ${containerTitle}\n            ${containerSubtitle}\n            <div class=\"percent-difference ${labelClass}\"><div class=\"${iconClass}\"></div> ${percentDifference} %</div>\n            <div class=\"current-count ${labelClass}\"> ${prettyNumber(count)} </div>\n          </div>\n          <div class=\"keen-dataviz-rendering\">\n            <div class=\"c3-chart\"></div>\n          </div>\n        </div>\n      </div>`;\n    const chartRoot = containerElement.querySelector('.c3-chart');\n    const chart = c3.generate({\n      bindto: chartRoot,\n      color: {\n        pattern: colors,\n      },\n      title,\n      legend: {\n        show: false,\n      },\n      data: {\n        x: 'x',\n        columns,\n        type: 'area-spline',\n        selection: {\n          draggable: false,\n          enabled: true,\n          multiple: true,\n        },\n      },\n      point: {\n        r: 0,\n        focus: {\n          expand: {\n            r: 5,\n            enabled: true,\n          },\n        },\n        select: {\n          r: 5,\n          enabled: true,\n        },\n      },\n      axis: {\n        y: {\n          show: false,\n        },\n        x: {\n          show: false,\n        },\n      },\n      grid: {\n        x: {\n          show: false,\n        },\n        y: {\n          show: false,\n        },\n      },\n      padding: {\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: -4,\n      },\n      tooltip,\n    });\n\n    if (utils && utils.clickToCopyToClipboard) {\n      const currentCount = document.querySelector('.current-count').innerText;\n      document.querySelector('.keen-dataviz-metric-combo')\n        .addEventListener('click', e => copyToClipboard(currentCount, e));\n    }\n  }\n\n  update() {\n    this.destroy();\n    this.render();\n  }\n\n  destroy() {\n    const { container } = this.config;\n    const containerElement = document.querySelector(container);\n    const chartContainer = containerElement.querySelector('.c3-chart');\n    chartContainer.remove();\n  }\n}\n","import * as d3 from 'd3';\nimport Rangeable from 'rangeable';\nimport copyToClipboard from '../../utils/copy-to-clipboard';\n\nexport default class Heatmap {\n  render() {\n    const {\n      colors,\n      container,\n      heatmap: { showSlider, simpleTooltip },\n    } = this.config;\n    const {\n      matrix,\n      meta,\n    } = this.dataset;\n    const margin = {\n      top: 10,\n      right: 10,\n      bottom: 50,\n      left: 50,\n    };\n    const baseWidth = 600;\n    const baseHeight = 600;\n    const heatmapContainer = d3.select(container);\n    const containerWidth = parseInt(heatmapContainer.style('width'), 10) || baseWidth;\n    const containerHeight = parseInt(heatmapContainer.style('height'), 10) || baseHeight;\n    const chartContainer = this.el().querySelector('.c3-chart');\n    const svgWidth = containerWidth - margin.right - margin.left;\n    const svgHeight = containerHeight - margin.top - margin.bottom;\n\n    const xLabel = new Set();\n    const yLabel = new Set();\n\n    const formatData = () => {\n      const dateFormat = d3.timeFormat('%B %d');\n      const timeFormat = d3.timeFormat('%H:%M');\n      const arr = [];\n      matrix.forEach((element) => {\n        if (meta.type === 'heatmap') {\n          if (typeof element[0][2] === 'number') {\n            const obj = {\n              x: element[0][0],\n              y: element[0][1],\n              value: element[0][2],\n            };\n            arr.push(obj);\n          }\n        } else {\n          const timestamp = Date.parse(element[0]);\n          // eslint-disable-next-line no-restricted-globals\n          if (!isNaN(timestamp)) {\n            const obj = {\n              x: dateFormat(new Date(element[0])),\n              y: timeFormat(new Date(element[0])),\n              value: element[1],\n            };\n            arr.push(obj);\n          }\n        }\n      });\n      return arr;\n    };\n\n    const formattedData = formatData();\n\n    formattedData.forEach((item) => {\n      xLabel.add(item.x);\n      yLabel.add(item.y);\n    });\n\n    const refValue = formattedData[0].value;\n    const minRange = formattedData\n      .reduce((min, curr) => (curr.value < min ? curr.value : min), refValue);\n    const maxRange = formattedData\n      .reduce((max, curr) => (curr.value > max ? curr.value : max), refValue);\n\n    const getColor = () => {\n      const defaultColor = '#00BBDE';\n      const baseColor = colors[0];\n      let rgb = d3.rgb(defaultColor);\n      if (d3.color(baseColor)) {\n        rgb = d3.rgb(baseColor);\n      }\n      return rgb;\n    };\n\n    const getColorAlpha = d3.scaleLinear()\n      .domain([0, d3.max(formattedData, d => d.value)])\n      .range([0, 1]);\n\n    const convertRGBAtoRGB = (color, bg = [255, 255, 255]) => {\n      const opacity = color[3];\n\n      return [Math.floor(((1 - opacity) * bg[0]) + (opacity * color[0]) + 0.5),\n        Math.floor(((1 - opacity) * bg[1]) + (opacity * color[1]) + 0.5),\n        Math.floor(((1 - opacity) * bg[2]) + (opacity * color[2]) + 0.5)];\n    };\n\n    const getTileColor = (value) => {\n      const alpha = getColorAlpha(value);\n      const rgb = getColor();\n      const solidColor = convertRGBAtoRGB([rgb.r, rgb.g, rgb.b, alpha]);\n      const color = `rgb(${solidColor[0]}, ${solidColor[1]}, ${solidColor[2]})`;\n      return color;\n    };\n\n    const svg = d3.select(chartContainer)\n      .append('svg')\n      .attr('preserveAspectRatio', 'xMidYMid slice')\n      .attr('viewBox', `0 0 ${containerWidth} ${containerHeight}`)\n      .attr('height', '100%')\n      .attr('width', '100%')\n      .append('g')\n      .attr(\n        'transform',\n        `translate(${margin.left},${margin.top})`,\n      );\n\n    if (showSlider) {\n      // eslint-disable-next-line no-unused-vars\n      const rangeableInput = d3.select(container)\n        .append('input')\n        .attr('type', 'range')\n        .attr('class', 'keen-dataviz-slider');\n\n      const handleSliderChange = (data) => {\n        const rects = svg.selectAll('rect');\n        const [min, max] = data;\n\n        rects.each((d, i, nodes) => {\n          d3.select(nodes[i])\n            .style('visibility', () => ((d.value > max || d.value < min) ? 'hidden' : 'visible'));\n        });\n      };\n\n      // eslint-disable-next-line no-unused-vars\n      const rangeable = new Rangeable('.keen-dataviz-slider', {\n        multiple: true,\n        min: minRange,\n        max: maxRange,\n        value: [minRange, maxRange],\n        onChange: data => handleSliderChange(data),\n      });\n      const containerToString = container.className ? `.${container.className.replace(/\\s/g, '.')}` : container;\n      const customStyle = `\n        ${containerToString} .rangeable-progress,\n        ${containerToString} .rangeable-tooltip,\n        ${containerToString} .active {\n          background-color: ${getColor()};\n        }\n        ${containerToString} .rangeable-tooltip::before {\n          border-color: ${getColor()} transparent transparent;\n        }\n        ${containerToString} .rangeable-handle {\n          border-color: ${getColor()};\n        }\n      `;\n\n      // eslint-disable-next-line no-undef\n      const style = document.createElement('style');\n      style.innerHTML = customStyle;\n\n      // eslint-disable-next-line no-undef\n      const scriptRef = document.querySelector('script');\n      scriptRef.parentNode.insertBefore(style, scriptRef);\n    }\n\n    const xLabelBase = 5;\n    const yLabelBase = 10;\n\n    const getAxisLabelRatio = (base, labelSize) => Math.floor(labelSize / base) + 1;\n    const xAxis = d3.scaleBand()\n      .range([0, svgWidth])\n      .domain([...xLabel])\n      .padding(0.02);\n\n    svg.append('g')\n      .style('font-size', 12)\n      .attr('transform', `translate(0, ${svgHeight})`)\n      .call(d3.axisBottom(xAxis).tickSize(0))\n      .selectAll('text')\n      .attr('dy', '1em')\n      .filter((d, i) => i % getAxisLabelRatio(xLabelBase, xLabel.size))\n      .style('display', 'none');\n\n    const yAxis = d3.scaleBand()\n      .range([svgHeight, 0])\n      .domain([...yLabel].sort())\n      .padding(0.02);\n\n    svg.append('g')\n      .style('font-size', 12)\n      .call(d3.axisLeft(yAxis).tickSize(0))\n      .selectAll('text')\n      .filter((d, i) => i % getAxisLabelRatio(yLabelBase, yLabel.size))\n      .style('display', 'none');\n\n    const chartTooltip = d3.select(container)\n      .append('div')\n      .attr('class', 'keen-dataviz-tooltip')\n      .style('opacity', 0)\n      .style('background-color', 'white')\n      .style('border', `2px solid ${getColor().toString()}`)\n      .style('font-size', '14px')\n      .style('padding', '2px 8px')\n      .style('box-shadow', '2px 2px 4px rgba(0,0,0,0.25')\n      .style('display', 'none')\n      .style('position', 'fixed');\n\n    const handleMouseOver = () => {\n      d3.select(d3.event.target)\n        .raise()\n        .style('transition', 'transform 150ms ease-out')\n        .style('outline', `1px solid ${getColor()}`)\n        .style('transform', 'translate(0px, -4px)');\n\n      chartTooltip\n        .style('opacity', 1)\n        .style('display', 'block');\n    };\n\n    const handleMouseMove = (d) => {\n      let tooltipContent = `\n      <tr>\n        <th style=\"text-align: right\">value:</th>\n        <td><b style=\"font-size:14px;\">${d.value}</b></td>\n      </tr>`;\n      if (!simpleTooltip) {\n        tooltipContent = `\n        <tr>\n            <th style=\"text-align: right\">xAxis:</th>\n            <td>${d.x}</td>\n        </tr>\n        <tr>\n            <th style=\"text-align: right\">yAxis:</th>\n            <td>${d.y}</td>\n        </tr>\n        ${tooltipContent}\n        `;\n      }\n      chartTooltip\n        .html(`\n          <table style=\"font-size:12px;\">\n            ${tooltipContent}\n          </table>\n        `)\n        .style('left', `${d3.event.clientX + 10}px`)\n        .style('top', `${d3.event.clientY + 10}px`);\n    };\n\n    const handleMouseLeave = () => {\n      d3.select(d3.event.target)\n        .style('outline', 'none')\n        .style('transform', 'none');\n\n      chartTooltip\n        .style('opacity', 0)\n        .style('display', 'none');\n    };\n\n    const handleClick = d => copyToClipboard(d.value);\n\n    svg.selectAll()\n      .data(formattedData, d => `${d.x}:${d.y}`)\n      .enter()\n      .append('rect')\n      .attr('x', d => xAxis(d.x))\n      .attr('y', d => yAxis(d.y))\n      .attr('width', xAxis.bandwidth())\n      .attr('height', yAxis.bandwidth())\n      .style('fill', d => getTileColor(d.value))\n      .style('cursor', 'pointer')\n      .on('mouseover', handleMouseOver)\n      .on('mousemove', handleMouseMove)\n      .on('mouseleave', handleMouseLeave)\n      .on('click', handleClick);\n  }\n  update() {\n    this.destroy();\n    this.render();\n  }\n  destroy() {\n    const chartContainer = this.el().querySelector('.c3-chart');\n    chartContainer.remove();\n  }\n}\n","import * as d3 from \"d3\";\nimport Rangeable from \"rangeable\";\nimport { prettyNumber } from \"../../utils/pretty-number\";\nimport copyToClipboard from \"../../utils/copy-to-clipboard\";\n\nexport default class Choropleth {\n  render() {\n    const { matrix } = this.dataset;\n    const {\n      colors,\n      container,\n      utils,\n      title,\n      choropleth: {\n        map,\n        borders: { show, size, color },\n        showSlider\n      }\n    } = this.config;\n    const opts = this.config;\n    const choroplethContainer = d3.select(container);\n    const chartContainer = d3.select(\n      this.el().querySelector(`.${this.config.theme}-rendering .c3-chart`)\n    );\n    const width = Number(choroplethContainer.style(\"width\").slice(0, -2));\n    const height = Number(choroplethContainer.style(\"height\").slice(0, -2));\n    let heightChanges = 0;\n    if (title) heightChanges += 31;\n    if (showSlider) heightChanges += 20;\n    const chart = chartContainer\n      .append(\"svg\")\n      .attr(\"width\", width)\n      .attr(\"height\", height - heightChanges);\n\n    const onlyValues = matrix.slice(1).map(el => el[1]);\n    let minVal = d3.min(onlyValues);\n    const maxVal = d3.max(onlyValues);\n    if(minVal === maxVal) minVal = 0;\n    const lightColor = d3.hsl(colors[0]).brighter(1);\n    lightColor.l = 0.95;\n    const darkColor = colors[0];\n    const ramp = d3\n      .scaleLinear()\n      .domain([minVal === undefined ? 0 : minVal, maxVal === undefined ? 0 : maxVal])\n      .range([lightColor, darkColor]);\n\n    d3.json(\n      `https://cdn.jsdelivr.net/npm/keen-dataviz-maps@1.0.0/maps/${map}.json`\n    ).then(data => {\n      const zoom = d3\n        .zoom()\n        .scaleExtent([1, 5])\n        .translateExtent([[0, 0], [width, height - 50]])\n        .on(\"zoom\", zoomed);\n\n      let projection;\n      switch (map) {\n        case \"world\":\n          projection = d3.geoMercator().fitSize([width, height - 50], data);\n          break;\n        case \"us\":\n          projection = d3\n            .geoAlbersUsa()\n            .scale(width)\n            .fitSize([width, height - 50], data);\n          break;\n\n        default:\n          projection = d3\n            .geoMercator()\n            .scale(width)\n            .fitSize([width, height - 50], data);\n          break;\n      }\n\n      const path = d3.geoPath().projection(projection);\n\n      const usData = data.features.map(el => {\n        const theOne = matrix.filter(d => d[0] === el.properties.name);\n        if (theOne[0])\n          return {\n            ...el,\n            properties: { ...el.properties, result: theOne[0][1] }\n          };\n        return {\n          ...el,\n          properties: { ...el.properties, result: 0 }\n        };\n      });\n\n      if (showSlider) {\n        const handleSliderChange = data => {\n          const el = chart.selectAll(`.${elementName}`);\n          const [min, max] = data;\n\n          el.each((d, i, nodes) => {\n            d3.select(nodes[i]).style(\"visibility\", () =>\n              d.properties.result > max || d.properties.result < min\n                ? \"hidden\"\n                : \"visible\"\n            );\n          });\n        };\n\n        chartContainer\n          .style(\"display\", \"flex\")\n          .style(\"flex-direction\", \"column\")\n          .style(\"justify-content\", \"center\");\n\n        const rangeContainer = chartContainer\n          .append(\"div\")\n          .style(\"width\", \"95%\")\n          .style(\"margin\", \"auto\");\n        rangeContainer.append(\"input\").attr(\"id\", \"rangeSlider\");\n\n        const rangeable = new Rangeable(\"#rangeSlider\", {\n          type: \"double\",\n          tooltips: true,\n          min: 0,\n          max: maxVal,\n          onChange: data => handleSliderChange(data)\n        });\n\n        const containerToString = container.className ? `.${container.className.replace(/\\s/g, '.')}` : container;\n        const customStyle = `\n        ${containerToString} .rangeable-progress,\n        ${containerToString} .rangeable-tooltip,\n        ${containerToString} .active {\n          background-color: ${colors[0]};\n        }\n        ${containerToString} .rangeable-tooltip::before {\n          border-color: ${colors[0]} transparent transparent;\n        }\n        ${containerToString} .rangeable-handle {\n          border-color: ${colors[0]};\n        }\n      `;\n\n        // eslint-disable-next-line no-undef\n        const style = document.createElement(\"style\");\n        style.innerHTML = customStyle;\n\n        // eslint-disable-next-line no-undef\n        const scriptRef = document.querySelector(\"script\");\n        scriptRef.parentNode.insertBefore(style, scriptRef);\n      }\n\n      const elementName = map === \"world\" ? \"country\" : \"state\";\n\n      chart\n        .selectAll(\"path\")\n        .data(usData)\n        .enter()\n        .append(\"path\")\n        .attr(\"d\", path)\n        .attr(\"class\", elementName)\n        .attr(\n          \"id\",\n          d =>\n            `${d.properties.name\n              .split(\" \")\n              .join(\"-\")\n              .split(\".\")\n              .join(\"\")}`\n        )\n        .style(\"fill\", d => ramp(d.properties.result))\n        .attr(\"cursor\", \"pointer\")\n        .on(\"mouseover\", handleMouseOver)\n        .on(\"mousemove\", handleMouseMove)\n        .on(\"mouseout\", handleMouseOut);\n\n      //borders\n      if (show) {\n        chart\n          .selectAll(`.${elementName}`)\n          .style(\"stroke\", color)\n          .style(\"stroke-width\", size);\n      }\n\n      //tooltip\n      const tooltip = d3\n        .select(\".c3-chart\")\n        .append(\"div\")\n        .style(\"opacity\", 0)\n        .attr(\"class\", \"c3-tooltip-container\")\n        .style(\"display\", \"none\")\n        .style(\"position\", \"fixed\");\n\n      //hover handling\n      function handleMouseOver(d) {\n        chart\n          .select(\n            `#${d.properties.name\n              .split(\" \")\n              .join(\"-\")\n              .split(\".\")\n              .join(\"\")}`\n          )\n          .style(\"fill\", d => ramp(1.2 * maxVal))\n          .style(\"stroke-width\", 1.5 * size);\n\n        tooltip.style(\"opacity\", 1).style(\"display\", \"block\");\n      }\n\n      function handleMouseMove(d) {\n        let result = d.properties.result;\n        if (\n          (typeof opts[\"prettyNumber\"] === \"undefined\" ||\n            opts[\"prettyNumber\"] === true) &&\n          !isNaN(parseInt(d.properties.result))\n        ) {\n          result = prettyNumber(d.properties.result);\n        }\n        tooltip\n          .html(\n            `\n          <table class=\"c3-tooltip\">\n            <tr>\n              <th colspan=\"2\">${d.properties.name}</th>\n            </tr>\n            <tr class=\"c3-tooltip-name-1\">\n              <td class=\"value\">${result}</td>\n            </tr>\n          </table>\n        `\n          )\n          .style(\"left\", `${d3.event.clientX + 10}px`)\n          .style(\"top\", `${d3.event.clientY + 10}px`);\n      }\n      function handleMouseOut(d) {\n        chart\n          .select(\n            `#${d.properties.name\n              .split(\" \")\n              .join(\"-\")\n              .split(\".\")\n              .join(\"\")}`\n          )\n          .style(\"fill\", d => ramp(d.properties.result))\n          .style(\"stroke-width\", size);\n\n        tooltip.style(\"opacity\", 0).style(\"display\", \"none\");\n      }\n\n      // click to copy\n      if (utils && utils.clickToCopyToClipboard) {\n        const label = chart.selectAll(`.${elementName}`);\n\n        label.on(\"click\", handleClickToCopy);\n\n        function handleClickToCopy(data) {\n          const {\n            properties: { result }\n          } = data;\n          copyToClipboard(result, d3.event);\n        }\n      }\n      function zoomed() {\n        chart\n          .selectAll(`.${elementName}`)\n          .attr(\"transform\", d3.event.transform);\n      }\n      chart.call(zoom);\n      chart.call(zoom).on(\"mousedown.zoom\", null);\n    });\n  }\n  update() {\n    this.destroy();\n    this.render();\n  }\n  destroy() {\n    const chartContainer = d3.select(\n      this.el().querySelector(`.${this.config.theme}-rendering .c3-chart`)\n    );\n    chartContainer.remove();\n  }\n}\n","import copyToClipboard from './copy-to-clipboard';\n\nfunction removeClassWithTimeOut(element, className = 'copied', ms = 1000) {\n  setTimeout(() => {\n    element.classList.remove(className);\n  }, ms);\n}\n\nfunction handleCopyToClipboard(event) {\n  const { target, target: { nodeName } } = event;\n\n  let value;\n  if (nodeName === 'DD') {\n    value = target.innerText;\n    if (!target.classList.contains('copied')) {\n      target.classList.add('copied');\n      removeClassWithTimeOut(target);\n    }\n  }\n  if (nodeName === 'DT') {\n    value = target.nextSibling.innerText;\n    if (!target.nextSibling.classList.contains('copied')) {\n      target.nextSibling.classList.add('copied');\n      removeClassWithTimeOut(target.nextSibling);\n    }\n  }\n\n  copyToClipboard(value);\n}\n\nexport default function renderExecutionMetadata({\n  element,\n  data,\n} = {}) {\n  const dataList = document.createElement('dl');\n  dataList.classList = 'keen-dataviz-execution-meta';\n\n  if (Object.keys(data).length) {\n    Object.keys(data).forEach((item) => {\n      const dt = document.createElement('dt');\n      dt.innerText = item.replace(/_/g, ' ');\n      dt.addEventListener('click', e => handleCopyToClipboard(e));\n\n      const dd = document.createElement('dd');\n      dd.innerText = data[item];\n      dd.addEventListener('click', e => handleCopyToClipboard(e));\n\n      dataList.append(dt);\n      dataList.append(dd);\n    });\n  } else {\n    dataList.innerText = 'No execution metadata available';\n  }\n\n  element.append(dataList);\n}\n","import autocollector from './autocollector';\nimport modern from './modern';\nimport dracula from './dracula';\n\nexport default {\n  autocollector,\n  modern,\n  dracula,\n};","const palette = {\n  colors: [\n    '#5E77FF',\n    '#9C60FE',\n    '#F162FE',\n    '#FD65B7',\n    '#FD6768',\n    '#FDB86A',\n    '#F2FC6C',\n    '#A5FC6E',\n    '#71FB85',\n    '#73FBD0',\n    '#76DDFA',\n    '#76f4fa',\n    '#bb76fa',\n    '#fa76bf'\n  ]\n};\n\nexport default palette;","const palette = {\n  colors: [\n    '#45B2E8',\n    '#D9540D',\n    '#2CAB72',\n    '#2C4BAB',\n    '#EDDD02',\n    '#E84545',\n    '#E845CE',\n    '#5FCEC9',\n    '#E89F45',\n    '#28E43F',\n    '#B765C0',\n    '#458AE8',\n    '#AB2C2C',\n    '#AB2C75',\n    '#27E5FF',\n    '#7168F2',\n    '#FF932B',\n    '#855D00',\n    '#ACE845',\n    '#1C91B4'\n  ]\n};\n\nexport default palette;","const palette = {\n  colors: [\n    '#8be9fd',\n    '#50fa7b',\n    '#ffb86c',\n    '#ff79c6',\n    '#bd93f9',\n    '#ff5555',\n    '#f1fa8c',\n  ]\n};\n\nexport default palette;","/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","import Promise from './index';\nimport promiseFinally from './finally';\n\n/** @suppress {undefinedVars} */\nvar globalNS = (function() {\n  // the only reliable means to get the global object is\n  // `Function('return this')()`\n  // However, this causes CSP violations in Chrome apps.\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  throw new Error('unable to locate global object');\n})();\n\nif (!('Promise' in globalNS)) {\n  globalNS['Promise'] = Promise;\n} else if (!globalNS.Promise.prototype['finally']) {\n  globalNS.Promise.prototype['finally'] = promiseFinally;\n}\n"],"sourceRoot":""}